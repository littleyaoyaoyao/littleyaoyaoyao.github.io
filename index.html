<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>We-Param</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="New Land">
<meta property="og:type" content="website">
<meta property="og:title" content="We-Param">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="We-Param">
<meta property="og:description" content="New Land">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="We-Param">
<meta name="twitter:description" content="New Land">
  
    <link rel="alternate" href="/atom.xml" title="We-Param" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">We-Param</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-SpringMVC学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/23/SpringMVC学习/" class="article-date">
  <time datetime="2017-05-23T13:49:07.821Z" itemprop="datePublished">2017-05-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/23/SpringMVC学习/">SpringMVC学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： SpringMVC</p>
<hr>
<h2 id="二-SpringMVC入门案例"><a href="#二-SpringMVC入门案例" class="headerlink" title="二 . SpringMVC入门案例"></a>二 . SpringMVC入门案例</h2><h2 id="三-HandlerMapping"><a href="#三-HandlerMapping" class="headerlink" title="三 . HandlerMapping"></a>三 . HandlerMapping</h2><p>HandlerMapping：简单url处理器映射器，把url进行集中配置。</p>
<p>注意：映射器之间可以共存</p>
<h2 id="四-HandlerAdapter"><a href="#四-HandlerAdapter" class="headerlink" title="四 . HandlerAdapter"></a>四 . HandlerAdapter</h2><h3 id="4-1-SimpleControllerHandlerAdapter"><a href="#4-1-SimpleControllerHandlerAdapter" class="headerlink" title="4.1 SimpleControllerHandlerAdapter"></a>4.1 SimpleControllerHandlerAdapter</h3><p>继承Controller接口</p>
<h2 id="五-接收页面参数"><a href="#五-接收页面参数" class="headerlink" title="五 . 接收页面参数"></a>五 . 接收页面参数</h2><p>springmvc使用<strong><em>命令设计模式</em></strong>设计封装对象</p>
<h3 id="时间类型转换"><a href="#时间类型转换" class="headerlink" title="时间类型转换"></a>时间类型转换</h3><p>POJO类中定义了时间类Date(),使用initBinder()来进行时间类型转换。<br><code>binder.registerCustomEditor()</code></p>
<h2 id="六-注解开发"><a href="#六-注解开发" class="headerlink" title="六 . 注解开发"></a>六 . 注解开发</h2><h3 id="6-1-RequestMapping"><a href="#6-1-RequestMapping" class="headerlink" title="6.1 RequestMapping"></a>6.1 RequestMapping</h3><ul>
<li><p>集中使用方法：<br>requestMapping(“hello”)<br>requestMapping(“/hello.do”)<br>requestMapping(value=”/hello.do”)<br>requestMapping(value=”/hello.do”,method=RequestMethod.GET) — 注：使用GET方式，则不能直接使用url访问<br>requestMapping(value=”/hello.do”,method=RequestMethod.POST)<br>requestMapping(value=”/hello.do”,method={RequestMethod.POST, RequestMethod.GET})</p>
</li>
<li><p>RequestMapping根路径<br>在类的上方加上RequestMapping(/根路径)，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/user"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>此举有利于解决在不同的Controller中出现相同方法时而不能正常封装参数的问题。</p>
<h3 id="6-2-SpringMVC封装参数"><a href="#6-2-SpringMVC封装参数" class="headerlink" title="6.2 SpringMVC封装参数"></a>6.2 SpringMVC封装参数</h3><p><strong><em>注意：springmvc没有成员变量，把需要传递参数对象放入方法中，当请求方法的时候，这个方法里的对象会自动被创建，需要封装的参数会自动被封装到方法的对象里面。</em></strong></p>
<p>在struts2中，参数的封装是基于属性封装的；在SpringMVC中，参数是基于方法进行封装。</p>
<p>SpringMVC可以接受的数据类型包括：基本类型、String类型、数组类型、POJO类型、包装类型、集合类型（List、Map等）···</p>
<p>在参数的接收方面需要注意一定的问题：</p>
<ul>
<li>在基本类型、String类型、数组类型中，表单input标签中的name属性值要和Controller中方法的参数名<strong>一致</strong></li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;form action=<span class="string">"$&#123;pageContext.request.contextPath &#125;/user/receiveInt.do"</span> method=<span class="string">"post"</span>&gt;</div><div class="line">ID：&lt;input type=<span class="string">"text"</span> name=<span class="string">"id"</span> id=<span class="string">"id"</span>&gt;</div><div class="line">&lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span>&gt;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//接受int类型参数</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"receiveInt"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">recieveInt</span><span class="params">(Integer id)</span></span>&#123;</div><div class="line">	System.out.println(id);</div><div class="line">	<span class="keyword">return</span> <span class="string">"success"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>POJO类</li>
</ul>
<h2 id="七-SpringMVC支持json数据"><a href="#七-SpringMVC支持json数据" class="headerlink" title="七 . SpringMVC支持json数据"></a>七 . SpringMVC支持json数据</h2><p>@RequestBody接受前台json数据，把json数据自动封装javaBean。</p>
<p>@responseBody把后台pojo转换json对象，返回到页面。</p>
<h2 id="八-Springmvc多视图"><a href="#八-Springmvc多视图" class="headerlink" title="八 . Springmvc多视图"></a>八 . Springmvc多视图</h2><h2 id="十-Oscache整合SSM项目"><a href="#十-Oscache整合SSM项目" class="headerlink" title="十 . Oscache整合SSM项目"></a>十 . Oscache整合SSM项目</h2><p>约定 ： 商品页面访问量特别大，给商品页面缓存。items路径下所有请求都缓存。</p>
<p>在web.xml中配置过滤器：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>oscache<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.opensymphony.oscache.web.filter.CacheFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>time<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>3600<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>scope<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>application<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line">  </div><div class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>oscache<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/items/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>利用断点来判断是否存在缓存。</p>
<h2 id="十-SpringMVC的freemark支持"><a href="#十-SpringMVC的freemark支持" class="headerlink" title="十 . SpringMVC的freemark支持"></a>十 . SpringMVC的freemark支持</h2><p>需要freemarker的jar包，spring-context-support.jar</p>
<p>配置模板文件前缀和视图解析后缀：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 配置freemarker模版文件前缀，模版文件编码 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"templateLoaderPath"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsps/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span>	</div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 配置freemarker视图解析后缀，页面显示视图编码 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".ftl"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"contentType"</span> <span class="attr">value</span>=<span class="string">"text/html;charset=utf-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/23/SpringMVC学习/" data-id="cj31o950k000hpwtxn12x05c5" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-SpringMVC的freemarker支持" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/23/SpringMVC的freemarker支持/" class="article-date">
  <time datetime="2017-05-23T13:48:35.767Z" itemprop="datePublished">2017-05-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/23/SpringMVC的freemarker支持/">SpringMVC的freemarker支持</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： SpringMVC freemarker</p>
<hr>
<h2 id="一-简介"><a href="#一-简介" class="headerlink" title="一 . 简介"></a>一 . 简介</h2><p>FreeMarker是一款模板引擎：即一种基于模板和要改变的数据，并用来生成输出文本（HTML网页、电子邮件、配置文件、源代码等）的通用工具。</p>
<p>FreeMarker 的设计实际上是被用来生成HTML网页，尤其是通过基于实现了MVC模式的Servlet应用程序。使用MVC 模式的动态网页的构思使得你可以将前端设计者(编写HTML)从程序员中分离出来。所有人各司其职，发挥其擅长的一面。网页设计师可以改写页面的显示效果而不受程序员编译代码的影响，因为应用程序的逻辑(Java程序)和页面设计(FreeMarker模板)已经分开了。页面模板代码不会受到复杂的程序代码影响。这种分离的思想即便对一个程序员和页面设计师是同一个人的项目来说都是非常有用的，因为分离使得代码保持简洁而且便于维护。</p>
<p>尽管FreeMarker 也有编程能力，但它也不是像PHP那样的一种全面的编程语言。反而，Java程序准备的数据来显示(比如SQL 查询)，FreeMarker 仅仅使用模板生成文本页面来呈现已经准备好的数据。</p>
<h2 id="二-实例编写"><a href="#二-实例编写" class="headerlink" title="二 . 实例编写"></a>二 . 实例编写</h2><ol>
<li><p>jar包<br>包括Freemarker包和spring-context-support.jar</p>
</li>
<li><p>配置freemarker视图支持</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/23/SpringMVC的freemarker支持/" data-id="cj31o950a000cpwtxq7ip8sj5" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Mybatis学习二" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/18/Mybatis学习二/" class="article-date">
  <time datetime="2017-05-18T15:13:41.942Z" itemprop="datePublished">2017-05-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/18/Mybatis学习二/">Mybatis学习二</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： Mybatis</p>
<hr>
<h2 id="一-高级结果映射"><a href="#一-高级结果映射" class="headerlink" title="一 . 高级结果映射"></a>一 . 高级结果映射</h2><p>高级结果映射包括：<strong><em>一对一、一对多、多对多（没有多对一）</em></strong></p>
<p>结果映射可以使用两种方式：<strong><em>resultType</em></strong> <strong><em>resultMap</em></strong></p>
<p>两者存在一定的区别：</p>
<ul>
<li><p><strong>resultType</strong><br>使用resultType来进行一对一结果映射，查询出的列的个数和映射的属性的个数要一致。而且映射的属性要存在于一个大对象中，它是一种平铺式的映射，即数据库查询出多少条记录，则映射成多少个对象。</p>
</li>
<li><p><strong>resultMap</strong><br>在一对一结果映射时，使用resultType更加简单方便，如果有特殊要求（对象嵌套对象）时，需要使用resultMap进行映射。比如：查询订单列表，然后在点击列表中的查看订单明细按钮，这个时候就需要使用resultMap进行结果映射。而resultType更适应于查询明细信息，比如，查询订单明细列表。</p>
</li>
</ul>
<p>在实际开发中，从对象的角度出发，resultMap使用相对更多。</p>
<h3 id="1-1-一对一映射"><a href="#1-1-一对一映射" class="headerlink" title="1.1 一对一映射"></a>1.1 一对一映射</h3><h4 id="一对一映射—-resultType使用示例"><a href="#一对一映射—-resultType使用示例" class="headerlink" title="一对一映射—-resultType使用示例"></a>一对一映射—-resultType使用示例</h4><p>想要实现的功能：查询订单信息，并关联用户的信息</p>
<ul>
<li><p>拓展orders类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrdersExt</span> <span class="keyword">extends</span> <span class="title">Orders</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> String username;</div><div class="line">	<span class="keyword">private</span> String sex;</div></pre></td></tr></table></figure>
</li>
<li><p>映射文件<br>注意sql语句（即需要打印的信息）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.yao.mybatis.mapper.OrdersMapper"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 一对一映射之resultType --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findOrdersAndUser"</span> <span class="attr">resultType</span>=<span class="string">"com.yao.mybatis.po.OrdersExt"</span>&gt;</span></div><div class="line">		SELECT</div><div class="line">		orders.`id`,</div><div class="line">		orders.`user_id`,</div><div class="line">		orders.`number`,</div><div class="line">		user.`username`,</div><div class="line">		user.`sex`</div><div class="line">		FROM</div><div class="line">		orders,</div><div class="line">		USER</div><div class="line">		WHERE orders.`user_id` = user.`id`</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mapper</span>/&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>Mapper接口</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> interface <span class="title">OrderMapper</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;OrderExt&gt; <span class="title">findOrdersAndUser</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>测试代码<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> SqlSessionFactory sqlSessionFactory;</div><div class="line"></div><div class="line">	<span class="meta">@Before</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="comment">// 读取配置文件</span></div><div class="line">		<span class="comment">// 全局配置文件的路径</span></div><div class="line">		String resource = <span class="string">"SqlMapConfig.xml"</span>;</div><div class="line">		InputStream inputStream = Resources.getResourceAsStream(resource);</div><div class="line">		<span class="comment">// 创建SqlSessionFactory</span></div><div class="line">		sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindOrdersAndUser</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="comment">// 创建OrdersMapper对象</span></div><div class="line">		SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line"></div><div class="line">		OrdersMapper mapper = sqlSession.getMapper(OrdersMapper.class);</div><div class="line"></div><div class="line">		List&lt;OrdersExt&gt; list = mapper.findOrdersAndUser();</div><div class="line"></div><div class="line">		sqlSession.close();</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>打印出的结果是平铺的，有几条查询结果就有几个对象。</p>
<h4 id="一对一映射—-resultMap使用示例"><a href="#一对一映射—-resultMap使用示例" class="headerlink" title="一对一映射—-resultMap使用示例"></a>一对一映射—-resultMap使用示例</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.yao.mybatis.mapper.OrdersMapper"</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.yao.mybatis.po.OrdersExt"</span> <span class="attr">id</span>=<span class="string">"OrdersAndUserRstMap"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"user_id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"number"</span> <span class="attr">property</span>=<span class="string">"number"</span>/&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 用户信息（一对一） --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- association：一对一关联映射 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- property：关联信息查询的结果将要映射的扩展类中的对象属性名称 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- id标签：建议在关联查询时必须写上，不写不会报错，但是会影响性能 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"user"</span> <span class="attr">javaType</span>=<span class="string">"com.yao.mybatis.po.User"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"user_id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"username"</span> <span class="attr">property</span>=<span class="string">"username"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sex"</span> <span class="attr">property</span>=<span class="string">"sex"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 一对一映射之resultMap --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findOrdersAndUserRstMap"</span> <span class="attr">resultMap</span>=<span class="string">"OrdersAndUserRstMap"</span>&gt;</span></div><div class="line">		SELECT</div><div class="line">		orders.`id`,</div><div class="line">		orders.`user_id`,</div><div class="line">		orders.`number`,</div><div class="line">		user.`username`,</div><div class="line">		user.`sex`</div><div class="line">		FROM</div><div class="line">		orders,</div><div class="line">		USER</div><div class="line">		WHERE orders.`user_id` = user.`id`</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="1-2-一对多映射"><a href="#1-2-一对多映射" class="headerlink" title="1.2 一对多映射"></a>1.2 一对多映射</h3><ul>
<li>extends：可以继承一个已有的resultMap，指定resultMap的唯一标示即可。<strong>注意</strong>：继承时，只能继承type类型是一样的resultMap</li>
<li><strong>collection</strong> : 映射一对多关系</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.yao.mybatis.po.OrdersExt"</span> <span class="attr">id</span>=<span class="string">"OrdersAndDetailRstMap"</span></span></div><div class="line">	<span class="attr">extends</span>=<span class="string">"OrdersAndUserRstMap"</span>&gt;</div><div class="line">	<span class="comment">&lt;!-- 订单明细信息（一对多） --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- collection：映射一对多关系 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"detailList"</span> <span class="attr">ofType</span>=<span class="string">"com.yao.mybatis.po.Orderdetail"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"detailId"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"items_id"</span> <span class="attr">property</span>=<span class="string">"itemsId"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"items_num"</span> <span class="attr">property</span>=<span class="string">"itemsNum"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 一对多映射 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findOrdersAndDetailRstMap"</span> <span class="attr">resultMap</span>=<span class="string">"OrdersAndDetailRstMap"</span>&gt;</span></div><div class="line">	SELECT</div><div class="line">	orders.`id`,</div><div class="line">	orders.`user_id`,</div><div class="line">	orders.`number`,</div><div class="line">	user.`username`,</div><div class="line">	user.`sex`,</div><div class="line">	orderdetail.`id` detailId,</div><div class="line">	orderdetail.`items_id`,</div><div class="line">	orderdetail.`items_num`</div><div class="line">	FROM</div><div class="line">	orders,</div><div class="line">	USER,</div><div class="line">	orderdetail</div><div class="line">	WHERE</div><div class="line">	orders.`user_id` = user.`id`</div><div class="line">	AND orders.`id` = orderdetail.`orders_id`</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="1-3-多对多映射"><a href="#1-3-多对多映射" class="headerlink" title="1.3 多对多映射"></a>1.3 多对多映射</h3><h2 id="二-延迟加载"><a href="#二-延迟加载" class="headerlink" title="二 . 延迟加载"></a>二 . 延迟加载</h2><h2 id="三-缓存机制"><a href="#三-缓存机制" class="headerlink" title="三 . 缓存机制"></a>三 . 缓存机制</h2><h2 id="四-ehcache"><a href="#四-ehcache" class="headerlink" title="四 . ehcache"></a>四 . ehcache</h2><h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><p>对于访问响应速度要求高，但是实时性不高的查询，可以采用二级缓存技术。<br>注意：在使用二级缓存的时候，要设置一下刷新间隔（cache标签中有一个flashInterval属性）来定时刷新二级缓存，这个刷新间隔根据具体需求来设置，比如设置30分钟、60分钟等，单位为毫秒。</p>
<h3 id="局限性"><a href="#局限性" class="headerlink" title="局限性"></a>局限性</h3><p><strong><em>Mybatis二级缓存对细粒度的数据，缓存实现不好。</em></strong><br>场景：对商品信息进行缓存，由于商品信息查询访问量大，但是要求用户每次查询都是最新的商品信息，此时如果使用二级缓存，就无法实现当一个商品发生变化只刷新该商品的缓存信息而不刷新其他商品缓存信息，因为二级缓存是mapper级别的，当一个商品的信息发送更新，所有的商品信息缓存数据都会清空。<br>解决此类问题，需要在业务层根据需要对数据有针对性的缓存。<br><strong><em>比如可以对经常变化的数据操作单独放到另一个namespace的mapper中。</em></strong></p>
<h2 id="五-Mybatis整合spring"><a href="#五-Mybatis整合spring" class="headerlink" title="五 . Mybatis整合spring"></a>五 . Mybatis整合spring</h2><h3 id="5-1-整合思路"><a href="#5-1-整合思路" class="headerlink" title="5.1 整合思路"></a>5.1 整合思路</h3><ol>
<li>数据源信息交给spring管理</li>
<li>SqlSessionFactory交给spring进行<strong>单例</strong>管理</li>
<li>由spring来管理原始dao的实现类或mapper代理的代理类</li>
</ol>
<h3 id="5-2-需求"><a href="#5-2-需求" class="headerlink" title="5.2 需求"></a>5.2 需求</h3><p>使用原始dao方式和mapper代理方式实现以下功能：<br>根据用户id查询商品信息</p>
<h3 id="5-3-工程搭建"><a href="#5-3-工程搭建" class="headerlink" title="5.3 工程搭建"></a>5.3 工程搭建</h3><ul>
<li>Mysql的驱动包</li>
<li>Mybatis的和核心包和依赖包</li>
<li>Mybatis和spring的整合包</li>
<li>Spring包</li>
<li>dbcp数据库连接池</li>
</ul>
<h3 id="5-4-整合"><a href="#5-4-整合" class="headerlink" title="5.4 整合"></a>5.4 整合</h3><p>一共有两种方式，一种是原始dao方式，一种是Mapper映射文件代理的方式。</p>
<p><strong><em>1. 原始dao方法</em></strong> </p>
<p>1.1 将db.properties和log4j.properties拷贝到config目录下。</p>
<p>1.2 在config下，创建mybatis目录，然后创建SqlMapConfig.xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE configuration</span></div><div class="line">PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</div><div class="line">"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</div><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 自定义别名 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.yao.ms.po"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 加载映射文件 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"mybatis/sqlmap/User.xml"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>1.3 在config下，创建spring目录，然后创建applicationContext.xml;<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></div><div class="line">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></div><div class="line">	<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span> <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></div><div class="line">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">		http://www.springframework.org/schema/beans/spring-beans-3.2.xsd </div><div class="line">		http://www.springframework.org/schema/mvc </div><div class="line">		http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd </div><div class="line">		http://www.springframework.org/schema/context </div><div class="line">		http://www.springframework.org/schema/context/spring-context-3.2.xsd </div><div class="line">		http://www.springframework.org/schema/aop </div><div class="line">		http://www.springframework.org/schema/aop/spring-aop-3.2.xsd </div><div class="line">		http://www.springframework.org/schema/tx </div><div class="line">		http://www.springframework.org/schema/tx/spring-tx-3.2.xsd "&gt;</div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 加载java的配置文件 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"db.properties"</span> /&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 创建数据源 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbcp.BasicDataSource"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.driver&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.url&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.username&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.password&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxActive"</span> <span class="attr">value</span>=<span class="string">"10"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"5"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- SqlSessionFactory --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 指定mybatis的全局配置文件的路径 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"mybatis/SqlMapConfig.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 数据源 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- UserDao --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userDao"</span> <span class="attr">class</span>=<span class="string">"com.yao.ms.dao.UserDaoImpl"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 依赖注入SqlSessionFactory --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">beans</span>/&gt;</span></div></pre></td></tr></table></figure></p>
<p>1.4 在config/mybatis下创建sqlmap，然后创建User.xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE mapper    </span></div><div class="line">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    </div><div class="line">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"test"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 根据用户ID查询用户信息 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">		SELECT</div><div class="line">		* FROM USER WHERE id =#&#123;id&#125;</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>1.5 dao接口<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</div><div class="line">	<span class="comment">// 1、 根据用户ID查询用户信息</span></div><div class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> Exception</span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1.6 dao实现类<br>注意继承<strong>SqlSessionDaoSupport</strong>，并使用<strong>getSqlSession()</strong>进行数据库操作。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.getSqlSession().selectOne(<span class="string">"test.findUserById"</span>, id);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1.7 dao方法测试代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> ApplicationContext ctx;</div><div class="line"></div><div class="line">	<span class="meta">@Before</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		ctx = <span class="keyword">new</span> ClassPathXmlApplicationContext(</div><div class="line">				<span class="string">"spring/applicationContext.xml"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindUserById</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="comment">// 创建UserDao</span></div><div class="line">		UserDao dao = (UserDao) ctx.getBean(<span class="string">"userDao"</span>);</div><div class="line">		</div><div class="line">		User user = dao.findUserById(<span class="number">1</span>);</div><div class="line">		</div><div class="line">		System.out.println(user);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong><em>2. Mapper代理</em></strong><br>步骤1.1的添加数据库文件和日志文件 和 步骤 1.2的全局配置文件 保持不变</p>
<p>1.3 将映射文件放到UserMapper接口的同包下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE mapper    </span></div><div class="line">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    </div><div class="line">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.yao.ms.mapper.UserMapper"</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 根据用户ID查询用户信息 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></div><div class="line">		SELECT</div><div class="line">		* FROM USER WHERE id =#&#123;id&#125;</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>1.4 Mapper接口<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> interface <span class="title">UserMapper</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1.5 spring配置文件<br><strong>注意：</strong>配置Mapper代理类有两种方式：一种是单独配置，一种是批量配置。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></div><div class="line">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></div><div class="line">	<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span> <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></div><div class="line">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">		http://www.springframework.org/schema/beans/spring-beans-3.2.xsd </div><div class="line">		http://www.springframework.org/schema/mvc </div><div class="line">		http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd </div><div class="line">		http://www.springframework.org/schema/context </div><div class="line">		http://www.springframework.org/schema/context/spring-context-3.2.xsd </div><div class="line">		http://www.springframework.org/schema/aop </div><div class="line">		http://www.springframework.org/schema/aop/spring-aop-3.2.xsd </div><div class="line">		http://www.springframework.org/schema/tx </div><div class="line">		http://www.springframework.org/schema/tx/spring-tx-3.2.xsd "&gt;</div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 加载java的配置文件 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"db.properties"</span> /&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 创建数据源 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbcp.BasicDataSource"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.driver&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.url&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.username&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.password&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxActive"</span> <span class="attr">value</span>=<span class="string">"10"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"5"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- SqlSessionFactory --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 指定mybatis的全局配置文件的路径 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"mybatis/SqlMapConfig.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 数据源 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="comment">&lt;!--单独配置mapper代理类--&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 配置UserMapper代理类 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userMapper"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperFactoryBean"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 设置代理类的接口 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperInterface"</span> <span class="attr">value</span>=<span class="string">"com.yao.ms.mapper.UserMapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 依赖注入SqlSessionFactory --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!--批量配置mapper代理类--&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 批量配置mapper代理类，默认bean的id为类名首字母小写 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 配置扫描的包 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.yao.ms.mapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"></div><div class="line">		<span class="comment">&lt;!-- 默认不需要配置SqlSessionFactory（只有一个SqlSessionFactory时），单独配置也可以 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"sqlSessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/18/Mybatis学习二/" data-id="cj31o95050009pwtx7wjwqo5k" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Mybatis学习一" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/15/Mybatis学习一/" class="article-date">
  <time datetime="2017-05-15T01:58:00.311Z" itemprop="datePublished">2017-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/15/Mybatis学习一/">Mybatis学习一</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： Mybatis</p>
<hr>
<h2 id="一-简介"><a href="#一-简介" class="headerlink" title="一 . 简介"></a>一 . 简介</h2><p>mybatis就是一个封装来jdbc的持久层框架，它和hibernate都属于ORM框架，但是具体的说，hibernate是一个完全的orm框架，而mybatis是一个不完全的orm框架。</p>
<p>Mybatis可以让编写程序的人只关注sql本身，而不需要去关注如连接的创建、statement的创建等操作。</p>
<p>Mybatis会将<strong>输入参数、输出结果</strong>进行映射。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">			Connection connection = <span class="keyword">null</span>;</div><div class="line">			PreparedStatement preparedStatement = <span class="keyword">null</span>;</div><div class="line">			ResultSet resultSet = <span class="keyword">null</span>;</div><div class="line">			</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				<span class="comment">//1、加载数据库驱动</span></div><div class="line">				Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</div><div class="line">				<span class="comment">//2、通过驱动管理类获取数据库链接</span></div><div class="line">				connection =  DriverManager.getConnection(<span class="string">"jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>);</div><div class="line">				<span class="comment">//3、定义sql语句 ?表示占位符</span></div><div class="line">			String sql = <span class="string">"select * from user where username = ?"</span>;</div><div class="line">				<span class="comment">//4、获取预处理statement</span></div><div class="line">				preparedStatement = connection.prepareStatement(sql);</div><div class="line">				<span class="comment">//5、设置参数，第一个参数为sql语句中参数的序号（从1开始），第二个参数为设置的参数值</span></div><div class="line">				preparedStatement.setString(<span class="number">1</span>, <span class="string">"王五"</span>);</div><div class="line">				<span class="comment">//6、向数据库发出sql执行查询，查询出结果集</span></div><div class="line">				resultSet =  preparedStatement.executeQuery();</div><div class="line">				<span class="comment">//7、遍历查询结果集</span></div><div class="line">				<span class="keyword">while</span>(resultSet.next())&#123;</div><div class="line">					System.out.println(resultSet.getString(<span class="string">"id"</span>)+<span class="string">"  "</span>+resultSet.getString(<span class="string">"username"</span>));</div><div class="line">				&#125;</div><div class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;<span class="keyword">finally</span>&#123;</div><div class="line">				<span class="comment">//8、释放资源</span></div><div class="line">				<span class="keyword">if</span>(resultSet!=<span class="keyword">null</span>)&#123;</div><div class="line">					<span class="keyword">try</span> &#123;</div><div class="line">						resultSet.close();</div><div class="line">					&#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">						<span class="comment">// TODO Auto-generated catch block</span></div><div class="line">						e.printStackTrace();</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span>(preparedStatement!=<span class="keyword">null</span>)&#123;</div><div class="line">					<span class="keyword">try</span> &#123;</div><div class="line">						preparedStatement.close();</div><div class="line">					&#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">						<span class="comment">// TODO Auto-generated catch block</span></div><div class="line">						e.printStackTrace();</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span>(connection!=<span class="keyword">null</span>)&#123;</div><div class="line">					<span class="keyword">try</span> &#123;</div><div class="line">						connection.close();</div><div class="line">					&#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">						<span class="comment">// TODO Auto-generated catch block</span></div><div class="line">						e.printStackTrace();</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">			&#125;</div><div class="line"></div><div class="line">		&#125;</div></pre></td></tr></table></figure>
<p>上述原始的Jdbc操作中，存在硬编码和频繁连接数据库的问题。<br>需解决此问题：</p>
<ul>
<li>在创建连接时使用全局配置文件；</li>
<li>在执行statement时配置映射文件；</li>
<li>在频繁连接和关闭数据库连接时，要使用数据库连接池。</li>
</ul>
<h2 id="二-Mybatis框架原理"><a href="#二-Mybatis框架原理" class="headerlink" title="二 . Mybatis框架原理"></a>二 . Mybatis框架原理</h2><ul>
<li><p>mybatis配置文件，包括Mybatis全局配置文件和Mybatis映射文件，<br>其中<strong>全局配置文件</strong>配置了数据源、事务等信息；<strong>映射文件</strong>配置了SQL执行相关的信息。</p>
</li>
<li><p>Mybatis通过读取配置文件信息（全局配置文件和映射文件），构造出SqlSessionFactory，即会话工厂。然后通过SqlSessionFactory，可以创建SqlSession即会话。Mybatis是通过SqlSession来操作数据库的。</p>
</li>
<li><p>SqlSession本身不能直接操作数据库，它是通过底层的Executor执行器接口来操作数据库的。Executor接口有两个实现类，一个是普通执行器，一个是<strong>缓存执行器（默认）</strong>。</p>
</li>
</ul>
<p><strong>注意：</strong>在执行<strong><em>增删改</em></strong>的操作时需要对SqlSession执行commit操作!!!</p>
<h2 id="三-原始Dao开发方式和Mapper代理开发方式"><a href="#三-原始Dao开发方式和Mapper代理开发方式" class="headerlink" title="三 . 原始Dao开发方式和Mapper代理开发方式"></a>三 . 原始Dao开发方式和Mapper代理开发方式</h2><p>原始Dao开发会存在一些模板代码和硬编码，因此选择Mapper代理开发方式。</p>
<p>Mapper代理开发方式的开发步骤：</p>
<ol>
<li>根据需求创建PO类</li>
<li>编写全局配置文件 —-  SqlMapConfig.xml</li>
<li>根据需求编写映射文件 —- UserMapper.xml</li>
<li>加载映射文件</li>
<li>编写Mapper接口</li>
</ol>
<p>第一步和第二步省略。SqlMapConfig.xml中配置了数据源和事务管理，并加载映射文件.<br><strong>根据需求编写映射文件</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE mapper    </span></div><div class="line">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    </div><div class="line">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</div><div class="line"><span class="comment">&lt;!-- namespace：此时用mapper代理方式，它的值必须等于对应mapper接口的全限定名  --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"cn.yao.mybatis.mapper.UserMapper"</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 根据用户ID，查询用户信息 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- </span></div><div class="line">		[id]：statement的id，要求在命名空间内唯一  </div><div class="line">		[parameterType]：入参的java类型，可是是简单类型、POJO、HashMap</div><div class="line">		[resultType]：查询出的单条结果集对应的java类型</div><div class="line">		[#&#123;&#125;]： 表示一个占位符?</div><div class="line">		[#&#123;id&#125;]：表示该占位符待接收参数的名称为id。注意：如果参数为简单类型时，#&#123;&#125;里面的参数名称可以是任意定义</div><div class="line">	 --&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"cn.yao.mybatis.po.User"</span>&gt;</span></div><div class="line">		SELECT * FROM USER WHERE id = #&#123;id&#125;</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">	</div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 根据用户名称模糊查询用户信息列表 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- </span></div><div class="line">		[$&#123;&#125;]：表示拼接SQL字符串，即不加解释的原样输出</div><div class="line">	 	[$&#123;value&#125;]：表示要拼接的是简单类型参数。</div><div class="line">		 注意：</div><div class="line">		1、如果参数为简单类型时，$&#123;&#125;里面的参数名称必须为value </div><div class="line">		2、$&#123;&#125;会引起SQL注入，一般情况下不推荐使用。但是有些场景必须使用$&#123;&#125;，比如order by $&#123;colname&#125;</div><div class="line">	--&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUsersByName"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.String"</span> <span class="attr">resultType</span>=<span class="string">"cn.yao.mybatis.po.User"</span>&gt;</span></div><div class="line">		SELECT * FROM USER WHERE username LIKE '%$&#123;value&#125;%'</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 添加用户之自增主键返回（selectKey方式） --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- </span></div><div class="line">		[selectKey标签]：通过select查询来生成主键</div><div class="line">		[keyProperty]：指定存放生成主键的属性</div><div class="line">		[resultType]：生成主键所对应的Java类型</div><div class="line">		[order]：指定该查询主键SQL语句的执行顺序，相对于insert语句，此时选用AFTER</div><div class="line">		[last_insert_id]：MySQL的函数，要配合insert语句一起使用</div><div class="line">	 --&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertUser"</span> <span class="attr">parameterType</span>=<span class="string">"cn.yao.mybatis.po.User"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span> <span class="attr">resultType</span>=<span class="string">"int"</span> <span class="attr">order</span>=<span class="string">"AFTER"</span>&gt;</span></div><div class="line">			SELECT LAST_INSERT_ID()</div><div class="line">		<span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></div><div class="line">		INSERT INTO USER(username,sex,birthday,address) VALUES (#&#123;username&#125;,#&#123;sex&#125;,#&#123;birthday&#125;,#&#123;address&#125;)</div><div class="line">	<span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div><div class="line">	</div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><strong>加载mapper映射文件</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"mapper/UserMapper.xml"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><strong>编写mapper接口</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</div><div class="line">	<span class="comment">//根据用户ID来查询用户信息</span></div><div class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</div><div class="line">	<span class="comment">//根据用户名称来模糊查询用户信息列表</span></div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findUsersByName</span><span class="params">(String username)</span></span>;</div><div class="line">	<span class="comment">//添加用户</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUser</span><span class="params">(User user)</span></span>;</div></pre></td></tr></table></figure></p>
<h2 id="四-全局配置文件"><a href="#四-全局配置文件" class="headerlink" title="四 . 全局配置文件"></a>四 . 全局配置文件</h2><p>全局配置文件的命名可以是任意的，本文中就使用SqlMapConfig.xml来表示。</p>
<p><strong><em>SqlMapConfig.xml的配置内容和顺序如下（顺序不能乱）：</em></strong><br>Properties（属性）<br>Settings（全局参数设置）<br>typeAliases（类型别名）<br>typeHandlers（类型处理器）<br>objectFactory（对象工厂）<br>plugins（插件）<br>environments（环境信息集合）<br>———-environment（单个环境信息）<br>——————-transactionManager（事物）<br>——————-dataSource（数据源）<br>mappers（映射器）</p>
<h3 id="4-1-Properties"><a href="#4-1-Properties" class="headerlink" title="4.1 Properties"></a>4.1 Properties</h3><p>Db.properties<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">db.driver=com.mysql.jdbc.Driver</div><div class="line">db.url=jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;characterEncoding=utf8</div><div class="line">db.username=root</div><div class="line">db.password=root</div></pre></td></tr></table></figure></p>
<p>SqlMapConfig.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 加载java的配置文件或者声明属性信息 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"db.username"</span> <span class="attr">value</span>=<span class="string">"123"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 配置mybatis的环境信息，与spring整合，该信息由spring来管理 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 配置JDBC事务控制，由mybatis进行管理 --&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 配置数据源，采用mybatis连接池 --&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.driver&#125;"</span> /&gt;</span></div><div class="line">				</div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.url&#125;"</span> /&gt;</span></div><div class="line">				</div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.username&#125;"</span> /&gt;</span></div><div class="line">				</div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.password&#125;"</span> /&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="4-2-Settings"><a href="#4-2-Settings" class="headerlink" title="4.2 Settings"></a>4.2 Settings</h3><h3 id="4-3-typeAliases"><a href="#4-3-typeAliases" class="headerlink" title="4.3 typeAliases"></a>4.3 typeAliases</h3><p>对po类进行别名的定义,在开发中会更加方便<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 单个别名定义 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- &lt;typeAlias type="com.itheima.mybatis.po.User" alias="user"/&gt; --&gt;</span></div><div class="line"></div><div class="line">		<span class="comment">&lt;!-- 批量别名定义（推荐） --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- package：指定包名称来为该包下的po类声明别名，默认的别名就是类名（首字母大小写都可） --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.itheima.mybatis.po"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="4-4-Mapper"><a href="#4-4-Mapper" class="headerlink" title="4.4 Mapper"></a>4.4 Mapper</h3><p>注册指定包下的映射文件<br><strong><em>注意：此种方法要求mapper接口和mapper映射文件要名称相同，且放到同一个目录下；</em></strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"User.xml"</span> /&gt;</span></div><div class="line">	<span class="comment">&lt;!-- &lt;mapper resource="mapper/UserMapper.xml" /&gt; --&gt;</span></div><div class="line"></div><div class="line">		<span class="comment">&lt;!-- 批量加载映射文件 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.yao.mybatis.mapper"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="五-映射文件"><a href="#五-映射文件" class="headerlink" title="五 . 映射文件"></a>五 . 映射文件</h2><h3 id="5-1-输入映射"><a href="#5-1-输入映射" class="headerlink" title="5.1 输入映射"></a>5.1 输入映射</h3><p>可分为四种:</p>
<ul>
<li>简单类型</li>
<li>Pojo类型</li>
<li>包装Pojo类型</li>
<li>Map</li>
</ul>
<h3 id="5-2-输出映射"><a href="#5-2-输出映射" class="headerlink" title="5.2 输出映射"></a>5.2 输出映射</h3><h4 id="5-2-1-resultType"><a href="#5-2-1-resultType" class="headerlink" title="5.2.1 resultType"></a>5.2.1 resultType</h4><h4 id="5-2-2-resultMap"><a href="#5-2-2-resultMap" class="headerlink" title="5.2.2    resultMap"></a>5.2.2    resultMap</h4><p>resultMap可以进行高级结果映射<strong>（一对一、一对多映射)</strong></p>
<ul>
<li><p>使用resultType进行结果映射时，需要查询出的列名和映射的对象的属性名一致，才能映射成功。</p>
</li>
<li><p>如果查询的列名和对象的属性名全部不一致，那么映射的对象为空。</p>
</li>
<li><p>如果查询的列名和对象的属性名有一个一致，那么映射的对象不为空，但是只有映射正确那一个属性才有值。</p>
</li>
<li><p>如果查询的sql的列名有别名，那么这个别名就是和属性映射的列名。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;!-- resultMap入门 --&gt;</div><div class="line">	&lt;!-- id标签：专门为查询结果中唯一列映射 --&gt;</div><div class="line">	&lt;!-- result标签：映射查询结果中的普通列 --&gt;</div><div class="line">	&lt;resultMap type=&quot;user&quot; id=&quot;UserRstMap&quot;&gt;</div><div class="line">		&lt;id column=&quot;id_&quot; property=&quot;id&quot; /&gt;</div><div class="line">		&lt;result column=&quot;username_&quot; property=&quot;username&quot; /&gt;</div><div class="line">		&lt;result column=&quot;sex_&quot; property=&quot;sex&quot; /&gt;</div><div class="line">	&lt;/resultMap&gt;</div><div class="line"></div><div class="line">	&lt;select id=&quot;findUserRstMap&quot; parameterType=&quot;int&quot; resultMap=&quot;UserRstMap&quot;&gt;</div><div class="line">		Select id id_,username username_,sex sex_ from user where id = #&#123;id&#125;</div><div class="line">	&lt;/select&gt;</div></pre></td></tr></table></figure>
<h3 id="5-3-动态sql"><a href="#5-3-动态sql" class="headerlink" title="5.3 动态sql"></a>5.3 动态sql</h3><p>在mybatis中，它提供了一些动态sql标签，可以更快地进行mybatis的开发，这些动态sql可以提高sql的可重用性。<br>常用的动态sql标签：if标签、where标签、sql片段、foreach标签</p>
<ul>
<li><p>If标签：作为判断入参来使用的，如果符合条件，则把if标签体内的SQL拼接上。<br>注意：用if进行判断是否为空时，不仅要判断null，也要判断空字符串‘’；</p>
</li>
<li><p>Where标签：会去掉条件中的第一个and符号。</p>
</li>
<li><p>向sql传递数组或List时，mybatis使用foreach解析数组里的参数并拼接到SQL中。</p>
</li>
</ul>
<p><strong><em>sql片段</em></strong><br>sql片段可提高代码的重用性。<br>sql片段需要先定义后使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 定义sql片段 --&gt;</div><div class="line">	&lt;!-- sql片段内，可以定义sql语句中任何部分 --&gt;</div><div class="line">	&lt;!-- sql片段内，最好不用将where和select关键字声明在内 --&gt;</div><div class="line">	&lt;sql id=&quot;whereClause&quot;&gt;</div><div class="line">		&lt;!-- if标签：可以对输入的参数进行判断 --&gt;</div><div class="line">		&lt;!-- test:指定判断表达式 --&gt;</div><div class="line">		&lt;if test=&quot;user != null&quot;&gt;</div><div class="line">			&lt;if test=&quot;user.username != null and user.username != &apos;&apos;&quot;&gt;</div><div class="line">				AND username LIKE &apos;%$&#123;user.username&#125;%&apos;</div><div class="line">			&lt;/if&gt;</div><div class="line">			&lt;if test=&quot;user.sex != null and user.sex != &apos;&apos;&quot;&gt;</div><div class="line">				AND sex = #&#123;user.sex&#125;</div><div class="line">			&lt;/if&gt;</div><div class="line">		&lt;/if&gt;</div><div class="line">		</div><div class="line">&lt;!-- 综合查询，查询用户列表 --&gt;</div><div class="line">	&lt;select id=&quot;findUserList&quot; parameterType=&quot;com.yao.mybatis.po.UserQueryVO&quot;</div><div class="line">		resultType=&quot;user&quot;&gt;</div><div class="line">		SELECT * FROM user</div><div class="line">		&lt;!-- where标签：默认去掉后面第一个AND，如果没有参数，则把自己干掉 --&gt;</div><div class="line">		&lt;where&gt;</div><div class="line">			&lt;!-- 引入sql片段 --&gt;</div><div class="line">			&lt;include refid=&quot;whereClause&quot; /&gt;</div><div class="line">		&lt;/where&gt;</div><div class="line">	&lt;/select&gt;</div><div class="line"></div><div class="line">	&lt;!-- 综合查询用户总数 --&gt;</div><div class="line">	&lt;select id=&quot;findUserCount&quot; parameterType=&quot;com.yao.mybatis.po.UserQueryVO&quot;</div><div class="line">		resultType=&quot;int&quot;&gt;</div><div class="line">		SELECT count(*) FROM user</div><div class="line">		&lt;!-- where标签：默认去掉后面第一个AND，如果没有参数，则把自己干掉 --&gt;</div><div class="line">		&lt;where&gt;</div><div class="line">			&lt;!-- 引入sql片段 --&gt;</div><div class="line">			&lt;include refid=&quot;whereClause&quot; /&gt;</div><div class="line">		&lt;/where&gt;</div><div class="line">	&lt;/select&gt;</div></pre></td></tr></table></figure></p>
<p><strong><em><code>&lt;for:each&gt;</code>标签</em></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;if test=&quot;idList != null&quot;&gt;</div><div class="line">			&lt;!-- AND id IN (#&#123;id&#125;,#&#123;id&#125;,#&#123;id&#125;) --&gt;</div><div class="line"></div><div class="line">			&lt;!-- collection：表示pojo中集合属性的属性名称 --&gt;</div><div class="line">			&lt;!-- item:为遍历出的结果声明一个变量名称 --&gt;</div><div class="line">			&lt;!-- open：遍历开始时，需要拼接的字符串 --&gt;</div><div class="line">			&lt;!-- close:遍历结束时，需要拼接的字符串 --&gt;</div><div class="line">			&lt;!-- separator：遍历中间需要拼接的连接符 --&gt;</div><div class="line">			AND id IN</div><div class="line">			&lt;foreach collection=&quot;idList&quot; item=&quot;id&quot; open=&quot;(&quot; close=&quot;)&quot;</div><div class="line">				separator=&quot;,&quot;&gt;</div><div class="line">				#&#123;id&#125;</div><div class="line">			&lt;/foreach&gt;</div><div class="line">		&lt;/if&gt;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/15/Mybatis学习一/" data-id="cj31o9507000apwtxf920gc5d" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Mybatis学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/14/Mybatis学习/" class="article-date">
  <time datetime="2017-05-14T14:21:09.349Z" itemprop="datePublished">2017-05-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/14/Mybatis学习/">Mybatis学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： Mybatis</p>
<hr>
<h2 id="一-简介"><a href="#一-简介" class="headerlink" title="一 . 简介"></a>一 . 简介</h2><p>mybatis就是一个封装来jdbc的持久层框架，它和hibernate都属于ORM框架，但是具体的说，hibernate是一个完全的orm框架，而mybatis是一个不完全的orm框架。</p>
<p>Mybatis可以让编写程序的人只关注sql本身，而不需要去关注如连接的创建、statement的创建等操作。</p>
<p>Mybatis会将<strong>输入参数、输出结果</strong>进行映射。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">			Connection connection = <span class="keyword">null</span>;</div><div class="line">			PreparedStatement preparedStatement = <span class="keyword">null</span>;</div><div class="line">			ResultSet resultSet = <span class="keyword">null</span>;</div><div class="line">			</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				<span class="comment">//1、加载数据库驱动</span></div><div class="line">				Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</div><div class="line">				<span class="comment">//2、通过驱动管理类获取数据库链接</span></div><div class="line">				connection =  DriverManager.getConnection(<span class="string">"jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>);</div><div class="line">				<span class="comment">//3、定义sql语句 ?表示占位符</span></div><div class="line">			String sql = <span class="string">"select * from user where username = ?"</span>;</div><div class="line">				<span class="comment">//4、获取预处理statement</span></div><div class="line">				preparedStatement = connection.prepareStatement(sql);</div><div class="line">				<span class="comment">//5、设置参数，第一个参数为sql语句中参数的序号（从1开始），第二个参数为设置的参数值</span></div><div class="line">				preparedStatement.setString(<span class="number">1</span>, <span class="string">"王五"</span>);</div><div class="line">				<span class="comment">//6、向数据库发出sql执行查询，查询出结果集</span></div><div class="line">				resultSet =  preparedStatement.executeQuery();</div><div class="line">				<span class="comment">//7、遍历查询结果集</span></div><div class="line">				<span class="keyword">while</span>(resultSet.next())&#123;</div><div class="line">					System.out.println(resultSet.getString(<span class="string">"id"</span>)+<span class="string">"  "</span>+resultSet.getString(<span class="string">"username"</span>));</div><div class="line">				&#125;</div><div class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;<span class="keyword">finally</span>&#123;</div><div class="line">				<span class="comment">//8、释放资源</span></div><div class="line">				<span class="keyword">if</span>(resultSet!=<span class="keyword">null</span>)&#123;</div><div class="line">					<span class="keyword">try</span> &#123;</div><div class="line">						resultSet.close();</div><div class="line">					&#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">						<span class="comment">// TODO Auto-generated catch block</span></div><div class="line">						e.printStackTrace();</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span>(preparedStatement!=<span class="keyword">null</span>)&#123;</div><div class="line">					<span class="keyword">try</span> &#123;</div><div class="line">						preparedStatement.close();</div><div class="line">					&#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">						<span class="comment">// TODO Auto-generated catch block</span></div><div class="line">						e.printStackTrace();</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span>(connection!=<span class="keyword">null</span>)&#123;</div><div class="line">					<span class="keyword">try</span> &#123;</div><div class="line">						connection.close();</div><div class="line">					&#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">						<span class="comment">// TODO Auto-generated catch block</span></div><div class="line">						e.printStackTrace();</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">			&#125;</div><div class="line"></div><div class="line">		&#125;</div></pre></td></tr></table></figure>
<p>上述原始的Jdbc操作中，存在硬编码和频繁连接数据库的问题。<br>需解决此问题：</p>
<ul>
<li>在创建连接时使用全局配置文件；</li>
<li>在执行statement时配置映射文件；</li>
<li>在频繁连接和关闭数据库连接时，要使用数据库连接池。</li>
</ul>
<h2 id="二-Mybatis框架原理"><a href="#二-Mybatis框架原理" class="headerlink" title="二 . Mybatis框架原理"></a>二 . Mybatis框架原理</h2><ul>
<li><p>mybatis配置文件，包括Mybatis全局配置文件和Mybatis映射文件，<br>其中<strong>全局配置文件</strong>配置了数据源、事务等信息；<strong>映射文件</strong>配置了SQL执行相关的信息。</p>
</li>
<li><p>Mybatis通过读取配置文件信息（全局配置文件和映射文件），构造出SqlSessionFactory，即会话工厂。然后通过SqlSessionFactory，可以创建SqlSession即会话。Mybatis是通过SqlSession来操作数据库的。</p>
</li>
<li><p>SqlSession本身不能直接操作数据库，它是通过底层的Executor执行器接口来操作数据库的。Executor接口有两个实现类，一个是普通执行器，一个是<strong>缓存执行器（默认）</strong>。</p>
</li>
</ul>
<p><strong>注意：</strong>在执行<strong><em>增删改</em></strong>的操作时需要对SqlSession执行commit操作!!!</p>
<h2 id="三-原始Dao开发方式和Mapper代理开发方式"><a href="#三-原始Dao开发方式和Mapper代理开发方式" class="headerlink" title="三 . 原始Dao开发方式和Mapper代理开发方式"></a>三 . 原始Dao开发方式和Mapper代理开发方式</h2><p>原始Dao开发会存在一些模板代码和硬编码，因此选择Mapper代理开发方式。</p>
<p>Mapper代理开发方式的开发步骤：</p>
<ol>
<li>根据需求创建PO类</li>
<li>编写全局配置文件 —-  SqlMapConfig.xml</li>
<li>根据需求编写映射文件 —- UserMapper.xml</li>
<li>加载映射文件</li>
<li>编写Mapper接口</li>
</ol>
<p>第一步和第二步省略。SqlMapConfig.xml中配置了数据源和事务管理，并加载映射文件.<br><strong>根据需求编写映射文件</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE mapper    </span></div><div class="line">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    </div><div class="line">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</div><div class="line"><span class="comment">&lt;!-- namespace：此时用mapper代理方式，它的值必须等于对应mapper接口的全限定名  --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"cn.yao.mybatis.mapper.UserMapper"</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 根据用户ID，查询用户信息 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- </span></div><div class="line">		[id]：statement的id，要求在命名空间内唯一  </div><div class="line">		[parameterType]：入参的java类型，可是是简单类型、POJO、HashMap</div><div class="line">		[resultType]：查询出的单条结果集对应的java类型</div><div class="line">		[#&#123;&#125;]： 表示一个占位符?</div><div class="line">		[#&#123;id&#125;]：表示该占位符待接收参数的名称为id。注意：如果参数为简单类型时，#&#123;&#125;里面的参数名称可以是任意定义</div><div class="line">	 --&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"cn.yao.mybatis.po.User"</span>&gt;</span></div><div class="line">		SELECT * FROM USER WHERE id = #&#123;id&#125;</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">	</div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 根据用户名称模糊查询用户信息列表 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- </span></div><div class="line">		[$&#123;&#125;]：表示拼接SQL字符串，即不加解释的原样输出</div><div class="line">	 	[$&#123;value&#125;]：表示要拼接的是简单类型参数。</div><div class="line">		 注意：</div><div class="line">		1、如果参数为简单类型时，$&#123;&#125;里面的参数名称必须为value </div><div class="line">		2、$&#123;&#125;会引起SQL注入，一般情况下不推荐使用。但是有些场景必须使用$&#123;&#125;，比如order by $&#123;colname&#125;</div><div class="line">	--&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUsersByName"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.String"</span> <span class="attr">resultType</span>=<span class="string">"cn.yao.mybatis.po.User"</span>&gt;</span></div><div class="line">		SELECT * FROM USER WHERE username LIKE '%$&#123;value&#125;%'</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- 添加用户之自增主键返回（selectKey方式） --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- </span></div><div class="line">		[selectKey标签]：通过select查询来生成主键</div><div class="line">		[keyProperty]：指定存放生成主键的属性</div><div class="line">		[resultType]：生成主键所对应的Java类型</div><div class="line">		[order]：指定该查询主键SQL语句的执行顺序，相对于insert语句，此时选用AFTER</div><div class="line">		[last_insert_id]：MySQL的函数，要配合insert语句一起使用</div><div class="line">	 --&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertUser"</span> <span class="attr">parameterType</span>=<span class="string">"cn.yao.mybatis.po.User"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span> <span class="attr">resultType</span>=<span class="string">"int"</span> <span class="attr">order</span>=<span class="string">"AFTER"</span>&gt;</span></div><div class="line">			SELECT LAST_INSERT_ID()</div><div class="line">		<span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></div><div class="line">		INSERT INTO USER(username,sex,birthday,address) VALUES (#&#123;username&#125;,#&#123;sex&#125;,#&#123;birthday&#125;,#&#123;address&#125;)</div><div class="line">	<span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div><div class="line">	</div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><strong>加载mapper映射文件</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"mapper/UserMapper.xml"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><strong>编写mapper接口</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</div><div class="line">	<span class="comment">//根据用户ID来查询用户信息</span></div><div class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</div><div class="line">	<span class="comment">//根据用户名称来模糊查询用户信息列表</span></div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findUsersByName</span><span class="params">(String username)</span></span>;</div><div class="line">	<span class="comment">//添加用户</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUser</span><span class="params">(User user)</span></span>;</div></pre></td></tr></table></figure></p>
<h2 id="四-全局配置文件"><a href="#四-全局配置文件" class="headerlink" title="四 . 全局配置文件"></a>四 . 全局配置文件</h2><p>全局配置文件的命名可以是任意的，本文中就使用SqlMapConfig.xml来表示。</p>
<p><strong><em>SqlMapConfig.xml的配置内容和顺序如下（顺序不能乱）：</em></strong><br>Properties（属性）<br>Settings（全局参数设置）<br>typeAliases（类型别名）<br>typeHandlers（类型处理器）<br>objectFactory（对象工厂）<br>plugins（插件）<br>environments（环境信息集合）<br>———-environment（单个环境信息）<br>——————-transactionManager（事物）<br>——————-dataSource（数据源）<br>mappers（映射器）</p>
<h3 id="4-1-Properties"><a href="#4-1-Properties" class="headerlink" title="4.1 Properties"></a>4.1 Properties</h3><p>Db.properties<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">db.driver=com.mysql.jdbc.Driver</div><div class="line">db.url=jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;characterEncoding=utf8</div><div class="line">db.username=root</div><div class="line">db.password=root</div></pre></td></tr></table></figure></p>
<p>SqlMapConfig.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 加载java的配置文件或者声明属性信息 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"db.username"</span> <span class="attr">value</span>=<span class="string">"123"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 配置mybatis的环境信息，与spring整合，该信息由spring来管理 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 配置JDBC事务控制，由mybatis进行管理 --&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 配置数据源，采用mybatis连接池 --&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.driver&#125;"</span> /&gt;</span></div><div class="line">				</div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.url&#125;"</span> /&gt;</span></div><div class="line">				</div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.username&#125;"</span> /&gt;</span></div><div class="line">				</div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;db.password&#125;"</span> /&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="4-2-Settings"><a href="#4-2-Settings" class="headerlink" title="4.2 Settings"></a>4.2 Settings</h3><h3 id="4-3-typeAliases"><a href="#4-3-typeAliases" class="headerlink" title="4.3 typeAliases"></a>4.3 typeAliases</h3><p>对po类进行别名的定义,在开发中会更加方便<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 单个别名定义 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- &lt;typeAlias type="com.itheima.mybatis.po.User" alias="user"/&gt; --&gt;</span></div><div class="line"></div><div class="line">		<span class="comment">&lt;!-- 批量别名定义（推荐） --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- package：指定包名称来为该包下的po类声明别名，默认的别名就是类名（首字母大小写都可） --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.itheima.mybatis.po"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="4-4-Mapper"><a href="#4-4-Mapper" class="headerlink" title="4.4 Mapper"></a>4.4 Mapper</h3><p>注册指定包下的映射文件<br><strong><em>注意：此种方法要求mapper接口和mapper映射文件要名称相同，且放到同一个目录下；</em></strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"User.xml"</span> /&gt;</span></div><div class="line">	<span class="comment">&lt;!-- &lt;mapper resource="mapper/UserMapper.xml" /&gt; --&gt;</span></div><div class="line"></div><div class="line">		<span class="comment">&lt;!-- 批量加载映射文件 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.yao.mybatis.mapper"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="五-映射文件"><a href="#五-映射文件" class="headerlink" title="五 . 映射文件"></a>五 . 映射文件</h2><h3 id="5-1-输入映射"><a href="#5-1-输入映射" class="headerlink" title="5.1 输入映射"></a>5.1 输入映射</h3><p>可分为四种:</p>
<ul>
<li>简单类型</li>
<li>Pojo类型</li>
<li>包装Pojo类型</li>
<li>Map</li>
</ul>
<h3 id="5-2-输出映射"><a href="#5-2-输出映射" class="headerlink" title="5.2 输出映射"></a>5.2 输出映射</h3><h4 id="5-2-1-resultType"><a href="#5-2-1-resultType" class="headerlink" title="5.2.1 resultType"></a>5.2.1 resultType</h4><h4 id="5-2-2-resultMap"><a href="#5-2-2-resultMap" class="headerlink" title="5.2.2    resultMap"></a>5.2.2    resultMap</h4><p>resultMap可以进行高级结果映射<strong>（一对一、一对多映射)</strong></p>
<ul>
<li><p>使用resultType进行结果映射时，需要查询出的列名和映射的对象的属性名一致，才能映射成功。</p>
</li>
<li><p>如果查询的列名和对象的属性名全部不一致，那么映射的对象为空。</p>
</li>
<li><p>如果查询的列名和对象的属性名有一个一致，那么映射的对象不为空，但是只有映射正确那一个属性才有值。</p>
</li>
<li><p>如果查询的sql的列名有别名，那么这个别名就是和属性映射的列名。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;!-- resultMap入门 --&gt;</div><div class="line">	&lt;!-- id标签：专门为查询结果中唯一列映射 --&gt;</div><div class="line">	&lt;!-- result标签：映射查询结果中的普通列 --&gt;</div><div class="line">	&lt;resultMap type=&quot;user&quot; id=&quot;UserRstMap&quot;&gt;</div><div class="line">		&lt;id column=&quot;id_&quot; property=&quot;id&quot; /&gt;</div><div class="line">		&lt;result column=&quot;username_&quot; property=&quot;username&quot; /&gt;</div><div class="line">		&lt;result column=&quot;sex_&quot; property=&quot;sex&quot; /&gt;</div><div class="line">	&lt;/resultMap&gt;</div><div class="line"></div><div class="line">	&lt;select id=&quot;findUserRstMap&quot; parameterType=&quot;int&quot; resultMap=&quot;UserRstMap&quot;&gt;</div><div class="line">		Select id id_,username username_,sex sex_ from user where id = #&#123;id&#125;</div><div class="line">	&lt;/select&gt;</div></pre></td></tr></table></figure>
<h3 id="5-3-动态sql"><a href="#5-3-动态sql" class="headerlink" title="5.3 动态sql"></a>5.3 动态sql</h3><p>在mybatis中，它提供了一些动态sql标签，可以更快地进行mybatis的开发，这些动态sql可以提高sql的可重用性。<br>常用的动态sql标签：if标签、where标签、sql片段、foreach标签</p>
<ul>
<li><p>If标签：作为判断入参来使用的，如果符合条件，则把if标签体内的SQL拼接上。<br>注意：用if进行判断是否为空时，不仅要判断null，也要判断空字符串‘’；</p>
</li>
<li><p>Where标签：会去掉条件中的第一个and符号。</p>
</li>
<li><p>向sql传递数组或List时，mybatis使用foreach解析数组里的参数并拼接到SQL中。</p>
</li>
</ul>
<p><strong><em>sql片段</em></strong><br>sql片段可提高代码的重用性。<br>sql片段需要先定义后使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 定义sql片段 --&gt;</div><div class="line">	&lt;!-- sql片段内，可以定义sql语句中任何部分 --&gt;</div><div class="line">	&lt;!-- sql片段内，最好不用将where和select关键字声明在内 --&gt;</div><div class="line">	&lt;sql id=&quot;whereClause&quot;&gt;</div><div class="line">		&lt;!-- if标签：可以对输入的参数进行判断 --&gt;</div><div class="line">		&lt;!-- test:指定判断表达式 --&gt;</div><div class="line">		&lt;if test=&quot;user != null&quot;&gt;</div><div class="line">			&lt;if test=&quot;user.username != null and user.username != &apos;&apos;&quot;&gt;</div><div class="line">				AND username LIKE &apos;%$&#123;user.username&#125;%&apos;</div><div class="line">			&lt;/if&gt;</div><div class="line">			&lt;if test=&quot;user.sex != null and user.sex != &apos;&apos;&quot;&gt;</div><div class="line">				AND sex = #&#123;user.sex&#125;</div><div class="line">			&lt;/if&gt;</div><div class="line">		&lt;/if&gt;</div><div class="line">		</div><div class="line">&lt;!-- 综合查询，查询用户列表 --&gt;</div><div class="line">	&lt;select id=&quot;findUserList&quot; parameterType=&quot;com.yao.mybatis.po.UserQueryVO&quot;</div><div class="line">		resultType=&quot;user&quot;&gt;</div><div class="line">		SELECT * FROM user</div><div class="line">		&lt;!-- where标签：默认去掉后面第一个AND，如果没有参数，则把自己干掉 --&gt;</div><div class="line">		&lt;where&gt;</div><div class="line">			&lt;!-- 引入sql片段 --&gt;</div><div class="line">			&lt;include refid=&quot;whereClause&quot; /&gt;</div><div class="line">		&lt;/where&gt;</div><div class="line">	&lt;/select&gt;</div><div class="line"></div><div class="line">	&lt;!-- 综合查询用户总数 --&gt;</div><div class="line">	&lt;select id=&quot;findUserCount&quot; parameterType=&quot;com.yao.mybatis.po.UserQueryVO&quot;</div><div class="line">		resultType=&quot;int&quot;&gt;</div><div class="line">		SELECT count(*) FROM user</div><div class="line">		&lt;!-- where标签：默认去掉后面第一个AND，如果没有参数，则把自己干掉 --&gt;</div><div class="line">		&lt;where&gt;</div><div class="line">			&lt;!-- 引入sql片段 --&gt;</div><div class="line">			&lt;include refid=&quot;whereClause&quot; /&gt;</div><div class="line">		&lt;/where&gt;</div><div class="line">	&lt;/select&gt;</div></pre></td></tr></table></figure></p>
<p><strong><em><code>&lt;for:each&gt;</code>标签</em></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;if test=&quot;idList != null&quot;&gt;</div><div class="line">			&lt;!-- AND id IN (#&#123;id&#125;,#&#123;id&#125;,#&#123;id&#125;) --&gt;</div><div class="line"></div><div class="line">			&lt;!-- collection：表示pojo中集合属性的属性名称 --&gt;</div><div class="line">			&lt;!-- item:为遍历出的结果声明一个变量名称 --&gt;</div><div class="line">			&lt;!-- open：遍历开始时，需要拼接的字符串 --&gt;</div><div class="line">			&lt;!-- close:遍历结束时，需要拼接的字符串 --&gt;</div><div class="line">			&lt;!-- separator：遍历中间需要拼接的连接符 --&gt;</div><div class="line">			AND id IN</div><div class="line">			&lt;foreach collection=&quot;idList&quot; item=&quot;id&quot; open=&quot;(&quot; close=&quot;)&quot;</div><div class="line">				separator=&quot;,&quot;&gt;</div><div class="line">				#&#123;id&#125;</div><div class="line">			&lt;/foreach&gt;</div><div class="line">		&lt;/if&gt;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/14/Mybatis学习/" data-id="cj31o95030008pwtx066rd0qf" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Webservice" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/10/Webservice/" class="article-date">
  <time datetime="2017-05-10T13:58:39.199Z" itemprop="datePublished">2017-05-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/10/Webservice/">Webservice</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： Webservice</p>
<hr>
<p><strong>Webservice是什么?</strong><br>Webservice是一种使用<strong>Http发送SOAP协议</strong>的数据的一种远程调用技术，其作用就是从远程系统中获取业务数据。是系统和系统之间的调用。</p>
<p><strong>Webservice的三要素：</strong></p>
<ul>
<li>WSDL  : web服务描述语言，是webservice服务端的一个使用说明书，描述接口、方法、参数和返回值。</li>
<li>SOAP  : 简单对象访问协议</li>
<li>UDDI  : 目录服务，提供webservice服务端的注册和搜索功能</li>
</ul>
<p><strong>Webservice的四种客户端调用方式：</strong></p>
<ul>
<li>生成客户端调用方式</li>
<li>客户端变成调用方式</li>
<li>HttpUrlConnection调用方式</li>
<li>Ajax调用方式</li>
</ul>
<p>Webservice要开发服务端和客户端</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/10/Webservice/" data-id="cj31o950y000jpwtxodhomw3p" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-jQuery学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/08/jQuery学习/" class="article-date">
  <time datetime="2017-05-08T08:45:34.020Z" itemprop="datePublished">2017-05-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/08/jQuery学习/">jQuery学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： jQuery</p>
<hr>
<p>[属性名]       获得指定属性名的元素<br>[属性名=值]    获得属性名 等于 指定值的元素<br>[属性名！=值]  获得属性名 不等于 指定值 的元素</p>
<p>[as1][as2][as3]… 复合选择器，多个条件同时成立。类似 where …and…and</p>
<p>[属性名^=值]   获得以属性值  开头  的元素<br>[属性名$=值]   获得以属性值  结尾  的元素<br>[属性名*=值]   获得   含有属性值   的元素<br>[属性名]  获得指定属性名的元素</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>)</span>&#123;</div><div class="line">        $(<span class="string">"#btn1"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $(<span class="string">"div[title]"</span>).css(<span class="string">"background-color"</span>,<span class="string">"#000"</span>);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line"></div><div class="line">        $(<span class="string">"#btn1"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $(<span class="string">"div[title='test']"</span>).css(<span class="string">"background-color"</span>,<span class="string">"#000"</span>);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line"></div><div class="line">        $(<span class="string">"#btn1"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $(<span class="string">"div[title!='test']"</span>).css(<span class="string">"background-color"</span>,<span class="string">"#000"</span>);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="文档处理"><a href="#文档处理" class="headerlink" title="文档处理"></a>文档处理</h2><h3 id="一-内部插入"><a href="#一-内部插入" class="headerlink" title="一 内部插入"></a>一 内部插入</h3><p>append(content | fn)<br>appendTo(content)<br>prepend(content | fn)<br>prependTo(content) </p>
<p>A.append(B)  将B插入到A的内部后面（之后的串联操作，操作A）<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div><div class="line">	....</div><div class="line">	<span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>A.prepend(B) 将B插入到A的内部前面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line">	....</div><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>A.appendTo(B) 将A插入到B的内部后面 （之后的串联操作，操作A）<br>A.prependTo(B) 将A插入到B的内部前面</p>
<h3 id="二-外部插入"><a href="#二-外部插入" class="headerlink" title="二 外部插入"></a>二 外部插入</h3><p>after(content | fn)<br>before(content | fn)<br>insertAfter(content)<br>insertBefore(content) </p>
<p>A.after(B)  , 将B插入到A后面（同级）<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>A.before(B) ，将B插入到A前面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure></p>
<hr>
<p>A.insertAfter(B) , 将A插入到B后面（同级）<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>A.insertBefore(B) 将A插入到B前面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="三-删除"><a href="#三-删除" class="headerlink" title="三 删除"></a>三 删除</h3><p>empty()<br>remove([expr])<br>detach([expr]) </p>
<p>empty()  清空标签体<br>remove() 删除当前对象。如果之后再使用，元素本身保留，绑定事件 或 绑定数据 都会被移除<br>detach() 删除当前对象。如果之后再使用，元素本身保留，绑定事件 或 绑定数据 都保留</p>
<ul>
<li>绑定数据<br>  data(name) 获得<br>  data(name,value) 设置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">// 将city移除，再追加body后面</div><div class="line">	</div><div class="line">	//#1 绑定事件</div><div class="line">	$(&quot;#city&quot;).click(function()&#123;</div><div class="line">		alert(&quot;哈哈&quot;);</div><div class="line">	&#125;);</div><div class="line">	//#2 绑定数据</div><div class="line">	$(&quot;#city&quot;).data(&quot;yao&quot;,&quot;bang&quot;);</div><div class="line">	</div><div class="line">	</div><div class="line">	//1 移除</div><div class="line">	var $city = $(&quot;#city&quot;).remove(); //移除绑定的事件、移除绑定的数据</div><div class="line">//	var $city = $(&quot;#city&quot;).detach(); //保留绑定的事件、保留绑定的数据</div><div class="line">	</div><div class="line">	</div><div class="line">	//2 追加</div><div class="line">	$(&quot;body&quot;).append($city);</div><div class="line">	</div><div class="line">	</div><div class="line">	//#3获得绑定的数据</div><div class="line">	alert($(&quot;#city&quot;).data(&quot;yao&quot;));</div></pre></td></tr></table></figure>
<h2 id="筛选"><a href="#筛选" class="headerlink" title="筛选"></a>筛选</h2><h3 id="一-过滤"><a href="#一-过滤" class="headerlink" title="一 过滤"></a>一 过滤</h3><p>eq(index)<br>first()<br>last()<br>hasClass(class)<br>filter(expr | fn)<br>is(expr)<br>map(callback)<br>has(expr)<br>not(expr)<br>slice(start, [end]) </p>
<p>eq(index | -index)  类型 :eq()<br>····    index：正数，从头开始获得指定索引的元素。这个元素的位置是从0算起。0表示第一个<br>····     -index：负数，从尾开始获得指定索引的元素。1算起。 -1表示最后一个</p>
<p>first()    第一个  :first</p>
<p>last()    最后一个  :last</p>
<p>is()        判断</p>
<p>hasClass()    判断是否是指定class 。<xxx class="my"><br>    这其实就是 is(“.” + class)。</xxx></p>
<p>filter()  筛选出与指定表达式匹配的元素集合</p>
<p>not()    将指定内容删除</p>
<p>has()   子元素是否有</p>
<p>slice(start , end)  截取元素 ，[2,4)  –&gt; 2,3</p>
<p>map()  jQuery对象 拆分成  jQuery对象数组</p>
<h3 id="二-查找"><a href="#二-查找" class="headerlink" title="二 查找"></a>二 查找</h3><p>children([expr])<br>closest([expr])<br>find(expr)<br>next([expr])<br>nextAll([expr])<br>nextUntil([expr])<br>offsetParent()<br>parent([expr])<br>parents([expr])<br>parentsUntil([expr])<br>prev([expr])<br>prevAll([expr])<br>prevUntil([expr])<br>siblings([expr]) </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">B</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">C</span>&gt;</span><span class="tag">&lt;/<span class="name">C</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">D</span>&gt;</span><span class="tag">&lt;/<span class="name">D</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">E</span>&gt;</span><span class="tag">&lt;/<span class="name">E</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">F</span>&gt;</span><span class="tag">&lt;/<span class="name">F</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure>
<p>B.children([…])   获得所有的子元素。CDEF<br>A.find(D)  从指定的区域查询指定元素。D<br>D.next()    下一个兄弟。E<br>D.nextAll() 后面的所有兄弟。EF<br>E.prev()    上一个兄弟。D  （previous）<br>E.prevAll()  前面的所有兄弟。CD<br>E.siblings()    所有兄弟。CDF<br>E.parent()  父元素。B<br>E.closest(A)  向上获得指定的父元素（含自己），如果获得返回一个对象，如果没有没有对象。<br>//——————————</p>
<p>C.nextUntil(E)  获得后面所有兄弟，直到指定条件位置。DE<br>F.prevUntil(D)  获得前面所有兄弟，直到指定条件位置。DE</p>
<p>E.parents()   获得所有的父元素。AB</p>
<ul>
<li>closest和parents的主要区别是：<br>1，前者从当前元素开始匹配寻找，后者从父元素开始匹配寻找；<br>2，前者逐级向上查找，直到发现匹配的元素后就停止了，后者一直向上查找直到根元素，然后把这些元素放进一个临时集合中，再用给定的选择器表达式去过滤；<br>3，前者返回0或1个元素，后者可能包含0个，1个，或者多个元素。</li>
</ul>
<h3 id="三-串联"><a href="#三-串联" class="headerlink" title="三 串联"></a>三 串联</h3><p>A.add(B)  将A和B组合一个对象 。类型 $(“A,B”)<br>andSelf() ： 将之前对象添加到操作集合中<br>    A.children().andSelf()<br>       A    孩子    孩子和A<br>end() ：回到最近的一个”破坏性”操作之前<br>    A.children().children().end() .end()<br>    A   孩子   孙子        孩子  A<br>//———————————–<br>contents()  获得所有的子节点（子元素 和 文本）</p>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="comment">//1所有分组列表项默认都是隐藏的。</span></div><div class="line">		<span class="comment">//2 分组（span）可以点击，控制下面的列表项显示或隐藏</span></div><div class="line">		<span class="comment">//3 当前分组列表项显示，其他分页隐藏（同时只有一个显示）</span></div><div class="line">		</div><div class="line">		$(<span class="string">"div"</span>).children(<span class="string">"a"</span>).hide().prev(<span class="string">"span"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			$(<span class="keyword">this</span>).nextAll(<span class="string">"a"</span>).toggle().parent().siblings(<span class="string">"div"</span>).find(<span class="string">"a"</span>).hide();</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">	&#125;);</div></pre></td></tr></table></figure>
<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><h3 id="一-事件"><a href="#一-事件" class="headerlink" title="一 . 事件"></a>一 . 事件</h3><p>blur( [fn] )      失去焦点<br>change( [fn] )    改变<br>click( [fn] )     单击<br>dblclick( [fn] )  双击<br>error( [fn] )     页面异常<br>focus( [fn] )     获得焦点<br>focusin( [fn] )<br>focusout( [fn] )<br>keydown( [fn] )<br>keypress( [fn] )<br>keyup( [fn] )<br>mousedown(fn)<br>mousemove(fn)<br>mouseout(fn)      鼠标移出<br>mouseover(fn)     鼠标移入<br>mouseup(fn)       鼠标弹起<br>resize(fn)        改变大小<br>scroll(fn)        滚动<br>select( [fn] )    选择<br>submit( [fn] )<br>unload(fn)        页面卸载</p>
<ul>
<li>jQuery 提供额外的事件，用于完善javascript缺失的</li>
<li><p>focusin 和 focusout<br>  focusin 获得焦点。js focus。</p>
<pre><code>focusin事件跟focus事件区别在于，他可以在父元素上检测子元素获取焦点的情况。
</code></pre><p>  focusout 失去焦点。js blur。</p>
<pre><code>focusout事件跟blur事件区别在于，他可以在父元素上检测子元素失去焦点的情况。
</code></pre></li>
<li><p>mouseenter 和 mouseleave<br>  mouseenter 鼠标移入。js mouseover</p>
<pre><code>与 mouseover 事件不同，只有在鼠标指针穿过被选元素时，才会触发 mouseenter 事件。如果鼠标指针穿过任何子元素，同样会触发 mouseover 事件。
</code></pre><p>  mouseleave 鼠标移出。js mouseout</p>
<pre><code>与 mouseout 事件不同，只有在鼠标指针离开被选元素时，才会触发 mouseleave 事件。如果鼠标指针离开任何子元素，同样会触发 mouseout 事件。
</code></pre></li>
</ul>
<h3 id="二-页面加载"><a href="#二-页面加载" class="headerlink" title="二 . 页面加载"></a>二 . 页面加载</h3><p><strong><em>ready(in)</em></strong></p>
<ul>
<li><p>方式一：标准api<br>$(document).ready(function(){<br>});<br>等效于<br>jQuery(document).ready(fn);</p>
</li>
<li><p>方式二：简化版<br>$(function(){<br>});<br>等效于<br>jQuery(function{<br>});</p>
</li>
</ul>
<p><strong>分析源码后总结</strong>：<br>$(document).ready(function(){<br>});</p>
<p><strong><em>等效于</em></strong></p>
<p>$(function(){<br>});</p>
<h3 id="三-处理"><a href="#三-处理" class="headerlink" title="三 . 处理"></a><strong><em>三 . 处理</em></strong></h3><p>bind(type, [data], fn)   给当前对象绑定一个事件。例如：A.bind(“click”, fn );  类型：A.click( fn );<br>unbind(type )            解绑bind绑定事件</p>
<p>one(type, [data], fn)    给当前对象绑定一次事件。<br>//——————————————————————————<br>trigger(type, [data])<br>triggerHandler(type, [data])<br>unbind([type], [data])</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">	&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"../js/jquery-1.8.3.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line">	&lt;script type=<span class="string">"text/javascript"</span>&gt;</div><div class="line">		$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//	&lt;input id="h01" type="button" value="1 只能点击一次，之后失效" /&gt; </span></div><div class="line">			$(<span class="string">"#h01"</span>).one(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				alert(<span class="string">"看到一次"</span>);</div><div class="line">			&#125;);</div><div class="line"><span class="comment">//	&lt;input id="h02" type="button" value="2可以点击多次" /&gt;</span></div><div class="line">			<span class="comment">//jQuery 事件别名，格式：事件.别名</span></div><div class="line">			$(<span class="string">"#h02"</span>).bind(<span class="string">"click.a"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				alert(<span class="string">"111"</span>);</div><div class="line">			&#125;);</div><div class="line">			$(<span class="string">"#h02"</span>).bind(<span class="string">"click.b"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				alert(<span class="string">"222"</span>);</div><div class="line">			&#125;);</div><div class="line"><span class="comment">//	&lt;input id="h03" type="button" value="3解绑2" /&gt; </span></div><div class="line">			$(<span class="string">"#h03"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				$(<span class="string">"#h02"</span>).unbind(<span class="string">"click.b"</span>);</div><div class="line">			&#125;);</div><div class="line"><span class="comment">//	&lt;input type="button" value="4 添加一个按钮，样式为myClass，且拥有相同的事件" class="myClass" /&gt;</span></div><div class="line">			$(<span class="string">".myClass"</span>).live(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				$(<span class="string">"body"</span>).append(<span class="string">"&lt;input type='button' class='myClass' /&gt;"</span>);</div><div class="line">			&#125;);</div><div class="line"><span class="comment">//	&lt;input id="h05" type="button" value="5 解绑4"/&gt; </span></div><div class="line">			$(<span class="string">"#h05"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				$(<span class="string">".myClass"</span>).die(<span class="string">"click"</span>);</div><div class="line">			&#125;);</div><div class="line">		&#125;);</div><div class="line">	<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>3.3.2    委派<br>live(type , fn) 绑定事件，之后动态添加同样的成员，也具有相同的事件。<br>die(type) 解绑事件</p>
<p>3.3.3    切换</p>
<p>hover(over , out)<br>简化版，鼠标移入和移出  ，A.mouseover( fn ).mouseout( fn)  简化 A.hover( fn , fn )</p>
<p>toggle( fn , fn , fn ,…) 执行click事件，每点击一次执行一个fn</p>
<p><strong>鼠标移动链接提示案例</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>文字提示<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"> <span class="comment">&lt;!--   引入jQuery --&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"../js/jquery-1.8.3.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></div><div class="line">body&#123;</div><div class="line">	margin:0;</div><div class="line">	padding:40px;</div><div class="line">	background:#fff;</div><div class="line">	font:80% Arial, Helvetica, sans-serif;</div><div class="line">	color:#555;</div><div class="line">	line-height:180%;</div><div class="line">&#125;</div><div class="line">p&#123;</div><div class="line">	clear:both;</div><div class="line">	margin:0;</div><div class="line">	padding:.5em 0;</div><div class="line">&#125;</div><div class="line">/* tooltip */</div><div class="line">#tooltip&#123;</div><div class="line">	position:absolute;</div><div class="line">	border:1px solid #333;</div><div class="line">	background:#f7f5d1;</div><div class="line">	padding:1px;</div><div class="line">	color:#333;</div><div class="line">	width:300px;</div><div class="line">	display:none;</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">	$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="comment">//将自带的提示，替换成 自定义提示</span></div><div class="line">		</div><div class="line">		$(<span class="string">".mytooltip"</span>).mouseover(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">			</div><div class="line">			<span class="comment">//1 获得绑定的数据</span></div><div class="line">			<span class="keyword">var</span> title = $(<span class="keyword">this</span>).data(<span class="string">"mytitle"</span>); <span class="comment">//undefined转换成boolean类型，默认转换成false;</span></div><div class="line">			<span class="keyword">if</span>(! title)&#123;  <span class="comment">//没有</span></div><div class="line">				<span class="comment">//获得自带提示</span></div><div class="line">				title = $(<span class="keyword">this</span>).attr(<span class="string">"title"</span>);</div><div class="line">				<span class="comment">//将自带提示删除</span></div><div class="line">				$(<span class="keyword">this</span>).removeAttr(<span class="string">"title"</span>);</div><div class="line">				<span class="comment">//绑定数据</span></div><div class="line">				$(<span class="keyword">this</span>).data(<span class="string">"mytitle"</span>,title)</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			<span class="comment">//2 创建div</span></div><div class="line">			<span class="keyword">var</span> $<span class="keyword">new</span> = $(<span class="string">"&lt;div id='tooltip'&gt;&lt;/div&gt;"</span>);</div><div class="line">			<span class="comment">//3设置提示</span></div><div class="line">			$<span class="keyword">new</span>.html(title);</div><div class="line">			</div><div class="line">			<span class="comment">//4定位</span></div><div class="line">			$<span class="keyword">new</span>.offset(&#123;<span class="string">"left"</span>:event.pageX + <span class="number">5</span>,<span class="string">"top"</span>:event.pageY - <span class="number">20</span>&#125;);</div><div class="line">			</div><div class="line">			<span class="comment">//5追加到body，并显示</span></div><div class="line">			$<span class="keyword">new</span>.appendTo(<span class="string">"body"</span>).show();</div><div class="line">		&#125;).mouseout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="comment">//删除</span></div><div class="line">			$(<span class="string">"#tooltip"</span>).remove();</div><div class="line">		&#125;).mousemove(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">			<span class="comment">// 重写定位</span></div><div class="line">			$(<span class="string">"#tooltip"</span>).offset(&#123;<span class="string">"left"</span>:event.pageX + <span class="number">5</span>,<span class="string">"top"</span>:event.pageY - <span class="number">20</span>&#125;);</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">	&#125;);</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"mytooltip"</span> <span class="attr">title</span>=<span class="string">"超链接提示1."</span>&gt;</span>提示1.<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"mytooltip"</span> <span class="attr">title</span>=<span class="string">"超链接提示2."</span>&gt;</span>提示2.<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"></div><div class="line">	</div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><p>ajax ： 异步请求，浏览器地址栏不改变，进行局部刷新。</p>
<ul>
<li>jQuery需要完成的事情：<br>请求路径<br>请求参数<br>编写回调，获取json数据</li>
</ul>
<h3 id="一-ajax-请求"><a href="#一-ajax-请求" class="headerlink" title="一 . ajax 请求"></a>一 . ajax 请求</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$.post(url,[data],[fn],[type]) </div><div class="line">$.get(url,[data],[fn],[type]) </div><div class="line">load(url,[data],[callback]) </div><div class="line">$.ajax(url,[settings]) </div><div class="line">$.getJSON(url,[data],[fn]) </div><div class="line">$.getScript(url,[callback])</div></pre></td></tr></table></figure>
<h4 id="post"><a href="#post" class="headerlink" title="$.post()"></a><strong><em>$.post()</em></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 3 $.post() 全局函数，发送post请求</span></div><div class="line">				 * * 格式：jQuery.post(url, [data], [callback], [type])</div><div class="line">				$.post(url,params,function(data)&#123;</div><div class="line">					alert(data);</div><div class="line">				&#125;,"json")</div><div class="line">				 */</div></pre></td></tr></table></figure>
<h4 id="get"><a href="#get" class="headerlink" title="$.get()"></a><strong><em>$.get()</em></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 2 $.get() 全局函数，发送get请求</span></div><div class="line">				 * * 格式：jQuery.get(url, [data], [callback], [type])</div><div class="line">				 * 		* 参数4：type ，返回内容格式，xml, html, script, json, text, _default。</div><div class="line">				 * * GET请求不适合发送中文数据，存放请求的中文乱码。</div><div class="line">				 * 		必须手动解码   new String(username.getBytes("ISO-8859-1") ,"UTF-8")</div><div class="line">				 * * 响应数据，如果使用  application/json;charset=UTF-8 ，jQuery自动将数据转换json对象。</div><div class="line">				 * * 响应数据，如果使用  text/html;charset=UTF-8 ，回调函数获得字符串数据，需要手动转换。</div><div class="line">				 * 		使用“参数4”，设置"json"，jQuery将字符串 转换成 json对象</div><div class="line">				 */</div><div class="line">				$.get(url,params,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">					alert(data);</div></pre></td></tr></table></figure>
<h4 id="load"><a href="#load" class="headerlink" title="load()"></a><strong><em>load()</em></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//0.2 请求参数，采用json</span></div><div class="line">				<span class="keyword">var</span> params = &#123;<span class="string">"username"</span>:<span class="string">"杰克"</span>, <span class="string">"password"</span>:<span class="string">"1234"</span>&#125;;</div><div class="line">				</div><div class="line">				<span class="comment">/* 1 load()函数 ，必须使用jquery对象</span></div><div class="line">				 * * 格式：load(url, [data], [callback])</div><div class="line">				 * 		参数1：url ，请求路径</div><div class="line">				 * 		参数2：data，请求参数</div><div class="line">				 * 		参数3：callback，回调函数</div><div class="line">				 * * 如果没有请求参数，发送的GET请求</div><div class="line">				 * * 如果有请求参数，发送的POST请求。请求没有中文乱码</div><div class="line">				 * * 回调函数的参数</div><div class="line">				 * 		参数1：data，响应数据。load()永远获得字符串，如果需要使用，必须手动转换json对象。</div><div class="line">				 */</div><div class="line">				$(<span class="keyword">this</span>).load(url,params,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">					<span class="comment">//转换json对象</span></div><div class="line">					<span class="keyword">var</span> jsonData = <span class="built_in">eval</span>(<span class="string">"("</span>+data+<span class="string">")"</span>);</div><div class="line">					alert(jsonData.message);</div><div class="line">				&#125;);</div></pre></td></tr></table></figure>
<h4 id="ajax"><a href="#ajax" class="headerlink" title="$.ajax()"></a><strong><em>$.ajax()</em></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 4 $.ajax() 底层功能最强大的</span></div><div class="line">				 * * 格式：jQuery.ajax([settings])</div><div class="line">				 * 		参数settings：设置所有的参数</div><div class="line">				 * 			url:发送请求的地址</div><div class="line">				 * 			data:发送到服务器的数据,请求参数</div><div class="line">				 * 			type:请求方式 ("POST" 或 "GET")， </div><div class="line">				 * 			success:成功的回调函数，success(data, textStatus, jqXHR)</div><div class="line">				 * 			error:请求失败时调用此函数</div><div class="line">				 * 			dataType:预期服务器返回的数据类型</div><div class="line">				 * 				"xml": 返回 XML 文档，可用 jQuery 处理。</div><div class="line">				 * 				"html": 返回纯文本 HTML 信息；包含的script标签会在插入dom时执行。</div><div class="line">				 * 				"script": 返回纯文本 JavaScript 代码。不会自动缓存结果。除非设置了"cache"参数。'''注意：'''在远程请求时(不在同一个域下)，所有POST请求都将转为GET请求。(因为将使用DOM的script标签来加载)</div><div class="line">				 * 				"json": 返回 JSON 数据 。</div><div class="line">				 * 				"jsonp": JSONP 格式。使用 JSONP 形式调用函数时，如 "myurl?callback=?" jQuery 将自动替换 ? 为正确的函数名，以执行回调函数。</div><div class="line">				 * 				"text": 返回纯文本字符串</div><div class="line">				 */</div><div class="line">				</div><div class="line">				$.ajax(&#123;</div><div class="line">					<span class="string">"url"</span>:url,</div><div class="line">					<span class="string">"data"</span>:params,</div><div class="line">					<span class="string">"type"</span>:<span class="string">"POST"</span>,</div><div class="line">					<span class="string">"success"</span>:<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">						alert(data);</div><div class="line">					&#125;,</div><div class="line">					<span class="string">"error"</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">						alert(<span class="string">"服务器繁忙，请稍后重试"</span>);</div><div class="line">					&#125;,</div><div class="line">					<span class="string">"dataType"</span>:<span class="string">"json"</span></div><div class="line">				&#125;);</div></pre></td></tr></table></figure>
<h3 id="二-其他"><a href="#二-其他" class="headerlink" title="二 . 其他"></a>二 . 其他</h3><h4 id="2-1-表单序列化"><a href="#2-1-表单序列化" class="headerlink" title="2.1 表单序列化"></a>2.1 表单序列化</h4><p>serialize()  ： 将表单中的数据序列为字符串<br>serializearray()  ： 将表单中的数据序列为json对象</p>
<h4 id="2-2-时间冒泡"><a href="#2-2-时间冒泡" class="headerlink" title="2.2 时间冒泡"></a>2.2 时间冒泡</h4><p>子元素事件  执行时，会一并触发父元素相同的事件<br>event.stopPropagation()</p>
<h4 id="2-3-浏览器默认动作"><a href="#2-3-浏览器默认动作" class="headerlink" title="2.3 浏览器默认动作"></a>2.3 浏览器默认动作</h4><p>href是a标签的默认行为，要阻止该行为，有两种方法：</p>
<ol>
<li>return false;</li>
<li>event.preventDefault(); </li>
</ol>
<h3 id="三-动态加载"><a href="#三-动态加载" class="headerlink" title="三 . 动态加载"></a>三 . 动态加载</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../js/jquery-1.8.3.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">		$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="comment">//1 创建10div</span></div><div class="line">			<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; <span class="number">10</span> ; i ++)&#123;</div><div class="line">				createDiv();</div><div class="line">			&#125;</div><div class="line">			<span class="comment">//2 浏览器添加滚动事件</span></div><div class="line">			$(<span class="built_in">window</span>).scroll(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="comment">//2.1 滚过高度</span></div><div class="line">				<span class="keyword">var</span> wt = $(<span class="keyword">this</span>).scrollTop();</div><div class="line">				<span class="comment">//2.2 整个文档高度</span></div><div class="line">				<span class="keyword">var</span> dh = $(<span class="built_in">document</span>).height();</div><div class="line">				<span class="comment">//2.3 窗口的高度</span></div><div class="line">				<span class="keyword">var</span> wh = $(<span class="keyword">this</span>).height();</div><div class="line">				</div><div class="line">				<span class="comment">//3 当接近底部时，添加</span></div><div class="line">				<span class="keyword">if</span>(wt + wh + <span class="number">100</span> &gt; dh)&#123;</div><div class="line">					createDiv();</div><div class="line">					</div><div class="line">					<span class="comment">//发送ajax填充数据</span></div><div class="line">				&#125;</div><div class="line">				</div><div class="line">				<span class="comment">//提示</span></div><div class="line">				$(<span class="string">"#showDiv"</span>).html(<span class="string">"wt: "</span> + wt + <span class="string">" , dh: "</span> + dh + <span class="string">" , wh:"</span> + wh);</div><div class="line">			&#125;);</div><div class="line">			</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		<span class="keyword">var</span> num = <span class="number">1</span>;</div><div class="line">		<span class="comment">//创建div</span></div><div class="line">		<span class="function"><span class="keyword">function</span> <span class="title">createDiv</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> $div = $(<span class="string">"&lt;div class='newDiv' /&gt;"</span>);</div><div class="line">			$div.html(num ++ );</div><div class="line">			</div><div class="line">			$(<span class="string">"body"</span>).append($div);</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	<span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></div><div class="line">		.newDiv&#123;</div><div class="line">		  border: 1px solid #999;</div><div class="line">		  width: 400px;</div><div class="line">		  height: 100px;</div><div class="line">		  margin: 5px;</div><div class="line">		  font-size: 50px;</div><div class="line">		&#125;</div><div class="line">		#showDiv&#123;</div><div class="line">		   border: 1px solid #999;</div><div class="line">		  width: 500px;</div><div class="line">		  height: 30px;</div><div class="line">		  position: fixed;</div><div class="line">		  bottom: 0;</div><div class="line">		  right: 100px;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	<span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"showDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()&#123;</div><div class="line">			//1 创建10div </div><div class="line">			for(var i = 0 ; i &lt; 5 ; i ++)&#123;</div><div class="line">				createDiv();</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			</div><div class="line">			//定时器</div><div class="line">			setInterval(showDiv,100);</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		function showDiv()&#123;</div><div class="line">			//第一个隐藏</div><div class="line">			$(&quot;div:first&quot;).slideUp(100,function()&#123;</div><div class="line">				$(this).appendTo(&quot;body&quot;).slideDown(100);</div><div class="line">			&#125;);</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		var num = 1;</div><div class="line">		//创建div</div><div class="line">		function createDiv()&#123;</div><div class="line">			var $div = $(&quot;&lt;div class=&apos;newDiv&apos; /&gt;&quot;);</div><div class="line">			$div.html(num ++ );</div><div class="line">			</div><div class="line">			$(&quot;body&quot;).append($div);</div><div class="line">		&#125;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/08/jQuery学习/" data-id="cj31o950g000fpwtxh1lqum8m" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/04/JavaScript学习/" class="article-date">
  <time datetime="2017-05-04T13:39:10.351Z" itemprop="datePublished">2017-05-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/04/JavaScript学习/">JavaScript学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： JavaScript</p>
<hr>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h3><p>###字符串<br>toUpperCase()把一个字符串全部变为大写;<br>toLowerCase()把一个字符串全部变为小写;<br>indexOf()会搜索指定字符串出现的位置;<br>substring()返回指定索引区间的子串;</p>
<h3 id="布尔型"><a href="#布尔型" class="headerlink" title="布尔型"></a>布尔型</h3><h2 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h2><p>需要注意的是:=== 它不会自动转换数据类型，如果数据类型不一致，返回false，如果一致，再比较。</p>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p>JavaScript的数组可以包括任意数据类型。<br>在数组中直接给数组的长度赋值会导致数组的长度发生变化。</p>
<ul>
<li><p>创建数组：<br><code>var arr=[1,2,3];</code><br><code>new Array[1,2,3];</code></p>
</li>
<li><p>Array也可以通过indexOf()来搜索一个指定的元素的位置</p>
</li>
<li><p><strong>slice()</strong>就是对应String的substring()版本，它截取Array的部分元素，然后返回一个新的Array</p>
</li>
<li><p><strong>push()</strong>向Array的末尾添加若干元素，<strong>pop()</strong>则把Array的最后一个元素删除掉</p>
</li>
<li><p>如果要往Array的头部添加若干元素，使用<strong>unshift()</strong>方法，<strong>shift()</strong>方法则把Array的第一个元素删掉</p>
</li>
<li><p><strong>sort()</strong>可以对当前Array进行排序，它会直接修改当前Array的元素位置，直接调用时，按照默认顺序排序</p>
</li>
<li><p><strong>reverse()</strong>把整个Array的元素反转</p>
</li>
<li><p><strong>splice()</strong>方法是修改Array的“万能方法”，它可以从指定的索引开始删除若干元素，然后再从该位置添加若干元素</p>
</li>
<li><p><strong>concat()</strong>方法把当前的Array和另一个Array连接起来，并返回一个新的Array</p>
</li>
<li><p><strong><em>join()</em></strong>方法把当前Array的每个元素都用指定的字符串连接起来，然后返回连接后的字符串</p>
</li>
</ul>
<h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2><p>JavaScrpitpt的对象是一组由键-值组成的<strong>无序</strong>集合。<br>JavaScript对象的键都是字符串类型，值可以是任意数据类型。<br>要获取一个对象的属性，我们用<strong>对象变量.属性名</strong>的方式。</p>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>可以把任意数据类型赋值给变量，同一个变量可以反复赋值，而且可以是不同类型的变量，但是要注意只能用var申明一次。<br>如果一个变量没有通过var申明就被使用的话，那么这个变量就会自动被申明为全局变量。使用var申明的变量则不是全局变量，它的范围被限制在该变量被申明的函数体内，同名变量在不同函数体内互不冲突。</p>
<h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><p>普通的循环不做赘述，for循环的一个变体是for…in循环，它可以把一个对象的所有属性依次循环出来</p>
<h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><p><code>var m = new Map([[&#39;sam&#39;, 110], [&#39;Bob&#39;, 120], [&#39;T-mac&#39;, 119]])</code></p>
<p>由于一个key只能对应一个value，所以，多次对一个key放入value，后面的值会把前面的值冲掉:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">m.set(<span class="string">'Adam'</span>, <span class="number">67</span>);</div><div class="line">m.set(<span class="string">'Adam'</span>, <span class="number">88</span>);</div><div class="line">m.get(<span class="string">'Adam'</span>); <span class="comment">// 88</span></div></pre></td></tr></table></figure></p>
<h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><p><code>var s1 = new Set([1, 2, 3]); // 含1, 2, 3</code></p>
<h2 id="iterable"><a href="#iterable" class="headerlink" title="iterable"></a>iterable</h2><p>注意：Array、Map和Set都属于iterable类型；<br>具有iterable类型的集合可以通过新的<strong><em>for … of</em></strong>循环来遍历。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>];</div><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>]);</div><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="number">1</span>, <span class="string">'x'</span>], [<span class="number">2</span>, <span class="string">'y'</span>], [<span class="number">3</span>, <span class="string">'z'</span>]]);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> a) &#123; <span class="comment">// 遍历Array</span></div><div class="line">    alert(x);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> s) &#123; <span class="comment">// 遍历Set</span></div><div class="line">    alert(x);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> m) &#123; <span class="comment">// 遍历Map</span></div><div class="line">    alert(x[<span class="number">0</span>] + <span class="string">'='</span> + x[<span class="number">1</span>]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h3><p>函数的定义方法有两种：<br><code>function abs(x)</code><br><code>var abc = fucntion abs(x) //注意这种定义方法的末尾需要加上;</code><br>第二种方式可以通过变量abc来调用函数,且abc是一个<strong><em>全局变量</em></strong></p>
<h3 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h3><p>由于JavaScript允许传入任意个参数而不影响调用，因此传入的参数比定义的参数多也没有问题，虽然函数内部并不需要这些参数。例如：<br><code>abc(10,‘what are you doing’)</code>;</p>
<h3 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h3><p>JavaScript还有一个的关键字arguments，它只在函数内部起作用，并且永远指向当前函数的调用者传入的所有参数.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    alert(x); <span class="comment">// 10</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="built_in">arguments</span>.length; i++) &#123;</div><div class="line">        alert(<span class="built_in">arguments</span>[i]); <span class="comment">// 10, 20, 30</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">func(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</div></pre></td></tr></table></figure></p>
<h3 id="rest"><a href="#rest" class="headerlink" title="rest"></a>rest</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a, b, ...rest</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'a = '</span> + a);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'b = '</span> + b);</div><div class="line">    <span class="built_in">console</span>.log(rest);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line"><span class="comment">// 结果:</span></div><div class="line"><span class="comment">// a = 1</span></div><div class="line"><span class="comment">// b = 2</span></div><div class="line"><span class="comment">// Array [ 3, 4, 5 ]</span></div><div class="line"></div><div class="line">foo(<span class="number">1</span>);</div><div class="line"><span class="comment">// 结果:</span></div><div class="line"><span class="comment">// a = 1</span></div><div class="line"><span class="comment">// b = undefined</span></div><div class="line"><span class="comment">// Array []</span></div></pre></td></tr></table></figure>
<h3 id="全局作用域"><a href="#全局作用域" class="headerlink" title="全局作用域"></a>全局作用域</h3><p>JavaScript默认有一个全局对象window，全局作用域的变量实际上被绑定到window的一个属性<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> course = <span class="string">'Learn JavaScript'</span>;</div><div class="line">alert(course); <span class="comment">// 'Learn JavaScript'</span></div><div class="line">alert(<span class="built_in">window</span>.course); <span class="comment">// 'Learn JavaScript'</span></div></pre></td></tr></table></figure></p>
<h3 id="局部作用域"><a href="#局部作用域" class="headerlink" title="局部作用域"></a>局部作用域</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</div><div class="line">        sum += i;</div><div class="line">    &#125;</div><div class="line">    i += <span class="number">1</span>; <span class="comment">// SyntaxError</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y, f</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> f(x) + f(y);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>由于map()方法定义在JavaScript的Array中，我们调用Array的map()方法，传入我们自己的函数，就得到了一个新的Array作为结果：</p>
<h4 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h4><p>Array中有map()方法，其作用用下面的例子来展示：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">pow</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x * x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</div><div class="line">arr.map(pow); <span class="comment">// [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></div></pre></td></tr></table></figure></p>
<p>map()传入的参数是pow，即函数对象本身。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</div><div class="line">arr.map(<span class="built_in">String</span>); <span class="comment">// ['1', '2', '3', '4', '5', '6', '7', '8', '9']</span></div></pre></td></tr></table></figure>
<h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a>reduce()</h4><p>Array的reduce()把一个函数作用在这个Array的[x1,x2,x3…]上，这个函数必须接收两个参数，reduce()把结果继续和序列的下一个元素做累积计算,即</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[x1, x2, x3, x4].reduce(f)=f(f(f(x1, x2), x3), x4)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>];</div><div class="line">arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x + y;</div><div class="line">&#125;); <span class="comment">// 25</span></div></pre></td></tr></table></figure>
<p>其作用就相当于是做了累加。</p>
<h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>filter也是一个常用的操作，它用于把<strong>Array</strong>的某些元素过滤掉，然后返回剩下的元素。<br>filter()将传入的函数依次作用于每个元素，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">15</span>];</div><div class="line"><span class="keyword">var</span> r = arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x % <span class="number">2</span> !== <span class="number">0</span>;</div><div class="line">&#125;);</div><div class="line"> <span class="comment">// [1, 5, 9, 15]</span></div></pre></td></tr></table></figure>
<h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><h3 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h3><p>generator和函数不同的是，generator由function<em>定义（注意多出的</em>号），并且，除了return语句，还可以用yield返回多次。</p>
<p>举例，要产生斐波那契数列，用原来的方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fib</span>(<span class="params">max</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span></div><div class="line">        t,</div><div class="line">        a = <span class="number">0</span>,</div><div class="line">        b = <span class="number">1</span>,</div><div class="line">        arr = [<span class="number">0</span>, <span class="number">1</span>];</div><div class="line">    <span class="keyword">while</span> (arr.length &lt; max) &#123;</div><div class="line">        t = a + b;</div><div class="line">        a = b;</div><div class="line">        b = t;</div><div class="line">        arr.push(t);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> arr;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>若用generator,则可以换一种方法来完成：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">fib</span>(<span class="params">max</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span></div><div class="line">        t,</div><div class="line">        a = <span class="number">0</span>,</div><div class="line">        b = <span class="number">1</span>,</div><div class="line">        n = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (n &lt; max) &#123;</div><div class="line">        <span class="keyword">yield</span> a;</div><div class="line">        t = a + b;</div><div class="line">        a = b;</div><div class="line">        b = t;</div><div class="line">        n ++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> a;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>可以发现，普通函数返回的是一个Array，而使用generator，就可以一次返回一个数，不断返回多次。<br>直接调用一个generator和调用函数不一样，fib(5)仅仅是创建了一个generator对象，还没有去执行它。要调用generator有两种方法。</p>
<h2 id="标准对象"><a href="#标准对象" class="headerlink" title="标准对象"></a>标准对象</h2><p><strong><em>在JavaScript的世界里，一切都是对象。</em></strong></p>
<ol>
<li><p>若想获取对象的类型，使用<strong>typeof</strong><br>如果我们用typeof将无法区分出null、Array和通常意义上的object——{}</p>
</li>
<li><p>包装对象<br>number —–  Number<br>boolean —-  Boolean<br>string —–  String</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ar n = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">123</span>); <span class="comment">// 123,生成了新的包装类型</span></div><div class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">true</span>); <span class="comment">// true,生成了新的包装类型</span></div><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'str'</span>); <span class="comment">// 'str',生成了新的包装类型</span></div></pre></td></tr></table></figure>
<p>此时这些对象已经变成object<br><strong>注意：</strong>尽量不要使用包装类型</p>
<p><strong><em>有一些规则需要我们遵守</em></strong>：</p>
<ul>
<li><p>不要使用new Number()、new Boolean()、new String()创建包装对象；</p>
</li>
<li><p>用parseInt()或parseFloat()来转换任意类型到number；</p>
</li>
<li><p>用String()来转换任意类型到string，或者直接调用某个对象的toString()方法；</p>
</li>
<li><p>通常不必把任意类型转换为boolean再判断，因为可以直接写if (myVar) {…}；</p>
</li>
<li><p>typeof操作符可以判断出number、boolean、string、function和undefined；</p>
</li>
<li><p>判断Array要使用Array.isArray(arr)；</p>
</li>
<li><p>判断null请使用myVar === null；</p>
</li>
<li><p>判断某个全局变量是否存在用typeof window.myVar === ‘undefined’；</p>
</li>
<li><p>函数内部判断某个变量是否存在用typeof myVar === ‘undefined’。</p>
</li>
<li><p>number对象调用toString(),需要特殊处理：122..toString(); 或 (122).toString();</p>
</li>
</ul>
<h3 id="1-Date"><a href="#1-Date" class="headerlink" title="1. Date"></a>1. Date</h3><ol>
<li>时区<br>Date对象表示的时间总是按浏览器所在时区显示的，不过我们既可以显示本地时间，也可以显示调整后的UTC时间：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var d = new Date(1435146562875);</div><div class="line"></div><div class="line">d.toLocaleString(); // &apos;2015/6/24 下午7:49:22&apos;，本地时间（北京时区+8:00），显示的字符串与操作系统设定的格式有关</div><div class="line"></div><div class="line">d.toUTCString(); // &apos;Wed, 24 Jun 2015 11:49:22 GMT&apos;，UTC时间，与本地时间相差8小时</div></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/04/JavaScript学习/" data-id="cj31o950y000kpwtxpsjkm1eh" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-CRM" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/28/CRM/" class="article-date">
  <time datetime="2017-04-28T15:59:29.968Z" itemprop="datePublished">2017-04-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/28/CRM/">CRM</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： CRM</p>
<hr>
<h2 id="一-数据回显"><a href="#一-数据回显" class="headerlink" title="一  . 数据回显"></a>一  . 数据回显</h2><p>在查询了所有员工信息之后，需要增加编辑员工信息的功能。<br>编辑员工信息需要用到信息的回显，若需要回显员工的信息，需要得到该员工的id来唯一确定员工。<br>listStaff.jsp<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;s:a namespace="/" action="staffAction_editUI"&gt;</div><div class="line">	  		&lt;s:param name="staffId" value="staffId"&gt;&lt;/s:param&gt;</div><div class="line">	  		&lt;img src="$&#123;pageContext.request.contextPath&#125;/images/button/modify.gif" class="img" /&gt;</div><div class="line">&lt;/s:a&gt;</div></pre></td></tr></table></figure></p>
<p>上述为struts2的a标签来发送action，<code>&lt;s:param name=&quot;staffId&quot; value=&quot;staffId&quot;&gt;&lt;/s:param&gt;</code>相当于以get的形式添加到action后，即以类似于<code>action?staffId=</code>的形式完成信息传递。</p>
<p>staffAction.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editUI</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">//jsp中返回了一个get方法，封装到了staff对象中</span></div><div class="line">	CrmStaff findStaff = <span class="keyword">this</span>.staffService.findById(staff.getStaffId());</div><div class="line">	</div><div class="line">	ActionContext.getContext().getValueStack().push(findStaff);</div><div class="line">	</div><div class="line">	<span class="comment">//查询所有部门</span></div><div class="line">	List&lt;CrmDepartment&gt; allDepartment = departmentService.findAllDepartments();</div><div class="line">	<span class="comment">//存在栈顶，在数据回显的时候从栈顶照下来。因为底层使用的是findValue，会从栈顶先开始找，再找contextMap 。即使在栈顶找到了对象的key是null,也会回显</span></div><div class="line">	ActionContext.getContext().getValueStack().set(<span class="string">"allDepartment"</span>, allDepartment);</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> <span class="string">"editUI"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在staffAction.java中将findStaff放入栈顶。<br>在editStaff.jsp中，例如<code>&lt;s:textfield name=&quot;staffName&quot;&gt;</code>则可以完成信息的回显。struts2底层会调用findValue，先从root开始查询staffName,若为null，则向下contextMap中查询，若仍为null，则会返回空。</p>
<h3 id="checkbox-select-radio标签的使用"><a href="#checkbox-select-radio标签的使用" class="headerlink" title="checkbox \ select \ radio标签的使用"></a>checkbox \ select \ radio标签的使用</h3><p>三者本身都需要有数据。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">   &lt;td&gt;</div><div class="line">   	&lt;s:radio list="&#123;'男','女'&#125;" name="gender"&gt;&lt;/s:radio&gt;</div><div class="line">   &lt;/td&gt;</div><div class="line"> &lt;/tr&gt;</div><div class="line">&lt;tr&gt;</div><div class="line">   &lt;td width="10%"&gt;所属部门：&lt;/td&gt;</div><div class="line">   &lt;td width="20%"&gt;</div><div class="line">   	&lt;s:select list="allDepartment" name="post.department.depId"</div><div class="line">					listKey="depId" listValue="depName"</div><div class="line">					headerKey=""	headerValue="----请选择----"  	    	</div><div class="line">   	&gt;&lt;/s:select&gt;</div><div class="line">   &lt;/td&gt;</div><div class="line">   &lt;td width="8%"&gt;职务：&lt;/td&gt;</div><div class="line">   &lt;td width="62%"&gt;</div><div class="line">   	&lt;s:select list="post != null ? post.department.postSet : &#123;&#125;" name="post.postId"</div><div class="line">					listKey="postId" listValue="postName"</div><div class="line">					headerKey=""	headerValue="----请选择----"	    	</div><div class="line">   	&gt;&lt;/s:select&gt;</div><div class="line">   &lt;/td&gt;</div><div class="line"> &lt;/tr&gt;</div><div class="line"> &lt;tr&gt;</div><div class="line">   &lt;td width="10%"&gt;入职时间：&lt;/td&gt;</div><div class="line">   &lt;td width="20%"&gt;</div><div class="line">   	&lt;s:date name="onDutyDate" format="yyyy-MM-dd" var="myDate"/&gt;</div><div class="line">   	&lt;s:textfield name="onDutyDate" readonly="true" value="%&#123;#myDate&#125;" onfocus="c.showMoreDay=true; c.show(this);"&gt;&lt;/s:textfield&gt;</div><div class="line">   &lt;/td&gt;</div></pre></td></tr></table></figure></p>
<p>对于所属部门：</p>
<p>list中的allDepartment，是在StaffAction中存入root中，完成了查询所有部门的功能，其本身返回的是对象。</p>
<p>其中list表示的是下拉菜单中所有的内容，但此时里面是对象（包括map、javaBean）,因此需要listKey和listValue辅助来完成下拉菜单的显示。</p>
<p>listKey:数据源中元素对象的属性, 用于获取选项的值，对应于select标签中的value。<br>listValue:数据源中元素对象的属性, 用于获取选项的文本内容，对应于select标签中的option。<br>name:完成数据回显，同之前标签的name，从值栈中寻找值，利用listKey来匹配。</p>
<p>但是，下拉菜单中仍存在一定的问题，所属部门和职务应该是存在约束关系的，即选定了所属部门，在职务的菜单中应该只显示该部门中的职务。由此，引申出了<strong><em>ajax二级联动</em></strong>的概念</p>
<h2 id="二-ajax二级联动"><a href="#二-ajax二级联动" class="headerlink" title="二 . ajax二级联动"></a>二 . ajax二级联动</h2><p>ajax需要浏览器和服务器的交互来完成功能。浏览器端先发送<strong>参数</strong>和<strong>路径</strong>至服务器端。在服务器端，利用action来完成将javaBean转换成json数据的处理，再将json数据回调给浏览器。在浏览器端接收到json数据并处理。</p>
<p>浏览器端</p>
<ol>
<li>先获得需要获得的属性，即部门ID；</li>
<li>发送ajax,通过部门查询职务<br>—-2.1 获得引擎（复制）<br>—-2.2 设置回调函数<br>———3 获得数据，并展示 ,手动ajax 获得 json数据 字符串<br>—-2.3 创建连接<br>—-2.4 发送请求</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">&lt;script type="text/javascript"&gt;</div><div class="line">		function showPost(obj)&#123;</div><div class="line">			//1 获得选中部门</div><div class="line">			var depId = obj.value;</div><div class="line">			//2 发送ajax，通过部门查询职务</div><div class="line">			//2.1 获得引擎</div><div class="line">			var xmlhttp=null;</div><div class="line">			if (window.XMLHttpRequest)&#123;// code for all new browsers</div><div class="line">			  xmlhttp=new XMLHttpRequest();</div><div class="line">			&#125; else if (window.ActiveXObject) &#123;// code for IE5 and IE6</div><div class="line">			  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			//2.2 设置回调函数</div><div class="line">			xmlhttp.onreadystatechange = function()&#123;</div><div class="line">				//请求完成，正常响应</div><div class="line">				if(xmlhttp.readyState == 4 &amp;&amp; xmlhttp.status == 200)&#123;</div><div class="line">					//3 获得数据，并展示 ,手动ajax 获得 json数据 字符串</div><div class="line">					var textData = xmlhttp.responseText;</div><div class="line">					//3.1 将字符串 手动 转换 json对象</div><div class="line">					var jsonData = eval("("+textData+")");</div><div class="line">					</div><div class="line">					// 获得select对象</div><div class="line">					var postSelectElement = document.getElementById("postSelectId");</div><div class="line">					postSelectElement.innerHTML = "&lt;option value=''&gt;----请--选--择----&lt;/option&gt;";</div><div class="line">					</div><div class="line">					//3.2 遍历</div><div class="line">					for(var i = 0 ; i &lt; jsonData.length ; i++)&#123;</div><div class="line">						var postObj = jsonData[i];</div><div class="line">						// 获得职务id</div><div class="line">						var postId = postObj.postId;</div><div class="line">						// 获得职务名称</div><div class="line">						var postName = postObj.postName;</div><div class="line">						</div><div class="line">						//3.3 将数显示到select标签</div><div class="line">						postSelectElement.innerHTML += "&lt;option value='"+postId+"'&gt;"+postName+"&lt;/option&gt;";</div><div class="line">					&#125;</div><div class="line">					</div><div class="line">				&#125;</div><div class="line">			&#125;;</div><div class="line">			//2.3 创建连接</div><div class="line">			var url = "$&#123;pageContext.request.contextPath&#125;/postAction_findAllWithDepartment?department.depId=" + depId;</div><div class="line">			xmlhttp.open("GET", url);</div><div class="line">			//2.4 发送请求</div><div class="line">			xmlhttp.send(null);</div><div class="line">		&#125;</div><div class="line">	&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>服务器端</p>
<p>在服务器端需要做的就是处理浏览器发送过来的java对象，并将其转换成为json数据。</p>
<p>需要注意的是，在使用JsonConfig时，需要将不需要的数据排除在外。何为不需要的数据？当要将allPost转换为json数据时，CrmPost对象中有staffSet和department对象，而两者中又有其他的对象，从而会造成使计算机造成死循环，不断调用。<br>因此，使用<strong>setExcludes</strong>将不要的数据排除。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PostAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> <span class="keyword">implements</span> <span class="title">ModelDriven</span>&lt;<span class="title">CrmPost</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> CrmPost post = <span class="keyword">new</span> CrmPost();</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> CrmPost <span class="title">getModel</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> post;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> PostService postService ;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPostService</span><span class="params">(PostService postService)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.postService = postService;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line"></div><div class="line">	<span class="comment">//-------------------------------------------------------------------------------------</span></div><div class="line">	</div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * ajax通过部门查询所有职务</div><div class="line">	 * <span class="doctag">@return</span></div><div class="line">	 * <span class="doctag">@throws</span> Exception </div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">findAllWithDepartment</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		</div><div class="line">		List&lt;CrmPost&gt; allPost = <span class="keyword">this</span>.postService.findAllPost(post.getDepartment());</div><div class="line">		</div><div class="line">		<span class="comment">//2 将java对象 转换 json数据</span></div><div class="line">		</div><div class="line">		<span class="comment">//2.1 将不需要的数据排除在外</span></div><div class="line">		JsonConfig jsonConfig =  <span class="keyword">new</span> JsonConfig();</div><div class="line">		jsonConfig.setExcludes(<span class="keyword">new</span> String[]&#123;<span class="string">"staffSet"</span>,<span class="string">"department"</span>&#125;);</div><div class="line">		<span class="comment">//2.2 完成转换</span></div><div class="line">		String jsonData = JSONArray.fromObject(allPost, jsonConfig).toString();</div><div class="line">		<span class="comment">//3.将json数据发送给浏览器</span></div><div class="line">		</div><div class="line">		<span class="comment">//3.1 设置编码，放置中文乱码 </span></div><div class="line">		ServletActionContext.getResponse().setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</div><div class="line">		<span class="comment">//3.2发送</span></div><div class="line">		ServletActionContext.getResponse().getWriter().print(jsonData);</div><div class="line">		<span class="keyword">return</span> <span class="string">"none"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="三-提交编辑过的表单"><a href="#三-提交编辑过的表单" class="headerlink" title="三 . 提交编辑过的表单"></a>三 . 提交编辑过的表单</h2><p>在表单提交的时候需要隐藏地提交Id,以唯一确定员工。<br><code>&lt;s:hidden name=&quot;staffId&quot; value=&quot;%{staffId}&quot; /&gt;</code>和<code>&lt;s:hidden name=&quot;staffId&quot;/&gt;</code>均可以实现。</p>
<p>添加javascript click事件，提交表单<br>获得文档document,然后得到所有的表单forms,选中第一个，提交。<br>javascript:void(0)阻止href跳转。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;javascript:void(0)&quot; onclick=&quot;document.forms[0].submit()&quot;&gt;</div><div class="line">      &lt;img src=&quot;$&#123;pageContext.request.contextPath&#125;/images/button/save.gif&quot; /&gt;</div><div class="line">&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<h3 id="service层"><a href="#service层" class="headerlink" title="service层"></a>service层</h3><p>更新员工信息，需要考虑到该表单中的每一个属性。</p>
<h2 id="四-条件查询"><a href="#四-条件查询" class="headerlink" title="四 . 条件查询"></a>四 . 条件查询</h2><p><strong>首先，需要过滤不需要的（null 或 “” 或 “ “）</strong></p>
<p>在PO类中添加查询条件字段，来接受客户端传过来的查询条件。一般查询条件都是字符串，因为浏览器都是字符串。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/28/CRM/" data-id="cj31o94yt0000pwtxdkxm1m1e" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-SVN" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/18/SVN/" class="article-date">
  <time datetime="2017-04-18T13:52:53.338Z" itemprop="datePublished">2017-04-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/18/SVN/">SVN</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： SVN</p>
<hr>
<p>版本控制（Revision Control）：是维护工程蓝图的标准做法，能追踪工程蓝图从诞生一直到定案的过程。是一种记录若干文件内容变化，以便将来查阅特定版本修订情况的系统。</p>
<h2 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h2><p>在硬盘中创建一个空的文件夹，如F:\repository\svn\repo1<br>在cmd窗口中可以完成创建仓库操作，包括在指定目录创建仓库和当前目录创建仓库。<br>指定目录创建：svnadmin create F:\repository\svn\repo1<br>当前目录创建：svnadmin create .</p>
<h2 id="启动仓库"><a href="#启动仓库" class="headerlink" title="启动仓库"></a>启动仓库</h2><ul>
<li><p>多仓库<br>cmd &gt; svnserve -d -r F:\repository\svn<br>要访问某一特定的仓库：svn://localhost:3690/repo1</p>
</li>
<li><p>单仓库<br>cmd &gt; svnserve -d -r F:\repository\svn\repo1<br>此时只能访问该已经启动的仓库repo1：svn://localhost:3690</p>
</li>
</ul>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><h3 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a><strong>checkout</strong></h3><p>svn checkout svn://localhost:3690/repo1</p>
<h3 id="commit"><a href="#commit" class="headerlink" title="commit"></a><strong>commit</strong></h3><p>commit需要有权限，需要修改仓库目录中conf\svnserve.conf的配置</p>
<ul>
<li>将<code># anon-access = read</code>修改为<code>anon-access = write</code></li>
<li>使用add子命令添加到本地版本库</li>
</ul>
<p>然后执行语句：<br><code>svn commit -m &quot;user1 add content&quot; test.txt</code><br>其中，语句中包括了-m设置日志信息</p>
<h3 id="update"><a href="#update" class="headerlink" title="update"></a><strong>update</strong></h3><p><strong><em>在每次提交版本之前先执行更新操作</em></strong><br><code>svn update</code></p>
<h2 id="目录规范"><a href="#目录规范" class="headerlink" title="目录规范"></a>目录规范</h2><ul>
<li>trunk 主线 ， 用于存在程序整个进度</li>
<li>branches 分支 ， 例如bug修复、特殊功能</li>
<li>tags 标签（版本） ， 此目录下的内容不能修改 </li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/18/SVN/" data-id="cj31o950e000dpwtx2a0npv8d" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/05/23/SpringMVC学习/">SpringMVC学习</a>
          </li>
        
          <li>
            <a href="/2017/05/23/SpringMVC的freemarker支持/">SpringMVC的freemarker支持</a>
          </li>
        
          <li>
            <a href="/2017/05/18/Mybatis学习二/">Mybatis学习二</a>
          </li>
        
          <li>
            <a href="/2017/05/15/Mybatis学习一/">Mybatis学习一</a>
          </li>
        
          <li>
            <a href="/2017/05/14/Mybatis学习/">Mybatis学习</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Yao<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>
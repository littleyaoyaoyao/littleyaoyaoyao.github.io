<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>We-Param</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="New Land">
<meta property="og:type" content="website">
<meta property="og:title" content="We-Param">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="We-Param">
<meta property="og:description" content="New Land">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="We-Param">
<meta name="twitter:description" content="New Land">
  
    <link rel="alternate" href="/atom.xml" title="We-Param" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">We-Param</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-jQuery学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/08/jQuery学习/" class="article-date">
  <time datetime="2017-05-08T08:45:34.020Z" itemprop="datePublished">2017-05-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/08/jQuery学习/">jQuery学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： jQuery</p>
<hr>
<p>[属性名]       获得指定属性名的元素<br>[属性名=值]    获得属性名 等于 指定值的元素<br>[属性名！=值]  获得属性名 不等于 指定值 的元素</p>
<p>[as1][as2][as3]… 复合选择器，多个条件同时成立。类似 where …and…and</p>
<p>[属性名^=值]   获得以属性值  开头  的元素<br>[属性名$=值]   获得以属性值  结尾  的元素<br>[属性名*=值]   获得   含有属性值   的元素<br>[属性名]  获得指定属性名的元素</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>)</span>&#123;</div><div class="line">        $(<span class="string">"#btn1"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $(<span class="string">"div[title]"</span>).css(<span class="string">"background-color"</span>,<span class="string">"#000"</span>);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line"></div><div class="line">        $(<span class="string">"#btn1"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $(<span class="string">"div[title='test']"</span>).css(<span class="string">"background-color"</span>,<span class="string">"#000"</span>);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line"></div><div class="line">        $(<span class="string">"#btn1"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $(<span class="string">"div[title!='test']"</span>).css(<span class="string">"background-color"</span>,<span class="string">"#000"</span>);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="文档处理"><a href="#文档处理" class="headerlink" title="文档处理"></a>文档处理</h2><h3 id="一-内部插入"><a href="#一-内部插入" class="headerlink" title="一 内部插入"></a>一 内部插入</h3><p>append(content | fn)<br>appendTo(content)<br>prepend(content | fn)<br>prependTo(content) </p>
<p>A.append(B)  将B插入到A的内部后面（之后的串联操作，操作A）<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div><div class="line">	....</div><div class="line">	<span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>A.prepend(B) 将B插入到A的内部前面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line">	....</div><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>A.appendTo(B) 将A插入到B的内部后面 （之后的串联操作，操作A）<br>A.prependTo(B) 将A插入到B的内部前面</p>
<h3 id="二-外部插入"><a href="#二-外部插入" class="headerlink" title="二 外部插入"></a>二 外部插入</h3><p>after(content | fn)<br>before(content | fn)<br>insertAfter(content)<br>insertBefore(content) </p>
<p>A.after(B)  , 将B插入到A后面（同级）<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>A.before(B) ，将B插入到A前面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure></p>
<hr>
<p>A.insertAfter(B) , 将A插入到B后面（同级）<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>A.insertBefore(B) 将A插入到B前面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="三-删除"><a href="#三-删除" class="headerlink" title="三 删除"></a>三 删除</h3><p>empty()<br>remove([expr])<br>detach([expr]) </p>
<p>empty()  清空标签体<br>remove() 删除当前对象。如果之后再使用，元素本身保留，绑定事件 或 绑定数据 都会被移除<br>detach() 删除当前对象。如果之后再使用，元素本身保留，绑定事件 或 绑定数据 都保留</p>
<ul>
<li>绑定数据<br>  data(name) 获得<br>  data(name,value) 设置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">// 将city移除，再追加body后面</div><div class="line">	</div><div class="line">	//#1 绑定事件</div><div class="line">	$(&quot;#city&quot;).click(function()&#123;</div><div class="line">		alert(&quot;哈哈&quot;);</div><div class="line">	&#125;);</div><div class="line">	//#2 绑定数据</div><div class="line">	$(&quot;#city&quot;).data(&quot;yao&quot;,&quot;bang&quot;);</div><div class="line">	</div><div class="line">	</div><div class="line">	//1 移除</div><div class="line">	var $city = $(&quot;#city&quot;).remove(); //移除绑定的事件、移除绑定的数据</div><div class="line">//	var $city = $(&quot;#city&quot;).detach(); //保留绑定的事件、保留绑定的数据</div><div class="line">	</div><div class="line">	</div><div class="line">	//2 追加</div><div class="line">	$(&quot;body&quot;).append($city);</div><div class="line">	</div><div class="line">	</div><div class="line">	//#3获得绑定的数据</div><div class="line">	alert($(&quot;#city&quot;).data(&quot;yao&quot;));</div></pre></td></tr></table></figure>
<h2 id="筛选"><a href="#筛选" class="headerlink" title="筛选"></a>筛选</h2><h3 id="一-过滤"><a href="#一-过滤" class="headerlink" title="一 过滤"></a>一 过滤</h3><p>eq(index)<br>first()<br>last()<br>hasClass(class)<br>filter(expr | fn)<br>is(expr)<br>map(callback)<br>has(expr)<br>not(expr)<br>slice(start, [end]) </p>
<p>eq(index | -index)  类型 :eq()<br>····    index：正数，从头开始获得指定索引的元素。这个元素的位置是从0算起。0表示第一个<br>····     -index：负数，从尾开始获得指定索引的元素。1算起。 -1表示最后一个</p>
<p>first()    第一个  :first</p>
<p>last()    最后一个  :last</p>
<p>is()        判断</p>
<p>hasClass()    判断是否是指定class 。<xxx class="my"><br>    这其实就是 is(“.” + class)。</xxx></p>
<p>filter()  筛选出与指定表达式匹配的元素集合</p>
<p>not()    将指定内容删除</p>
<p>has()   子元素是否有</p>
<p>slice(start , end)  截取元素 ，[2,4)  –&gt; 2,3</p>
<p>map()  jQuery对象 拆分成  jQuery对象数组</p>
<h3 id="二-查找"><a href="#二-查找" class="headerlink" title="二 查找"></a>二 查找</h3><p>children([expr])<br>closest([expr])<br>find(expr)<br>next([expr])<br>nextAll([expr])<br>nextUntil([expr])<br>offsetParent()<br>parent([expr])<br>parents([expr])<br>parentsUntil([expr])<br>prev([expr])<br>prevAll([expr])<br>prevUntil([expr])<br>siblings([expr]) </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">A</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">B</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">C</span>&gt;</span><span class="tag">&lt;/<span class="name">C</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">D</span>&gt;</span><span class="tag">&lt;/<span class="name">D</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">E</span>&gt;</span><span class="tag">&lt;/<span class="name">E</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">F</span>&gt;</span><span class="tag">&lt;/<span class="name">F</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">B</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">A</span>&gt;</span></div></pre></td></tr></table></figure>
<p>B.children([…])   获得所有的子元素。CDEF<br>A.find(D)  从指定的区域查询指定元素。D<br>D.next()    下一个兄弟。E<br>D.nextAll() 后面的所有兄弟。EF<br>E.prev()    上一个兄弟。D  （previous）<br>E.prevAll()  前面的所有兄弟。CD<br>E.siblings()    所有兄弟。CDF<br>E.parent()  父元素。B<br>E.closest(A)  向上获得指定的父元素（含自己），如果获得返回一个对象，如果没有没有对象。<br>//——————————</p>
<p>C.nextUntil(E)  获得后面所有兄弟，直到指定条件位置。DE<br>F.prevUntil(D)  获得前面所有兄弟，直到指定条件位置。DE</p>
<p>E.parents()   获得所有的父元素。AB</p>
<ul>
<li>closest和parents的主要区别是：<br>1，前者从当前元素开始匹配寻找，后者从父元素开始匹配寻找；<br>2，前者逐级向上查找，直到发现匹配的元素后就停止了，后者一直向上查找直到根元素，然后把这些元素放进一个临时集合中，再用给定的选择器表达式去过滤；<br>3，前者返回0或1个元素，后者可能包含0个，1个，或者多个元素。</li>
</ul>
<h3 id="三-串联"><a href="#三-串联" class="headerlink" title="三 串联"></a>三 串联</h3><p>A.add(B)  将A和B组合一个对象 。类型 $(“A,B”)<br>andSelf() ： 将之前对象添加到操作集合中<br>    A.children().andSelf()<br>       A    孩子    孩子和A<br>end() ：回到最近的一个”破坏性”操作之前<br>    A.children().children().end() .end()<br>    A   孩子   孙子        孩子  A<br>//———————————–<br>contents()  获得所有的子节点（子元素 和 文本）</p>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="comment">//1所有分组列表项默认都是隐藏的。</span></div><div class="line">		<span class="comment">//2 分组（span）可以点击，控制下面的列表项显示或隐藏</span></div><div class="line">		<span class="comment">//3 当前分组列表项显示，其他分页隐藏（同时只有一个显示）</span></div><div class="line">		</div><div class="line">		$(<span class="string">"div"</span>).children(<span class="string">"a"</span>).hide().prev(<span class="string">"span"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			$(<span class="keyword">this</span>).nextAll(<span class="string">"a"</span>).toggle().parent().siblings(<span class="string">"div"</span>).find(<span class="string">"a"</span>).hide();</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">	&#125;);</div></pre></td></tr></table></figure>
<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><h3 id="一-事件"><a href="#一-事件" class="headerlink" title="一 . 事件"></a>一 . 事件</h3><p>blur( [fn] )      失去焦点<br>change( [fn] )    改变<br>click( [fn] )     单击<br>dblclick( [fn] )  双击<br>error( [fn] )     页面异常<br>focus( [fn] )     获得焦点<br>focusin( [fn] )<br>focusout( [fn] )<br>keydown( [fn] )<br>keypress( [fn] )<br>keyup( [fn] )<br>mousedown(fn)<br>mousemove(fn)<br>mouseout(fn)      鼠标移出<br>mouseover(fn)     鼠标移入<br>mouseup(fn)       鼠标弹起<br>resize(fn)        改变大小<br>scroll(fn)        滚动<br>select( [fn] )    选择<br>submit( [fn] )<br>unload(fn)        页面卸载</p>
<ul>
<li>jQuery 提供额外的事件，用于完善javascript缺失的</li>
<li><p>focusin 和 focusout<br>  focusin 获得焦点。js focus。</p>
<pre><code>focusin事件跟focus事件区别在于，他可以在父元素上检测子元素获取焦点的情况。
</code></pre><p>  focusout 失去焦点。js blur。</p>
<pre><code>focusout事件跟blur事件区别在于，他可以在父元素上检测子元素失去焦点的情况。
</code></pre></li>
<li><p>mouseenter 和 mouseleave<br>  mouseenter 鼠标移入。js mouseover</p>
<pre><code>与 mouseover 事件不同，只有在鼠标指针穿过被选元素时，才会触发 mouseenter 事件。如果鼠标指针穿过任何子元素，同样会触发 mouseover 事件。
</code></pre><p>  mouseleave 鼠标移出。js mouseout</p>
<pre><code>与 mouseout 事件不同，只有在鼠标指针离开被选元素时，才会触发 mouseleave 事件。如果鼠标指针离开任何子元素，同样会触发 mouseout 事件。
</code></pre></li>
</ul>
<h3 id="二-页面加载"><a href="#二-页面加载" class="headerlink" title="二 . 页面加载"></a>二 . 页面加载</h3><p><strong><em>ready(in)</em></strong></p>
<ul>
<li><p>方式一：标准api<br>$(document).ready(function(){<br>});<br>等效于<br>jQuery(document).ready(fn);</p>
</li>
<li><p>方式二：简化版<br>$(function(){<br>});<br>等效于<br>jQuery(function{<br>});</p>
</li>
</ul>
<p><strong>分析源码后总结</strong>：<br>$(document).ready(function(){<br>});</p>
<p><strong><em>等效于</em></strong></p>
<p>$(function(){<br>});</p>
<h3 id="三-处理"><a href="#三-处理" class="headerlink" title="三 . 处理"></a><strong><em>三 . 处理</em></strong></h3><p>bind(type, [data], fn)   给当前对象绑定一个事件。例如：A.bind(“click”, fn );  类型：A.click( fn );<br>unbind(type )            解绑bind绑定事件</p>
<p>one(type, [data], fn)    给当前对象绑定一次事件。<br>//——————————————————————————<br>trigger(type, [data])<br>triggerHandler(type, [data])<br>unbind([type], [data])</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">	&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"../js/jquery-1.8.3.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line">	&lt;script type=<span class="string">"text/javascript"</span>&gt;</div><div class="line">		$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//	&lt;input id="h01" type="button" value="1 只能点击一次，之后失效" /&gt; </span></div><div class="line">			$(<span class="string">"#h01"</span>).one(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				alert(<span class="string">"看到一次"</span>);</div><div class="line">			&#125;);</div><div class="line"><span class="comment">//	&lt;input id="h02" type="button" value="2可以点击多次" /&gt;</span></div><div class="line">			<span class="comment">//jQuery 事件别名，格式：事件.别名</span></div><div class="line">			$(<span class="string">"#h02"</span>).bind(<span class="string">"click.a"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				alert(<span class="string">"111"</span>);</div><div class="line">			&#125;);</div><div class="line">			$(<span class="string">"#h02"</span>).bind(<span class="string">"click.b"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				alert(<span class="string">"222"</span>);</div><div class="line">			&#125;);</div><div class="line"><span class="comment">//	&lt;input id="h03" type="button" value="3解绑2" /&gt; </span></div><div class="line">			$(<span class="string">"#h03"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				$(<span class="string">"#h02"</span>).unbind(<span class="string">"click.b"</span>);</div><div class="line">			&#125;);</div><div class="line"><span class="comment">//	&lt;input type="button" value="4 添加一个按钮，样式为myClass，且拥有相同的事件" class="myClass" /&gt;</span></div><div class="line">			$(<span class="string">".myClass"</span>).live(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				$(<span class="string">"body"</span>).append(<span class="string">"&lt;input type='button' class='myClass' /&gt;"</span>);</div><div class="line">			&#125;);</div><div class="line"><span class="comment">//	&lt;input id="h05" type="button" value="5 解绑4"/&gt; </span></div><div class="line">			$(<span class="string">"#h05"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				$(<span class="string">".myClass"</span>).die(<span class="string">"click"</span>);</div><div class="line">			&#125;);</div><div class="line">		&#125;);</div><div class="line">	<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>3.3.2    委派<br>live(type , fn) 绑定事件，之后动态添加同样的成员，也具有相同的事件。<br>die(type) 解绑事件</p>
<p>3.3.3    切换</p>
<p>hover(over , out)<br>简化版，鼠标移入和移出  ，A.mouseover( fn ).mouseout( fn)  简化 A.hover( fn , fn )</p>
<p>toggle( fn , fn , fn ,…) 执行click事件，每点击一次执行一个fn</p>
<p><strong>鼠标移动链接提示案例</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>文字提示<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"> <span class="comment">&lt;!--   引入jQuery --&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"../js/jquery-1.8.3.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></div><div class="line">body&#123;</div><div class="line">	margin:0;</div><div class="line">	padding:40px;</div><div class="line">	background:#fff;</div><div class="line">	font:80% Arial, Helvetica, sans-serif;</div><div class="line">	color:#555;</div><div class="line">	line-height:180%;</div><div class="line">&#125;</div><div class="line">p&#123;</div><div class="line">	clear:both;</div><div class="line">	margin:0;</div><div class="line">	padding:.5em 0;</div><div class="line">&#125;</div><div class="line">/* tooltip */</div><div class="line">#tooltip&#123;</div><div class="line">	position:absolute;</div><div class="line">	border:1px solid #333;</div><div class="line">	background:#f7f5d1;</div><div class="line">	padding:1px;</div><div class="line">	color:#333;</div><div class="line">	width:300px;</div><div class="line">	display:none;</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">	$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="comment">//将自带的提示，替换成 自定义提示</span></div><div class="line">		</div><div class="line">		$(<span class="string">".mytooltip"</span>).mouseover(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">			</div><div class="line">			<span class="comment">//1 获得绑定的数据</span></div><div class="line">			<span class="keyword">var</span> title = $(<span class="keyword">this</span>).data(<span class="string">"mytitle"</span>); <span class="comment">//undefined转换成boolean类型，默认转换成false;</span></div><div class="line">			<span class="keyword">if</span>(! title)&#123;  <span class="comment">//没有</span></div><div class="line">				<span class="comment">//获得自带提示</span></div><div class="line">				title = $(<span class="keyword">this</span>).attr(<span class="string">"title"</span>);</div><div class="line">				<span class="comment">//将自带提示删除</span></div><div class="line">				$(<span class="keyword">this</span>).removeAttr(<span class="string">"title"</span>);</div><div class="line">				<span class="comment">//绑定数据</span></div><div class="line">				$(<span class="keyword">this</span>).data(<span class="string">"mytitle"</span>,title)</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			<span class="comment">//2 创建div</span></div><div class="line">			<span class="keyword">var</span> $<span class="keyword">new</span> = $(<span class="string">"&lt;div id='tooltip'&gt;&lt;/div&gt;"</span>);</div><div class="line">			<span class="comment">//3设置提示</span></div><div class="line">			$<span class="keyword">new</span>.html(title);</div><div class="line">			</div><div class="line">			<span class="comment">//4定位</span></div><div class="line">			$<span class="keyword">new</span>.offset(&#123;<span class="string">"left"</span>:event.pageX + <span class="number">5</span>,<span class="string">"top"</span>:event.pageY - <span class="number">20</span>&#125;);</div><div class="line">			</div><div class="line">			<span class="comment">//5追加到body，并显示</span></div><div class="line">			$<span class="keyword">new</span>.appendTo(<span class="string">"body"</span>).show();</div><div class="line">		&#125;).mouseout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="comment">//删除</span></div><div class="line">			$(<span class="string">"#tooltip"</span>).remove();</div><div class="line">		&#125;).mousemove(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">			<span class="comment">// 重写定位</span></div><div class="line">			$(<span class="string">"#tooltip"</span>).offset(&#123;<span class="string">"left"</span>:event.pageX + <span class="number">5</span>,<span class="string">"top"</span>:event.pageY - <span class="number">20</span>&#125;);</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">	&#125;);</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"mytooltip"</span> <span class="attr">title</span>=<span class="string">"超链接提示1."</span>&gt;</span>提示1.<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"mytooltip"</span> <span class="attr">title</span>=<span class="string">"超链接提示2."</span>&gt;</span>提示2.<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"></div><div class="line">	</div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><p>ajax ： 异步请求，浏览器地址栏不改变，进行局部刷新。</p>
<ul>
<li>jQuery需要完成的事情：<br>请求路径<br>请求参数<br>编写回调，获取json数据</li>
</ul>
<h3 id="一-ajax-请求"><a href="#一-ajax-请求" class="headerlink" title="一 . ajax 请求"></a>一 . ajax 请求</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$.post(url,[data],[fn],[type]) </div><div class="line">$.get(url,[data],[fn],[type]) </div><div class="line">load(url,[data],[callback]) </div><div class="line">$.ajax(url,[settings]) </div><div class="line">$.getJSON(url,[data],[fn]) </div><div class="line">$.getScript(url,[callback])</div></pre></td></tr></table></figure>
<h4 id="post"><a href="#post" class="headerlink" title="$.post()"></a><strong><em>$.post()</em></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 3 $.post() 全局函数，发送post请求</span></div><div class="line">				 * * 格式：jQuery.post(url, [data], [callback], [type])</div><div class="line">				$.post(url,params,function(data)&#123;</div><div class="line">					alert(data);</div><div class="line">				&#125;,"json")</div><div class="line">				 */</div></pre></td></tr></table></figure>
<h4 id="get"><a href="#get" class="headerlink" title="$.get()"></a><strong><em>$.get()</em></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 2 $.get() 全局函数，发送get请求</span></div><div class="line">				 * * 格式：jQuery.get(url, [data], [callback], [type])</div><div class="line">				 * 		* 参数4：type ，返回内容格式，xml, html, script, json, text, _default。</div><div class="line">				 * * GET请求不适合发送中文数据，存放请求的中文乱码。</div><div class="line">				 * 		必须手动解码   new String(username.getBytes("ISO-8859-1") ,"UTF-8")</div><div class="line">				 * * 响应数据，如果使用  application/json;charset=UTF-8 ，jQuery自动将数据转换json对象。</div><div class="line">				 * * 响应数据，如果使用  text/html;charset=UTF-8 ，回调函数获得字符串数据，需要手动转换。</div><div class="line">				 * 		使用“参数4”，设置"json"，jQuery将字符串 转换成 json对象</div><div class="line">				 */</div><div class="line">				$.get(url,params,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">					alert(data);</div></pre></td></tr></table></figure>
<h4 id="load"><a href="#load" class="headerlink" title="load()"></a><strong><em>load()</em></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//0.2 请求参数，采用json</span></div><div class="line">				<span class="keyword">var</span> params = &#123;<span class="string">"username"</span>:<span class="string">"杰克"</span>, <span class="string">"password"</span>:<span class="string">"1234"</span>&#125;;</div><div class="line">				</div><div class="line">				<span class="comment">/* 1 load()函数 ，必须使用jquery对象</span></div><div class="line">				 * * 格式：load(url, [data], [callback])</div><div class="line">				 * 		参数1：url ，请求路径</div><div class="line">				 * 		参数2：data，请求参数</div><div class="line">				 * 		参数3：callback，回调函数</div><div class="line">				 * * 如果没有请求参数，发送的GET请求</div><div class="line">				 * * 如果有请求参数，发送的POST请求。请求没有中文乱码</div><div class="line">				 * * 回调函数的参数</div><div class="line">				 * 		参数1：data，响应数据。load()永远获得字符串，如果需要使用，必须手动转换json对象。</div><div class="line">				 */</div><div class="line">				$(<span class="keyword">this</span>).load(url,params,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">					<span class="comment">//转换json对象</span></div><div class="line">					<span class="keyword">var</span> jsonData = <span class="built_in">eval</span>(<span class="string">"("</span>+data+<span class="string">")"</span>);</div><div class="line">					alert(jsonData.message);</div><div class="line">				&#125;);</div></pre></td></tr></table></figure>
<h4 id="ajax"><a href="#ajax" class="headerlink" title="$.ajax()"></a><strong><em>$.ajax()</em></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 4 $.ajax() 底层功能最强大的</span></div><div class="line">				 * * 格式：jQuery.ajax([settings])</div><div class="line">				 * 		参数settings：设置所有的参数</div><div class="line">				 * 			url:发送请求的地址</div><div class="line">				 * 			data:发送到服务器的数据,请求参数</div><div class="line">				 * 			type:请求方式 ("POST" 或 "GET")， </div><div class="line">				 * 			success:成功的回调函数，success(data, textStatus, jqXHR)</div><div class="line">				 * 			error:请求失败时调用此函数</div><div class="line">				 * 			dataType:预期服务器返回的数据类型</div><div class="line">				 * 				"xml": 返回 XML 文档，可用 jQuery 处理。</div><div class="line">				 * 				"html": 返回纯文本 HTML 信息；包含的script标签会在插入dom时执行。</div><div class="line">				 * 				"script": 返回纯文本 JavaScript 代码。不会自动缓存结果。除非设置了"cache"参数。'''注意：'''在远程请求时(不在同一个域下)，所有POST请求都将转为GET请求。(因为将使用DOM的script标签来加载)</div><div class="line">				 * 				"json": 返回 JSON 数据 。</div><div class="line">				 * 				"jsonp": JSONP 格式。使用 JSONP 形式调用函数时，如 "myurl?callback=?" jQuery 将自动替换 ? 为正确的函数名，以执行回调函数。</div><div class="line">				 * 				"text": 返回纯文本字符串</div><div class="line">				 */</div><div class="line">				</div><div class="line">				$.ajax(&#123;</div><div class="line">					<span class="string">"url"</span>:url,</div><div class="line">					<span class="string">"data"</span>:params,</div><div class="line">					<span class="string">"type"</span>:<span class="string">"POST"</span>,</div><div class="line">					<span class="string">"success"</span>:<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">						alert(data);</div><div class="line">					&#125;,</div><div class="line">					<span class="string">"error"</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">						alert(<span class="string">"服务器繁忙，请稍后重试"</span>);</div><div class="line">					&#125;,</div><div class="line">					<span class="string">"dataType"</span>:<span class="string">"json"</span></div><div class="line">				&#125;);</div></pre></td></tr></table></figure>
<h3 id="二-其他"><a href="#二-其他" class="headerlink" title="二 . 其他"></a>二 . 其他</h3><h4 id="2-1-表单序列化"><a href="#2-1-表单序列化" class="headerlink" title="2.1 表单序列化"></a>2.1 表单序列化</h4><p>serialize()  ： 将表单中的数据序列为字符串<br>serializearray()  ： 将表单中的数据序列为json对象</p>
<h4 id="2-2-时间冒泡"><a href="#2-2-时间冒泡" class="headerlink" title="2.2 时间冒泡"></a>2.2 时间冒泡</h4><p>子元素事件  执行时，会一并触发父元素相同的事件<br>event.stopPropagation()</p>
<h4 id="2-3-浏览器默认动作"><a href="#2-3-浏览器默认动作" class="headerlink" title="2.3 浏览器默认动作"></a>2.3 浏览器默认动作</h4><p>href是a标签的默认行为，要阻止该行为，有两种方法：</p>
<ol>
<li>return false;</li>
<li>event.preventDefault(); </li>
</ol>
<h3 id="三-动态加载"><a href="#三-动态加载" class="headerlink" title="三 . 动态加载"></a>三 . 动态加载</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../js/jquery-1.8.3.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">		$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="comment">//1 创建10div</span></div><div class="line">			<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; <span class="number">10</span> ; i ++)&#123;</div><div class="line">				createDiv();</div><div class="line">			&#125;</div><div class="line">			<span class="comment">//2 浏览器添加滚动事件</span></div><div class="line">			$(<span class="built_in">window</span>).scroll(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="comment">//2.1 滚过高度</span></div><div class="line">				<span class="keyword">var</span> wt = $(<span class="keyword">this</span>).scrollTop();</div><div class="line">				<span class="comment">//2.2 整个文档高度</span></div><div class="line">				<span class="keyword">var</span> dh = $(<span class="built_in">document</span>).height();</div><div class="line">				<span class="comment">//2.3 窗口的高度</span></div><div class="line">				<span class="keyword">var</span> wh = $(<span class="keyword">this</span>).height();</div><div class="line">				</div><div class="line">				<span class="comment">//3 当接近底部时，添加</span></div><div class="line">				<span class="keyword">if</span>(wt + wh + <span class="number">100</span> &gt; dh)&#123;</div><div class="line">					createDiv();</div><div class="line">					</div><div class="line">					<span class="comment">//发送ajax填充数据</span></div><div class="line">				&#125;</div><div class="line">				</div><div class="line">				<span class="comment">//提示</span></div><div class="line">				$(<span class="string">"#showDiv"</span>).html(<span class="string">"wt: "</span> + wt + <span class="string">" , dh: "</span> + dh + <span class="string">" , wh:"</span> + wh);</div><div class="line">			&#125;);</div><div class="line">			</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		<span class="keyword">var</span> num = <span class="number">1</span>;</div><div class="line">		<span class="comment">//创建div</span></div><div class="line">		<span class="function"><span class="keyword">function</span> <span class="title">createDiv</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> $div = $(<span class="string">"&lt;div class='newDiv' /&gt;"</span>);</div><div class="line">			$div.html(num ++ );</div><div class="line">			</div><div class="line">			$(<span class="string">"body"</span>).append($div);</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	<span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></div><div class="line">		.newDiv&#123;</div><div class="line">		  border: 1px solid #999;</div><div class="line">		  width: 400px;</div><div class="line">		  height: 100px;</div><div class="line">		  margin: 5px;</div><div class="line">		  font-size: 50px;</div><div class="line">		&#125;</div><div class="line">		#showDiv&#123;</div><div class="line">		   border: 1px solid #999;</div><div class="line">		  width: 500px;</div><div class="line">		  height: 30px;</div><div class="line">		  position: fixed;</div><div class="line">		  bottom: 0;</div><div class="line">		  right: 100px;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	<span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"showDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()&#123;</div><div class="line">			//1 创建10div </div><div class="line">			for(var i = 0 ; i &lt; 5 ; i ++)&#123;</div><div class="line">				createDiv();</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			</div><div class="line">			//定时器</div><div class="line">			setInterval(showDiv,100);</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		function showDiv()&#123;</div><div class="line">			//第一个隐藏</div><div class="line">			$(&quot;div:first&quot;).slideUp(100,function()&#123;</div><div class="line">				$(this).appendTo(&quot;body&quot;).slideDown(100);</div><div class="line">			&#125;);</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		var num = 1;</div><div class="line">		//创建div</div><div class="line">		function createDiv()&#123;</div><div class="line">			var $div = $(&quot;&lt;div class=&apos;newDiv&apos; /&gt;&quot;);</div><div class="line">			$div.html(num ++ );</div><div class="line">			</div><div class="line">			$(&quot;body&quot;).append($div);</div><div class="line">		&#125;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/08/jQuery学习/" data-id="cj6dowbnn000t9otxzvreoycc" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/04/JavaScript学习/" class="article-date">
  <time datetime="2017-05-04T13:39:10.351Z" itemprop="datePublished">2017-05-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/04/JavaScript学习/">JavaScript学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： JavaScript</p>
<hr>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h3><p>###字符串<br>toUpperCase()把一个字符串全部变为大写;<br>toLowerCase()把一个字符串全部变为小写;<br>indexOf()会搜索指定字符串出现的位置;<br>substring()返回指定索引区间的子串;</p>
<h3 id="布尔型"><a href="#布尔型" class="headerlink" title="布尔型"></a>布尔型</h3><h2 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h2><p>需要注意的是:=== 它不会自动转换数据类型，如果数据类型不一致，返回false，如果一致，再比较。</p>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p>JavaScript的数组可以包括任意数据类型。<br>在数组中直接给数组的长度赋值会导致数组的长度发生变化。</p>
<ul>
<li><p>创建数组：<br><code>var arr=[1,2,3];</code><br><code>new Array[1,2,3];</code></p>
</li>
<li><p>Array也可以通过indexOf()来搜索一个指定的元素的位置</p>
</li>
<li><p><strong>slice()</strong>就是对应String的substring()版本，它截取Array的部分元素，然后返回一个新的Array</p>
</li>
<li><p><strong>push()</strong>向Array的末尾添加若干元素，<strong>pop()</strong>则把Array的最后一个元素删除掉</p>
</li>
<li><p>如果要往Array的头部添加若干元素，使用<strong>unshift()</strong>方法，<strong>shift()</strong>方法则把Array的第一个元素删掉</p>
</li>
<li><p><strong>sort()</strong>可以对当前Array进行排序，它会直接修改当前Array的元素位置，直接调用时，按照默认顺序排序</p>
</li>
<li><p><strong>reverse()</strong>把整个Array的元素反转</p>
</li>
<li><p><strong>splice()</strong>方法是修改Array的“万能方法”，它可以从指定的索引开始删除若干元素，然后再从该位置添加若干元素</p>
</li>
<li><p><strong>concat()</strong>方法把当前的Array和另一个Array连接起来，并返回一个新的Array</p>
</li>
<li><p><strong><em>join()</em></strong>方法把当前Array的每个元素都用指定的字符串连接起来，然后返回连接后的字符串</p>
</li>
</ul>
<h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2><p>JavaScrpitpt的对象是一组由键-值组成的<strong>无序</strong>集合。<br>JavaScript对象的键都是字符串类型，值可以是任意数据类型。<br>要获取一个对象的属性，我们用<strong>对象变量.属性名</strong>的方式。</p>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>可以把任意数据类型赋值给变量，同一个变量可以反复赋值，而且可以是不同类型的变量，但是要注意只能用var申明一次。<br>如果一个变量没有通过var申明就被使用的话，那么这个变量就会自动被申明为全局变量。使用var申明的变量则不是全局变量，它的范围被限制在该变量被申明的函数体内，同名变量在不同函数体内互不冲突。</p>
<h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><p>普通的循环不做赘述，for循环的一个变体是for…in循环，它可以把一个对象的所有属性依次循环出来</p>
<h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><p><code>var m = new Map([[&#39;sam&#39;, 110], [&#39;Bob&#39;, 120], [&#39;T-mac&#39;, 119]])</code></p>
<p>由于一个key只能对应一个value，所以，多次对一个key放入value，后面的值会把前面的值冲掉:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">m.set(<span class="string">'Adam'</span>, <span class="number">67</span>);</div><div class="line">m.set(<span class="string">'Adam'</span>, <span class="number">88</span>);</div><div class="line">m.get(<span class="string">'Adam'</span>); <span class="comment">// 88</span></div></pre></td></tr></table></figure></p>
<h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><p><code>var s1 = new Set([1, 2, 3]); // 含1, 2, 3</code></p>
<h2 id="iterable"><a href="#iterable" class="headerlink" title="iterable"></a>iterable</h2><p>注意：Array、Map和Set都属于iterable类型；<br>具有iterable类型的集合可以通过新的<strong><em>for … of</em></strong>循环来遍历。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>];</div><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>]);</div><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="number">1</span>, <span class="string">'x'</span>], [<span class="number">2</span>, <span class="string">'y'</span>], [<span class="number">3</span>, <span class="string">'z'</span>]]);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> a) &#123; <span class="comment">// 遍历Array</span></div><div class="line">    alert(x);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> s) &#123; <span class="comment">// 遍历Set</span></div><div class="line">    alert(x);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> m) &#123; <span class="comment">// 遍历Map</span></div><div class="line">    alert(x[<span class="number">0</span>] + <span class="string">'='</span> + x[<span class="number">1</span>]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h3><p>函数的定义方法有两种：<br><code>function abs(x)</code><br><code>var abc = fucntion abs(x) //注意这种定义方法的末尾需要加上;</code><br>第二种方式可以通过变量abc来调用函数,且abc是一个<strong><em>全局变量</em></strong></p>
<h3 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h3><p>由于JavaScript允许传入任意个参数而不影响调用，因此传入的参数比定义的参数多也没有问题，虽然函数内部并不需要这些参数。例如：<br><code>abc(10,‘what are you doing’)</code>;</p>
<h3 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h3><p>JavaScript还有一个的关键字arguments，它只在函数内部起作用，并且永远指向当前函数的调用者传入的所有参数.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    alert(x); <span class="comment">// 10</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="built_in">arguments</span>.length; i++) &#123;</div><div class="line">        alert(<span class="built_in">arguments</span>[i]); <span class="comment">// 10, 20, 30</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">func(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</div></pre></td></tr></table></figure></p>
<h3 id="rest"><a href="#rest" class="headerlink" title="rest"></a>rest</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a, b, ...rest</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'a = '</span> + a);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'b = '</span> + b);</div><div class="line">    <span class="built_in">console</span>.log(rest);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line"><span class="comment">// 结果:</span></div><div class="line"><span class="comment">// a = 1</span></div><div class="line"><span class="comment">// b = 2</span></div><div class="line"><span class="comment">// Array [ 3, 4, 5 ]</span></div><div class="line"></div><div class="line">foo(<span class="number">1</span>);</div><div class="line"><span class="comment">// 结果:</span></div><div class="line"><span class="comment">// a = 1</span></div><div class="line"><span class="comment">// b = undefined</span></div><div class="line"><span class="comment">// Array []</span></div></pre></td></tr></table></figure>
<h3 id="全局作用域"><a href="#全局作用域" class="headerlink" title="全局作用域"></a>全局作用域</h3><p>JavaScript默认有一个全局对象window，全局作用域的变量实际上被绑定到window的一个属性<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> course = <span class="string">'Learn JavaScript'</span>;</div><div class="line">alert(course); <span class="comment">// 'Learn JavaScript'</span></div><div class="line">alert(<span class="built_in">window</span>.course); <span class="comment">// 'Learn JavaScript'</span></div></pre></td></tr></table></figure></p>
<h3 id="局部作用域"><a href="#局部作用域" class="headerlink" title="局部作用域"></a>局部作用域</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</div><div class="line">        sum += i;</div><div class="line">    &#125;</div><div class="line">    i += <span class="number">1</span>; <span class="comment">// SyntaxError</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y, f</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> f(x) + f(y);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>由于map()方法定义在JavaScript的Array中，我们调用Array的map()方法，传入我们自己的函数，就得到了一个新的Array作为结果：</p>
<h4 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h4><p>Array中有map()方法，其作用用下面的例子来展示：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">pow</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x * x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</div><div class="line">arr.map(pow); <span class="comment">// [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></div></pre></td></tr></table></figure></p>
<p>map()传入的参数是pow，即函数对象本身。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</div><div class="line">arr.map(<span class="built_in">String</span>); <span class="comment">// ['1', '2', '3', '4', '5', '6', '7', '8', '9']</span></div></pre></td></tr></table></figure>
<h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a>reduce()</h4><p>Array的reduce()把一个函数作用在这个Array的[x1,x2,x3…]上，这个函数必须接收两个参数，reduce()把结果继续和序列的下一个元素做累积计算,即</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[x1, x2, x3, x4].reduce(f)=f(f(f(x1, x2), x3), x4)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>];</div><div class="line">arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x + y;</div><div class="line">&#125;); <span class="comment">// 25</span></div></pre></td></tr></table></figure>
<p>其作用就相当于是做了累加。</p>
<h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>filter也是一个常用的操作，它用于把<strong>Array</strong>的某些元素过滤掉，然后返回剩下的元素。<br>filter()将传入的函数依次作用于每个元素，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">15</span>];</div><div class="line"><span class="keyword">var</span> r = arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x % <span class="number">2</span> !== <span class="number">0</span>;</div><div class="line">&#125;);</div><div class="line"> <span class="comment">// [1, 5, 9, 15]</span></div></pre></td></tr></table></figure>
<h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><h3 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h3><p>generator和函数不同的是，generator由function<em>定义（注意多出的</em>号），并且，除了return语句，还可以用yield返回多次。</p>
<p>举例，要产生斐波那契数列，用原来的方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fib</span>(<span class="params">max</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span></div><div class="line">        t,</div><div class="line">        a = <span class="number">0</span>,</div><div class="line">        b = <span class="number">1</span>,</div><div class="line">        arr = [<span class="number">0</span>, <span class="number">1</span>];</div><div class="line">    <span class="keyword">while</span> (arr.length &lt; max) &#123;</div><div class="line">        t = a + b;</div><div class="line">        a = b;</div><div class="line">        b = t;</div><div class="line">        arr.push(t);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> arr;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>若用generator,则可以换一种方法来完成：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">fib</span>(<span class="params">max</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span></div><div class="line">        t,</div><div class="line">        a = <span class="number">0</span>,</div><div class="line">        b = <span class="number">1</span>,</div><div class="line">        n = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (n &lt; max) &#123;</div><div class="line">        <span class="keyword">yield</span> a;</div><div class="line">        t = a + b;</div><div class="line">        a = b;</div><div class="line">        b = t;</div><div class="line">        n ++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> a;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>可以发现，普通函数返回的是一个Array，而使用generator，就可以一次返回一个数，不断返回多次。<br>直接调用一个generator和调用函数不一样，fib(5)仅仅是创建了一个generator对象，还没有去执行它。要调用generator有两种方法。</p>
<h2 id="标准对象"><a href="#标准对象" class="headerlink" title="标准对象"></a>标准对象</h2><p><strong><em>在JavaScript的世界里，一切都是对象。</em></strong></p>
<ol>
<li><p>若想获取对象的类型，使用<strong>typeof</strong><br>如果我们用typeof将无法区分出null、Array和通常意义上的object——{}</p>
</li>
<li><p>包装对象<br>number —–  Number<br>boolean —-  Boolean<br>string —–  String</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ar n = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">123</span>); <span class="comment">// 123,生成了新的包装类型</span></div><div class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">true</span>); <span class="comment">// true,生成了新的包装类型</span></div><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'str'</span>); <span class="comment">// 'str',生成了新的包装类型</span></div></pre></td></tr></table></figure>
<p>此时这些对象已经变成object<br><strong>注意：</strong>尽量不要使用包装类型</p>
<p><strong><em>有一些规则需要我们遵守</em></strong>：</p>
<ul>
<li><p>不要使用new Number()、new Boolean()、new String()创建包装对象；</p>
</li>
<li><p>用parseInt()或parseFloat()来转换任意类型到number；</p>
</li>
<li><p>用String()来转换任意类型到string，或者直接调用某个对象的toString()方法；</p>
</li>
<li><p>通常不必把任意类型转换为boolean再判断，因为可以直接写if (myVar) {…}；</p>
</li>
<li><p>typeof操作符可以判断出number、boolean、string、function和undefined；</p>
</li>
<li><p>判断Array要使用Array.isArray(arr)；</p>
</li>
<li><p>判断null请使用myVar === null；</p>
</li>
<li><p>判断某个全局变量是否存在用typeof window.myVar === ‘undefined’；</p>
</li>
<li><p>函数内部判断某个变量是否存在用typeof myVar === ‘undefined’。</p>
</li>
<li><p>number对象调用toString(),需要特殊处理：122..toString(); 或 (122).toString();</p>
</li>
</ul>
<h3 id="1-Date"><a href="#1-Date" class="headerlink" title="1. Date"></a>1. Date</h3><ol>
<li>时区<br>Date对象表示的时间总是按浏览器所在时区显示的，不过我们既可以显示本地时间，也可以显示调整后的UTC时间：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var d = new Date(1435146562875);</div><div class="line"></div><div class="line">d.toLocaleString(); // &apos;2015/6/24 下午7:49:22&apos;，本地时间（北京时区+8:00），显示的字符串与操作系统设定的格式有关</div><div class="line"></div><div class="line">d.toUTCString(); // &apos;Wed, 24 Jun 2015 11:49:22 GMT&apos;，UTC时间，与本地时间相差8小时</div></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/05/04/JavaScript学习/" data-id="cj6dowbmv00099otxldwe10p6" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-CRM" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/28/CRM/" class="article-date">
  <time datetime="2017-04-28T15:59:29.968Z" itemprop="datePublished">2017-04-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/28/CRM/">CRM</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： CRM</p>
<hr>
<h2 id="一-数据回显"><a href="#一-数据回显" class="headerlink" title="一  . 数据回显"></a>一  . 数据回显</h2><p>在查询了所有员工信息之后，需要增加编辑员工信息的功能。<br>编辑员工信息需要用到信息的回显，若需要回显员工的信息，需要得到该员工的id来唯一确定员工。<br>listStaff.jsp<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;s:a namespace="/" action="staffAction_editUI"&gt;</div><div class="line">	  		&lt;s:param name="staffId" value="staffId"&gt;&lt;/s:param&gt;</div><div class="line">	  		&lt;img src="$&#123;pageContext.request.contextPath&#125;/images/button/modify.gif" class="img" /&gt;</div><div class="line">&lt;/s:a&gt;</div></pre></td></tr></table></figure></p>
<p>上述为struts2的a标签来发送action，<code>&lt;s:param name=&quot;staffId&quot; value=&quot;staffId&quot;&gt;&lt;/s:param&gt;</code>相当于以get的形式添加到action后，即以类似于<code>action?staffId=</code>的形式完成信息传递。</p>
<p>staffAction.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editUI</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">//jsp中返回了一个get方法，封装到了staff对象中</span></div><div class="line">	CrmStaff findStaff = <span class="keyword">this</span>.staffService.findById(staff.getStaffId());</div><div class="line">	</div><div class="line">	ActionContext.getContext().getValueStack().push(findStaff);</div><div class="line">	</div><div class="line">	<span class="comment">//查询所有部门</span></div><div class="line">	List&lt;CrmDepartment&gt; allDepartment = departmentService.findAllDepartments();</div><div class="line">	<span class="comment">//存在栈顶，在数据回显的时候从栈顶照下来。因为底层使用的是findValue，会从栈顶先开始找，再找contextMap 。即使在栈顶找到了对象的key是null,也会回显</span></div><div class="line">	ActionContext.getContext().getValueStack().set(<span class="string">"allDepartment"</span>, allDepartment);</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> <span class="string">"editUI"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在staffAction.java中将findStaff放入栈顶。<br>在editStaff.jsp中，例如<code>&lt;s:textfield name=&quot;staffName&quot;&gt;</code>则可以完成信息的回显。struts2底层会调用findValue，先从root开始查询staffName,若为null，则向下contextMap中查询，若仍为null，则会返回空。</p>
<h3 id="checkbox-select-radio标签的使用"><a href="#checkbox-select-radio标签的使用" class="headerlink" title="checkbox \ select \ radio标签的使用"></a>checkbox \ select \ radio标签的使用</h3><p>三者本身都需要有数据。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">   &lt;td&gt;</div><div class="line">   	&lt;s:radio list="&#123;'男','女'&#125;" name="gender"&gt;&lt;/s:radio&gt;</div><div class="line">   &lt;/td&gt;</div><div class="line"> &lt;/tr&gt;</div><div class="line">&lt;tr&gt;</div><div class="line">   &lt;td width="10%"&gt;所属部门：&lt;/td&gt;</div><div class="line">   &lt;td width="20%"&gt;</div><div class="line">   	&lt;s:select list="allDepartment" name="post.department.depId"</div><div class="line">					listKey="depId" listValue="depName"</div><div class="line">					headerKey=""	headerValue="----请选择----"  	    	</div><div class="line">   	&gt;&lt;/s:select&gt;</div><div class="line">   &lt;/td&gt;</div><div class="line">   &lt;td width="8%"&gt;职务：&lt;/td&gt;</div><div class="line">   &lt;td width="62%"&gt;</div><div class="line">   	&lt;s:select list="post != null ? post.department.postSet : &#123;&#125;" name="post.postId"</div><div class="line">					listKey="postId" listValue="postName"</div><div class="line">					headerKey=""	headerValue="----请选择----"	    	</div><div class="line">   	&gt;&lt;/s:select&gt;</div><div class="line">   &lt;/td&gt;</div><div class="line"> &lt;/tr&gt;</div><div class="line"> &lt;tr&gt;</div><div class="line">   &lt;td width="10%"&gt;入职时间：&lt;/td&gt;</div><div class="line">   &lt;td width="20%"&gt;</div><div class="line">   	&lt;s:date name="onDutyDate" format="yyyy-MM-dd" var="myDate"/&gt;</div><div class="line">   	&lt;s:textfield name="onDutyDate" readonly="true" value="%&#123;#myDate&#125;" onfocus="c.showMoreDay=true; c.show(this);"&gt;&lt;/s:textfield&gt;</div><div class="line">   &lt;/td&gt;</div></pre></td></tr></table></figure></p>
<p>对于所属部门：</p>
<p>list中的allDepartment，是在StaffAction中存入root中，完成了查询所有部门的功能，其本身返回的是对象。</p>
<p>其中list表示的是下拉菜单中所有的内容，但此时里面是对象（包括map、javaBean）,因此需要listKey和listValue辅助来完成下拉菜单的显示。</p>
<p>listKey:数据源中元素对象的属性, 用于获取选项的值，对应于select标签中的value。<br>listValue:数据源中元素对象的属性, 用于获取选项的文本内容，对应于select标签中的option。<br>name:完成数据回显，同之前标签的name，从值栈中寻找值，利用listKey来匹配。</p>
<p>但是，下拉菜单中仍存在一定的问题，所属部门和职务应该是存在约束关系的，即选定了所属部门，在职务的菜单中应该只显示该部门中的职务。由此，引申出了<strong><em>ajax二级联动</em></strong>的概念</p>
<h2 id="二-ajax二级联动"><a href="#二-ajax二级联动" class="headerlink" title="二 . ajax二级联动"></a>二 . ajax二级联动</h2><p>ajax需要浏览器和服务器的交互来完成功能。浏览器端先发送<strong>参数</strong>和<strong>路径</strong>至服务器端。在服务器端，利用action来完成将javaBean转换成json数据的处理，再将json数据回调给浏览器。在浏览器端接收到json数据并处理。</p>
<p>浏览器端</p>
<ol>
<li>先获得需要获得的属性，即部门ID；</li>
<li>发送ajax,通过部门查询职务<br>—-2.1 获得引擎（复制）<br>—-2.2 设置回调函数<br>———3 获得数据，并展示 ,手动ajax 获得 json数据 字符串<br>—-2.3 创建连接<br>—-2.4 发送请求</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">&lt;script type="text/javascript"&gt;</div><div class="line">		function showPost(obj)&#123;</div><div class="line">			//1 获得选中部门</div><div class="line">			var depId = obj.value;</div><div class="line">			//2 发送ajax，通过部门查询职务</div><div class="line">			//2.1 获得引擎</div><div class="line">			var xmlhttp=null;</div><div class="line">			if (window.XMLHttpRequest)&#123;// code for all new browsers</div><div class="line">			  xmlhttp=new XMLHttpRequest();</div><div class="line">			&#125; else if (window.ActiveXObject) &#123;// code for IE5 and IE6</div><div class="line">			  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			//2.2 设置回调函数</div><div class="line">			xmlhttp.onreadystatechange = function()&#123;</div><div class="line">				//请求完成，正常响应</div><div class="line">				if(xmlhttp.readyState == 4 &amp;&amp; xmlhttp.status == 200)&#123;</div><div class="line">					//3 获得数据，并展示 ,手动ajax 获得 json数据 字符串</div><div class="line">					var textData = xmlhttp.responseText;</div><div class="line">					//3.1 将字符串 手动 转换 json对象</div><div class="line">					var jsonData = eval("("+textData+")");</div><div class="line">					</div><div class="line">					// 获得select对象</div><div class="line">					var postSelectElement = document.getElementById("postSelectId");</div><div class="line">					postSelectElement.innerHTML = "&lt;option value=''&gt;----请--选--择----&lt;/option&gt;";</div><div class="line">					</div><div class="line">					//3.2 遍历</div><div class="line">					for(var i = 0 ; i &lt; jsonData.length ; i++)&#123;</div><div class="line">						var postObj = jsonData[i];</div><div class="line">						// 获得职务id</div><div class="line">						var postId = postObj.postId;</div><div class="line">						// 获得职务名称</div><div class="line">						var postName = postObj.postName;</div><div class="line">						</div><div class="line">						//3.3 将数显示到select标签</div><div class="line">						postSelectElement.innerHTML += "&lt;option value='"+postId+"'&gt;"+postName+"&lt;/option&gt;";</div><div class="line">					&#125;</div><div class="line">					</div><div class="line">				&#125;</div><div class="line">			&#125;;</div><div class="line">			//2.3 创建连接</div><div class="line">			var url = "$&#123;pageContext.request.contextPath&#125;/postAction_findAllWithDepartment?department.depId=" + depId;</div><div class="line">			xmlhttp.open("GET", url);</div><div class="line">			//2.4 发送请求</div><div class="line">			xmlhttp.send(null);</div><div class="line">		&#125;</div><div class="line">	&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>服务器端</p>
<p>在服务器端需要做的就是处理浏览器发送过来的java对象，并将其转换成为json数据。</p>
<p>需要注意的是，在使用JsonConfig时，需要将不需要的数据排除在外。何为不需要的数据？当要将allPost转换为json数据时，CrmPost对象中有staffSet和department对象，而两者中又有其他的对象，从而会造成使计算机造成死循环，不断调用。<br>因此，使用<strong>setExcludes</strong>将不要的数据排除。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PostAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> <span class="keyword">implements</span> <span class="title">ModelDriven</span>&lt;<span class="title">CrmPost</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> CrmPost post = <span class="keyword">new</span> CrmPost();</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> CrmPost <span class="title">getModel</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> post;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> PostService postService ;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPostService</span><span class="params">(PostService postService)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.postService = postService;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line"></div><div class="line">	<span class="comment">//-------------------------------------------------------------------------------------</span></div><div class="line">	</div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * ajax通过部门查询所有职务</div><div class="line">	 * <span class="doctag">@return</span></div><div class="line">	 * <span class="doctag">@throws</span> Exception </div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">findAllWithDepartment</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		</div><div class="line">		List&lt;CrmPost&gt; allPost = <span class="keyword">this</span>.postService.findAllPost(post.getDepartment());</div><div class="line">		</div><div class="line">		<span class="comment">//2 将java对象 转换 json数据</span></div><div class="line">		</div><div class="line">		<span class="comment">//2.1 将不需要的数据排除在外</span></div><div class="line">		JsonConfig jsonConfig =  <span class="keyword">new</span> JsonConfig();</div><div class="line">		jsonConfig.setExcludes(<span class="keyword">new</span> String[]&#123;<span class="string">"staffSet"</span>,<span class="string">"department"</span>&#125;);</div><div class="line">		<span class="comment">//2.2 完成转换</span></div><div class="line">		String jsonData = JSONArray.fromObject(allPost, jsonConfig).toString();</div><div class="line">		<span class="comment">//3.将json数据发送给浏览器</span></div><div class="line">		</div><div class="line">		<span class="comment">//3.1 设置编码，放置中文乱码 </span></div><div class="line">		ServletActionContext.getResponse().setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</div><div class="line">		<span class="comment">//3.2发送</span></div><div class="line">		ServletActionContext.getResponse().getWriter().print(jsonData);</div><div class="line">		<span class="keyword">return</span> <span class="string">"none"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="三-提交编辑过的表单"><a href="#三-提交编辑过的表单" class="headerlink" title="三 . 提交编辑过的表单"></a>三 . 提交编辑过的表单</h2><p>在表单提交的时候需要隐藏地提交Id,以唯一确定员工。<br><code>&lt;s:hidden name=&quot;staffId&quot; value=&quot;%{staffId}&quot; /&gt;</code>和<code>&lt;s:hidden name=&quot;staffId&quot;/&gt;</code>均可以实现。</p>
<p>添加javascript click事件，提交表单<br>获得文档document,然后得到所有的表单forms,选中第一个，提交。<br>javascript:void(0)阻止href跳转。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;javascript:void(0)&quot; onclick=&quot;document.forms[0].submit()&quot;&gt;</div><div class="line">      &lt;img src=&quot;$&#123;pageContext.request.contextPath&#125;/images/button/save.gif&quot; /&gt;</div><div class="line">&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<h3 id="service层"><a href="#service层" class="headerlink" title="service层"></a>service层</h3><p>更新员工信息，需要考虑到该表单中的每一个属性。</p>
<h2 id="四-条件查询"><a href="#四-条件查询" class="headerlink" title="四 . 条件查询"></a>四 . 条件查询</h2><p><strong>首先，需要过滤不需要的（null 或 “” 或 “ “）</strong></p>
<p>在PO类中添加查询条件字段，来接受客户端传过来的查询条件。一般查询条件都是字符串，因为浏览器都是字符串。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/28/CRM/" data-id="cj6dowblt00009otxxe86p1uq" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-SVN" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/18/SVN/" class="article-date">
  <time datetime="2017-04-18T13:52:53.338Z" itemprop="datePublished">2017-04-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/18/SVN/">SVN</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： SVN</p>
<hr>
<p>版本控制（Revision Control）：是维护工程蓝图的标准做法，能追踪工程蓝图从诞生一直到定案的过程。是一种记录若干文件内容变化，以便将来查阅特定版本修订情况的系统。</p>
<h2 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h2><p>在硬盘中创建一个空的文件夹，如F:\repository\svn\repo1<br>在cmd窗口中可以完成创建仓库操作，包括在指定目录创建仓库和当前目录创建仓库。<br>指定目录创建：svnadmin create F:\repository\svn\repo1<br>当前目录创建：svnadmin create .</p>
<h2 id="启动仓库"><a href="#启动仓库" class="headerlink" title="启动仓库"></a>启动仓库</h2><ul>
<li><p>多仓库<br>cmd &gt; svnserve -d -r F:\repository\svn<br>要访问某一特定的仓库：svn://localhost:3690/repo1</p>
</li>
<li><p>单仓库<br>cmd &gt; svnserve -d -r F:\repository\svn\repo1<br>此时只能访问该已经启动的仓库repo1：svn://localhost:3690</p>
</li>
</ul>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><h3 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a><strong>checkout</strong></h3><p>svn checkout svn://localhost:3690/repo1</p>
<h3 id="commit"><a href="#commit" class="headerlink" title="commit"></a><strong>commit</strong></h3><p>commit需要有权限，需要修改仓库目录中conf\svnserve.conf的配置</p>
<ul>
<li>将<code># anon-access = read</code>修改为<code>anon-access = write</code></li>
<li>使用add子命令添加到本地版本库</li>
</ul>
<p>然后执行语句：<br><code>svn commit -m &quot;user1 add content&quot; test.txt</code><br>其中，语句中包括了-m设置日志信息</p>
<h3 id="update"><a href="#update" class="headerlink" title="update"></a><strong>update</strong></h3><p><strong><em>在每次提交版本之前先执行更新操作</em></strong><br><code>svn update</code></p>
<h2 id="目录规范"><a href="#目录规范" class="headerlink" title="目录规范"></a>目录规范</h2><ul>
<li>trunk 主线 ， 用于存在程序整个进度</li>
<li>branches 分支 ， 例如bug修复、特殊功能</li>
<li>tags 标签（版本） ， 此目录下的内容不能修改 </li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/18/SVN/" data-id="cj6dowbnf000l9otxarste7vv" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-spring框架学习三" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/16/spring框架学习三/" class="article-date">
  <time datetime="2017-04-16T13:52:46.238Z" itemprop="datePublished">2017-04-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/16/spring框架学习三/">spring框架学习三</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： spring 事务</p>
<hr>
<h2 id="一-spring事务管理"><a href="#一-spring事务管理" class="headerlink" title="一.spring事务管理"></a>一.spring事务管理</h2><h3 id="1-1-事务"><a href="#1-1-事务" class="headerlink" title="1.1 事务"></a>1.1 事务</h3><ul>
<li><p>事务：一组业务操作ABCD，要么全部成功，要么全部不成功。</p>
</li>
<li><p>特性：ACID<br>  原子性：整体<br>  一致性：完成<br>  隔离性：并发<br>  持久性：结果</p>
</li>
<li><p>隔离问题：<br>  脏读：一个事务读到另一个事务没有提交的数据<br>  不可重复读：一个事务读到另一个事务已提交的数据（update）<br>  虚读(幻读)：一个事务读到另一个事务已提交的数据（insert）</p>
</li>
<li><p>隔离级别：<br>  read uncommitted：读未提交。存在3个问题<br>  read committed：读已提交。解决脏读，存在2个问题<br>  repeatable read：可重复读。解决：脏读、不可重复读，存在1个问题。<br>  serializable ：串行化。都解决，单事务。</p>
</li>
</ul>
<h3 id="1-2-mysql事务操作"><a href="#1-2-mysql事务操作" class="headerlink" title="1.2 mysql事务操作"></a>1.2 mysql事务操作</h3><ul>
<li><p>简单操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ABCD 一个事务</span></div><div class="line">Connection conn = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">  <span class="comment">//1 获得连接</span></div><div class="line">  conn = ...;</div><div class="line">  <span class="comment">//2 开启事务</span></div><div class="line">  conn.setAutoCommit(<span class="keyword">false</span>);</div><div class="line">  A</div><div class="line">  B</div><div class="line">  C</div><div class="line">  D</div><div class="line">  <span class="comment">//3 提交事务</span></div><div class="line">  conn.commit();</div><div class="line">&#125; <span class="keyword">catch</span>()&#123;</div><div class="line">  <span class="comment">//4 回滚事务</span></div><div class="line">  conn.rollback();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Savepoint</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">需求：AB（必须），CD（可选） </div><div class="line">Connection conn = <span class="keyword">null</span>;</div><div class="line">Savepoint savepoint = <span class="keyword">null</span>;  <span class="comment">//保存点，记录操作的当前位置，之后可以回滚到指定的位置。（可以回滚一部分）</span></div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">  <span class="comment">//1 获得连接</span></div><div class="line">  conn = ...;</div><div class="line">  <span class="comment">//2 开启事务</span></div><div class="line">  conn.setAutoCommit(<span class="keyword">false</span>);</div><div class="line">  A</div><div class="line">  B</div><div class="line">  savepoint = conn.setSavepoint();</div><div class="line">  C</div><div class="line">  D</div><div class="line">  <span class="comment">//3 提交事务</span></div><div class="line">  conn.commit();</div><div class="line">&#125; <span class="keyword">catch</span>()&#123;</div><div class="line">     <span class="comment">// 回滚到CD之前</span></div><div class="line">     conn.rollback(savepoint);</div><div class="line">     <span class="comment">// 提交AB</span></div><div class="line">     conn.commit();</div><div class="line">  &#125; <span class="keyword">else</span>&#123;   <span class="comment">//AB异常</span></div><div class="line">     <span class="comment">// 回滚AB</span></div><div class="line">     conn.rollback();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="1-3-spring事务————管理器和状态"><a href="#1-3-spring事务————管理器和状态" class="headerlink" title="1.3 spring事务————管理器和状态"></a>1.3 spring事务————管理器和状态</h3><ul>
<li><p>导入jar包<br>transaction —&gt; tx</p>
</li>
<li><p>三个顶级接口</p>
</li>
</ul>
<ul>
<li><p>常见的事务管理器<br><strong><em>DataSourceTransactionManager</em></strong>：jdbc开发时事务管理器，采用JdbcTemplate<br><strong><em>HibernateTransactionManager</em></strong>：hibernate开发时事务管理器，整合hibernate</p>
</li>
<li><p>api详解<br>TransactionStatus getTransaction(TransactionDefinition definition) ，事务管理器 通过“事务详情”，获得“事务状态”，从而管理事务。<br>void commit(TransactionStatus status)  根据状态提交<br>void rollback(TransactionStatus status) 根据状态回滚</p>
</li>
<li><p>TransactionStatus</p>
</li>
<li><p><strong><em>事务详情TransactionDefinition</em></strong></p>
</li>
</ul>
<h2 id="二-案例"><a href="#二-案例" class="headerlink" title="二.案例"></a>二.案例</h2><h3 id="2-1-AOP配置基于XML"><a href="#2-1-AOP配置基于XML" class="headerlink" title="2.1 AOP配置基于XML"></a>2.1 AOP配置基于XML</h3><p><strong>在spring xml 配置aop 自动生成代理，进行事务的管理</strong></p>
<p>AccountDao.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AccountDao</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(String outer , Integer money)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">(String inner , Integer money)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>AccountDaoImpl.java<br><strong><em>继承JdbcDaoSupport</em></strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//继承了JdbcDaoSupport</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImpl</span> <span class="keyword">extends</span> <span class="title">JdbcDaoSupport</span> <span class="keyword">implements</span> <span class="title">AccountDao</span> </span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(String outer, Integer money)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money - ? where username = ?"</span> , money , outer);</div><div class="line">	&#125;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">(String inner, Integer money)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money - ? where username = ?"</span> , money , inner);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>AccountService.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AccountService</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outer , String inner , Integer money)</span></span>;</div></pre></td></tr></table></figure></p>
<p>AccountServiceImpl.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">AccountService</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> AccountDao accountDao;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccountDao</span><span class="params">(AccountDao accountDao)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.accountDao = accountDao;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outer, String inner, Integer money)</span> </span>&#123;</div><div class="line">		accountDao.out(outer, money);</div><div class="line">		accountDao.in(inner, money);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>applicationContext.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></div><div class="line">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></div><div class="line">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">       					   http://www.springframework.org/schema/beans/spring-beans.xsd</div><div class="line">       					   http://www.springframework.org/schema/aop </div><div class="line">       					   http://www.springframework.org/schema/aop/spring-aop.xsd</div><div class="line">       					   http://www.springframework.org/schema/context </div><div class="line">       					   http://www.springframework.org/schema/context/spring-context.xsd</div><div class="line">       					   http://www.springframework.org/schema/tx </div><div class="line">       					   http://www.springframework.org/schema/tx/spring-tx.xsd"&gt;</div><div class="line"><span class="comment">&lt;!-- 配置的顺序：</span></div><div class="line">	1.datasource</div><div class="line">	2.dao</div><div class="line">	3.service</div><div class="line">	4.事务管理&#123;</div><div class="line">		</div><div class="line">		4.1 事务管理器</div><div class="line">		4.2 事务详情</div><div class="line">		4.3 aop编程</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"> --&gt;</div><div class="line"> 	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql:///day0301"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"> 	</div><div class="line"> 	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.yao.dao.impl.AccountDaoImpl"</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">  </div><div class="line"> 	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.yao.service.impl.AccountServiceImpl"</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"> 	</div><div class="line"> 	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> 	</div><div class="line"> 	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"> 	</div><div class="line"> 	<span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"txManager"</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></div><div class="line"> 			<span class="comment">&lt;!-- name可以写成类似 name="add*" ， 这样要在service中的方法以add开头--&gt;</span></div><div class="line"> 			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"transfer"</span> <span class="attr">isolation</span>=<span class="string">"DEFAULT"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></div><div class="line"> 		<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></div><div class="line"> 	</div><div class="line"> 	<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txManager"</span> <span class="attr">pointcut</span>=<span class="string">"execution(* com.yao.service..*.*(..))"</span>/&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></div></pre></td></tr></table></figure></p>
<hr>
<h3 id="2-2-AOP配置基于注释"><a href="#2-2-AOP配置基于注释" class="headerlink" title="2.2 AOP配置基于注释"></a>2.2 AOP配置基于注释</h3><p><strong>1. 配置事务管理器，将并事务管理器交予spring</strong><br><strong>2. 在目标类或目标方法添加注解即可@Transactional</strong></p>
<p>Dao接口和实现类没有变化，与使用XML配置时相同。</p>
<p>AccountService.java没有变化。</p>
<p>AccountServiceImpl.java<br><strong>添加了注释</strong><br>`transactional() 并且可以在注释中添加配置事务详情</p>
<p>此时需要使用业务管理的方法上添加注释或；或者在类上添加注释，这样整个类中的方法都添加了事务。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED,isolation = Isolation.DEFAULT)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">AccountService</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> AccountDao accountDao;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccountDao</span><span class="params">(AccountDao accountDao)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.accountDao = accountDao;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outer, String inner, Integer money)</span> </span>&#123;</div><div class="line">		accountDao.out(outer, money);</div><div class="line">		<span class="comment">//int i = 1/0;</span></div><div class="line">		accountDao.in(inner, money);</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>applicationContext.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></div><div class="line">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></div><div class="line">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">       					   http://www.springframework.org/schema/beans/spring-beans.xsd</div><div class="line">       					   http://www.springframework.org/schema/aop </div><div class="line">       					   http://www.springframework.org/schema/aop/spring-aop.xsd</div><div class="line">       					   http://www.springframework.org/schema/context </div><div class="line">       					   http://www.springframework.org/schema/context/spring-context.xsd</div><div class="line">       					   http://www.springframework.org/schema/tx </div><div class="line">       					   http://www.springframework.org/schema/tx/spring-tx.xsd"&gt;</div><div class="line"><span class="comment">&lt;!-- 配置的顺序：</span></div><div class="line">	1.datasource</div><div class="line">	2.dao</div><div class="line">	3.service</div><div class="line">	4.事务管理交给spring&#123;</div><div class="line">	    4.1 配置事务管理器</div><div class="line">	    （可以选择使用试用cglib代理）</div><div class="line">	&#125;</div><div class="line"> --&gt;</div><div class="line"> 	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql:///day0301"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"> 	</div><div class="line"> 	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.yao.dao.impl.AccountDaoImpl"</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">  </div><div class="line"> </div><div class="line"> 	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.yao.service.impl.AccountServiceImpl"</span>&gt;</span></div><div class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"> 	</div><div class="line"> 	</div><div class="line"> 	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> 	</div><div class="line"> 	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"> 	</div><div class="line"> 	<span class="comment">&lt;!-- 4.2 将管理器交予spring </span></div><div class="line">		* transaction-manager 配置事务管理器</div><div class="line">		* proxy-target-class</div><div class="line">			true ： 底层强制使用cglib 代理</div><div class="line">	--&gt;</div><div class="line"> 	<span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">proxy-target-class</span>=<span class="string">"true"</span> <span class="attr">transaction-manager</span>=<span class="string">"txManager"</span>/&gt;</span></div><div class="line"> 	</div><div class="line"> 	<span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure></p>
<hr>
<h3 id="2-3-Junit"><a href="#2-3-Junit" class="headerlink" title="2.3 Junit"></a>2.3 Junit</h3><ol>
<li>Runwith()</li>
<li>contextConfiguration</li>
<li>Autowired</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@ContextConfiguration</span>(locations=<span class="string">"classpath:applicationContext.xml"</span>)</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestDemo</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="meta">@Autowired</span></div><div class="line">	<span class="keyword">private</span> AccountService accountService;</div><div class="line">	</div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo1</span><span class="params">()</span></span>&#123;</div><div class="line">		</div><div class="line">		</div><div class="line"><span class="comment">//		String xmlPath = "applicationContext.xml";</span></div><div class="line"><span class="comment">//		ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);</span></div><div class="line"><span class="comment">//		AccountService accountService = (AccountService) applicationContext.getBean("accountService");</span></div><div class="line">		accountService.transfer(<span class="string">"abc"</span>,<span class="string">"eee"</span>,<span class="number">140</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="三-SSH整合"><a href="#三-SSH整合" class="headerlink" title="三.SSH整合"></a>三.SSH整合</h2><h3 id="3-1-jar包整合"><a href="#3-1-jar包整合" class="headerlink" title="3.1 jar包整合"></a>3.1 jar包整合</h3><hr>
<h3 id="3-2-spring整合hibernate-—–-有hibernate-cfg-xml"><a href="#3-2-spring整合hibernate-—–-有hibernate-cfg-xml" class="headerlink" title="3.2 spring整合hibernate —– 有hibernate.cfg.xml"></a>3.2 spring整合hibernate —– 有hibernate.cfg.xml</h3><h4 id="3-2-1-创建表"><a href="#3-2-1-创建表" class="headerlink" title="3.2.1 创建表"></a>3.2.1 创建表</h4><h4 id="3-2-2-PO类"><a href="#3-2-2-PO类" class="headerlink" title="3.2.2 PO类"></a>3.2.2 PO类</h4><p>javaBean and hbm.xml</p>
<h4 id="3-2-3-dao层"><a href="#3-2-3-dao层" class="headerlink" title="3.2.3 dao层"></a>3.2.3 dao层</h4><p>spring提供HibernateTemplate用于操作PO对象，类似Hibernate Session对象</p>
<h4 id="3-2-4-service层"><a href="#3-2-4-service层" class="headerlink" title="3.2.4 service层"></a>3.2.4 service层</h4><h4 id="3-2-5-Hibernate-cfg-xml"><a href="#3-2-5-Hibernate-cfg-xml" class="headerlink" title="3.2.5 Hibernate.cfg.xml"></a>3.2.5 Hibernate.cfg.xml</h4><h4 id="3-2-6-applicationContext-xml"><a href="#3-2-6-applicationContext-xml" class="headerlink" title="3.2.6 applicationContext.xml"></a>3.2.6 applicationContext.xml</h4><hr>
<h3 id="3-3-spring整合hibernate-—–-无hibernate-cfg-xml"><a href="#3-3-spring整合hibernate-—–-无hibernate-cfg-xml" class="headerlink" title="3.3 spring整合hibernate —– 无hibernate.cfg.xml"></a>3.3 spring整合hibernate —– 无hibernate.cfg.xml</h3><p>删除hibernate.cfg.xml ， 但需要保存文件内容，将其配置spring中</p>
<p>修改dao层，继承hibernateDaoSupport</p>
<hr>
<h3 id="3-4-struts整合spring-—–-spring创建action"><a href="#3-4-struts整合spring-—–-spring创建action" class="headerlink" title="3.4 struts整合spring —– spring创建action"></a>3.4 struts整合spring —– spring创建action</h3><ol>
<li>编写action,并将action配置给spring,spring可以注入service</li>
<li>编写strut.xml</li>
<li>jsp页面</li>
<li>web.xml配置<ul>
<li>确定未知文件contextConfigLocation</li>
<li>配置监听器ContextLoaderListener</li>
<li>配置前端控制器StrutsPrepareAndExecuteFilter</li>
</ul>
</li>
</ol>
<hr>
<h3 id="3-4-struts整合spring-—–-struts创建action"><a href="#3-4-struts整合spring-—–-struts创建action" class="headerlink" title="3.4 struts整合spring —– struts创建action"></a>3.4 struts整合spring —– struts创建action</h3><h4 id="实例-SSH整合"><a href="#实例-SSH整合" class="headerlink" title="实例 SSH整合"></a><strong><em>实例 SSH整合</em></strong></h4><ul>
<li>spring整合hibernate,无hibernate.cfg.xml</li>
<li>spring整合struts,struts创建action</li>
</ul>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/16/spring框架学习三/" data-id="cj6dowbnj000p9otx2ne3623j" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Spring框架学习一" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/06/Spring框架学习一/" class="article-date">
  <time datetime="2017-04-06T09:10:57.541Z" itemprop="datePublished">2017-04-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<h2 id="title-Spring框架学习一"><a href="#title-Spring框架学习一" class="headerlink" title="title : Spring框架学习一"></a>title : Spring框架学习一</h2><p>标签 ： Spring</p>
<hr>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>spring是J2EE应用程序框架，是轻量级的IoC和AOP的容器框架，主要是针对JavaBean的生命周期进行管理的轻量级容器。</p>
<p>spring的Core包括四个部分：bean core context expression<br>这是spring中重要的部分</p>
<h2 id="一-IoC"><a href="#一-IoC" class="headerlink" title="一 . IoC"></a>一 . IoC</h2><p>下面我们来通过一个简单的IoC案例来对其有一个初步的了解。</p>
<h4 id="1-导入jar包"><a href="#1-导入jar包" class="headerlink" title="1. 导入jar包"></a>1. 导入jar包</h4><h4 id="2-目标类"><a href="#2-目标类" class="headerlink" title="2. 目标类"></a>2. 目标类</h4><pre><code>1. 提供UserService接口和实现类

2. 获得UserService实现类的实例
</code></pre><p>现在由spring来创建实例对象，即不再是由开发者来new对象，这就是IoC控制反转（Inverse of Control）。此后需要实例对象时，从spring工厂（容器）中获得，需要将实现类的全限定名称配置到xml中。</p>
<p>UserService.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>UserServiceImpl.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"a_IoC add User"</span>);</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h4 id="3-配置文件"><a href="#3-配置文件" class="headerlink" title="3. 配置文件"></a>3. 配置文件</h4><p>配置文件的位置： 任意位置，但是在开发中一般在classpath下<br>配置文件的名称： 任意名称，但是在开发中常用applicationContext.xml\<br>配置文件的内容： 添加schema约束，约束文件的位置 —- spring-framework-3.2.0.RELEASE-dist\spring-framework-3.2.0.RELEASE\docs\spring-framework-reference\html\xsd-config.html</p>
<p>applicationContext.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">						   http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;</div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 配置service --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- &lt;bean&gt;配置需要创建的对象</span></div><div class="line">	        id:用于之后从spring容器获得实例时使用</div><div class="line">	        class:需要创建实例的全限定类名&gt;</div><div class="line">	        </div><div class="line">	&lt;bean id="UserService" class="com.yao.a_IoC.UserServiceImpl"&gt;&lt;/bean&gt;</div><div class="line">&lt;/beans&gt;</div></pre></td></tr></table></figure>
<h4 id="4-测试"><a href="#4-测试" class="headerlink" title="4. 测试"></a>4. 测试</h4><p>test.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo1</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="comment">//之前开发</span></div><div class="line">		<span class="comment">/*UserService userService = new UserServiceImpl();</span></div><div class="line">		userService.addUser();*/</div><div class="line">		</div><div class="line">		<span class="comment">//从spring容器中获得</span></div><div class="line">		<span class="comment">//获得容器</span></div><div class="line">		String xmlPath = <span class="string">"com/yao/a_IoC/applicationContext.xml"</span>; </div><div class="line">		org.springframework.context.ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</div><div class="line">		<span class="comment">//获得内容-----不需要new，都是从spring容器中获得</span></div><div class="line">		UserService userService = (UserService) applicationContext.getBean(<span class="string">"UserService"</span>);</div><div class="line">		userService.addUser();</div><div class="line">		</div><div class="line">		</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h2 id="二-DI"><a href="#二-DI" class="headerlink" title="二 . DI"></a>二 . DI</h2><p>依赖 ： 一个对象需要使用另一个对象<br>注入 ： 通过setter方法进行另一个对象实例设置</p>
<p>模拟sprig执行过程:</p>
<ul>
<li>创建service实例：UserService userService = new UserServiceImpl();   //IoC  <bean></bean></li>
<li>创建dao实例：UserDao userDao = new UserDaoImpl();                   //IoC</li>
<li>将dao设置给service：userService.setUserDao(userDao);                //DI   <property></property></li>
</ul>
<p>spring中service实现类使用dao接口，但是不知道具体的实现类</p>
<ul>
<li>private UserDao userDao;</li>
<li>setter方法</li>
</ul>
<h4 id="1-目标类"><a href="#1-目标类" class="headerlink" title="1.目标类"></a>1.目标类</h4><p>创建Service接口和实现类<br>创建Dao接口和实现类<br>将dao和service配置到xml中<br>使用api测试</p>
<ul>
<li>dao</li>
</ul>
<p>UserDao.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>UserDaoImpl.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</div><div class="line">			System.out.println(<span class="string">"DI ADD USER"</span>);</div><div class="line">		&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>service</li>
</ul>
<p>UserService.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>UserServiceImpl.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</div><div class="line">	<span class="comment">//之前的方式：UserDao userDao = new UserDaoImpl();</span></div><div class="line">	<span class="keyword">private</span> UserDao userDao;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span></span>&#123;</div><div class="line">		<span class="keyword">this</span>.userDao = userDao;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">this</span>.userDao.save();</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<h4 id="2-配置文件"><a href="#2-配置文件" class="headerlink" title="2.配置文件"></a>2.配置文件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">						   http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;</div><div class="line"><span class="comment">&lt;!-- 模拟sprig执行过程:</span></div><div class="line">- 创建service实例：UserService userService = new UserServiceImpl();   //IoC  &lt;bean&gt;</div><div class="line">- 创建dao实例：UserDao userDao = new UserDaoImpl();                   //IoC</div><div class="line">- 将dao设置给service：userService.setUserDao(userDao);                //DI   &lt;property&gt;</div><div class="line">	 </div><div class="line">	 &lt;property&gt; 用于进行属性注入</div><div class="line">	 		name  bena的属性名，通过setter方法来获得</div><div class="line">	 		ref   另一个bean的id值的引用</div><div class="line">	 --&gt;</div><div class="line">	 <span class="comment">&lt;!-- 创建service --&gt;</span></div><div class="line">	 <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"com.yao.b_DI.UserServiceImpl"</span>&gt;</span></div><div class="line">	 	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userDao"</span> <span class="attr">ref</span>=<span class="string">"userDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	 <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	 <span class="comment">&lt;!-- 创建dao --&gt;</span></div><div class="line">	 <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userDao"</span> <span class="attr">class</span>=<span class="string">"com.yao.b_DI.UserDaoImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"> <span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="3-测试"><a href="#3-测试" class="headerlink" title="3.测试"></a>3.测试</h4><h2 id="三-核心API"><a href="#三-核心API" class="headerlink" title="三 . 核心API"></a>三 . 核心API</h2><ul>
<li>BeanFactory<br>这是一个工厂，用于生成任意bean。采用延时加载，第一次getBean时才会进行初始化Bean。</li>
<li><p>ApplicationContext<br>是BeanFactory的子接口，功能更强大。配置文件一加载，对象就实例化。</p>
<p>  <strong>ClassPathXmlApplicationContext</strong>用于加载classpath(类路径、src)下的指定的xml。<br>加载xml运行时位置—&gt;/WEB-INF/classes/…xml</p>
<p>  <strong>FileSystemXmlApplication</strong>用于加载指定盘符下的xml<br>加载xml运行时位置—&gt;/WEB-INF/…xml </p>
</li>
</ul>
<h2 id="四-装配Bean基于XML"><a href="#四-装配Bean基于XML" class="headerlink" title="四 . 装配Bean基于XML"></a>四 . 装配Bean基于XML</h2><h3 id="实例化方式"><a href="#实例化方式" class="headerlink" title="实例化方式"></a>实例化方式</h3><p>3中实例化方式：<strong>默认构造</strong>、<strong>静态工厂</strong>、<strong>实例工厂</strong></p>
<h4 id="1-默认构造"><a href="#1-默认构造" class="headerlink" title="1. 默认构造"></a>1. 默认构造</h4><p><code>&lt;bean id=&quot;&quot; class=&quot;&quot;&gt;</code> 必须提供默认构造</p>
<h4 id="2-静态工厂"><a href="#2-静态工厂" class="headerlink" title="2. 静态工厂"></a>2. 静态工厂</h4><p>常用于spring整合其他框架（工具）<br>静态工厂：用于生产实例对象，所有的方法必须是static的<br><code>&lt;bean id=&quot;&quot; class=&quot;工厂全限定类名&quot; factory-method=&quot;静态方法&quot;&gt;</code></p>
<p><strong>实例：</strong><br>创建UserService.java and UserServiceImpl.java</p>
<p>工厂类MyBeanFactory.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UserService <span class="title">createService</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> UserServiceImpl();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>spring配置文件applicationContext.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">						   http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;</div><div class="line">	<span class="comment">&lt;!-- 将静态工厂创建的实例交予spring --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"com.yao.c_inject.b_static_factory.MyBeanFactory"</span> <span class="attr">factory-method</span>=<span class="string">"createService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
<p>测试类TestStaticFactory.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestStaticFactory</span> </span>&#123;</div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo1</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="comment">//自定义工厂</span></div><div class="line">		UserService userService = MyBeanFactory.createService();</div><div class="line">		userService.addUser();</div><div class="line">	&#125;</div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo2</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="comment">//自定义工厂</span></div><div class="line">		String xmlPath = <span class="string">"com/yao/c_inject/b_static_factory/applicationContext.xml"</span>; </div><div class="line">		org.springframework.context.ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</div><div class="line">		<span class="comment">//获得内容-----不需要new，都是从spring容器中获得</span></div><div class="line">		UserService userService = applicationContext.getBean(<span class="string">"userService"</span>,UserService.class);</div><div class="line">		userService.addUser();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="3-实例工厂"><a href="#3-实例工厂" class="headerlink" title="3. 实例工厂"></a>3. 实例工厂</h4><p>必须先有工厂实例，通过实例对象创建对象。提供所有的方法都是<strong>“非静态”</strong>的。</p>
<p><strong>实例：</strong><br>创建UserService.java and UserServiceImpl.java</p>
<p>工厂类MyBeanFactory.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> UserService <span class="title">createService</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> UserServiceImpl();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>spring配置文件applicationContext.xml<br>在配置时，可以对象测试类的demo1()来对应着完成配置。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">						   http://www.springframework.org/schema/beans/spring-beans.xsd "&gt;</div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 创建工厂实例 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myBeanFactory"</span> <span class="attr">class</span>=<span class="string">"com.yao.c_inject.c_factory.MyBeanFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 获得userService --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">factory-bean</span>=<span class="string">"myBeanFactory"</span> <span class="attr">factory-method</span>=<span class="string">"createService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
<p>测试类TestStaticFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFactory</span> </span>&#123;</div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo1</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="comment">//自定义实例工厂</span></div><div class="line">		<span class="comment">//1.创建工厂</span></div><div class="line">		MyBeanFactory myBeanFactory = <span class="keyword">new</span> MyBeanFactory();</div><div class="line">		<span class="comment">//2.通过工厂实例，获得对象</span></div><div class="line">		UserService userService = myBeanFactory.createService();</div><div class="line">		userService.addUser();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo2</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="comment">//自定义工厂</span></div><div class="line">		String xmlPath = <span class="string">"com/yao/c_inject/c_factory/applicationContext.xml"</span>; </div><div class="line">		org.springframework.context.ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</div><div class="line">		<span class="comment">//获得内容-----不需要new，都是从spring容器中获得</span></div><div class="line">		UserService userService = applicationContext.getBean(<span class="string">"userService"</span>,UserService.class);</div><div class="line">		userService.addUser();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Bean种类"><a href="#Bean种类" class="headerlink" title="Bean种类"></a>Bean种类</h3><ul>
<li><p>普通bean：之前操作的都是普通bean。<bean id="" class="A"> ，spring直接创建A实例，并返回</bean></p>
</li>
<li><p>FactoryBean：是一个特殊的bean，具有工厂生成对象能力，只能生成特定的对象。</p>
</li>
</ul>
<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><ul>
<li><p>作用域：用于确定spring创建的实例的个数</p>
</li>
<li><p>取值：<br>singleton 单例 ， 默认值<br>prototype 多例，每执行一次getBean将获得一个实例。 </p>
</li>
<li><p>配置信息<br><code>&lt;bean id=&quot;&quot; class=&quot;&quot;  scope=&quot;&quot;&gt;</code></p>
</li>
</ul>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><h4 id="1-初始化和销毁"><a href="#1-初始化和销毁" class="headerlink" title="1.初始化和销毁"></a>1.初始化和销毁</h4><ul>
<li><p>目标方法执行前和执行后，将进行初始化或销毁<br><code>&lt;bean id=&quot;&quot; class=&quot;&quot; init-method=&quot;初始化方法名&quot; destroy-method=&quot;销毁的方法名称&quot;&gt;</code></p>
</li>
<li><p>init-method 用于配置初始化方法,准备数据等</p>
</li>
<li><p>destroy-method 用于配置销毁方法,清理资源等</p>
</li>
</ul>
<h4 id="2-BeanPostProcessor后处理Bean"><a href="#2-BeanPostProcessor后处理Bean" class="headerlink" title="2.BeanPostProcessor后处理Bean"></a>2.BeanPostProcessor后处理Bean</h4><ul>
<li><p>spring提供一种机制，只要实现此接口BeanPostProcessor，并将实现类提供给spring容器，spring容器将自动执行，在初始化方法钱执行before(),在初始化方法后执行after()</p>
</li>
<li><p>spring提供工厂勾子，用于修改实例对象，可以生成代理对象，是aop底层。（有了代理对象，就有AOP）</p>
</li>
</ul>
<p>模拟：<br>A a =new A();<br>a = B.before(a)            –&gt;将a的实例对象传递给后处理bean，可以生成代理对象并返回。<br>a.init();<br>a = B.after(a);          //生成代理对象，目的在目标方法前后执行（例如：开启事务、提交事务）<br>a.addUser();<br>a.destroy()</p>
<p>若将代理对象想在before()处生成，代理对象就只能调用接口中的addUser()方法，而不能调用初始化init()方法。因此将代理对象在after处生成。</p>
<p>UserService.java不变</p>
<p>UserServiceImpl.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"e_lifecycle add user"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myInit</span><span class="params">()</span></span>&#123;</div><div class="line">		System.out.println(<span class="string">"初始化"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myDestroy</span><span class="params">()</span></span>&#123;</div><div class="line">		System.out.println(<span class="string">"销毁"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>spring配置文件applicationContext.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">       					   http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;</div><div class="line">	<span class="comment">&lt;!--  </span></div><div class="line">		init-method 用于配置初始化方法,准备数据等</div><div class="line">		destroy-method 用于配置销毁方法,清理资源等</div><div class="line">	--&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"com.yao.e_lifecycle.UserServiceImpl"</span> </span></div><div class="line">		<span class="attr">init-method</span>=<span class="string">"myInit"</span> <span class="attr">destroy-method</span>=<span class="string">"myDestroy"</span> &gt;<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 将后处理的实现类注册给spring --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.yao.e_lifecycle.MyBeanPostProcessor"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
<p>MyBeanPostProcessor.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title">BeanPostProcessor</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</div><div class="line">		System.out.println(<span class="string">"前方法 ： "</span> + beanName);</div><div class="line">		<span class="keyword">return</span> bean;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">postProcessAfterInitialization</span><span class="params">(<span class="keyword">final</span> Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</div><div class="line">		System.out.println(<span class="string">"后方法 ： "</span> + beanName);</div><div class="line">		<span class="comment">// bean    目标对象</span></div><div class="line">		<span class="comment">// 生成jdk 代理</span></div><div class="line">		<span class="keyword">return</span> Proxy.newProxyInstance(</div><div class="line">					MyBeanPostProcessor.class.getClassLoader(), </div><div class="line">					bean.getClass().getInterfaces(), </div><div class="line">					<span class="keyword">new</span> InvocationHandler()&#123;</div><div class="line">						<span class="meta">@Override</span></div><div class="line">						<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">							</div><div class="line">							System.out.println(<span class="string">"------开启事务"</span>);</div><div class="line">							</div><div class="line">							<span class="comment">//执行目标方法</span></div><div class="line">							Object obj = method.invoke(bean, args);</div><div class="line">							</div><div class="line">							System.out.println(<span class="string">"------提交事务"</span>);</div><div class="line">							<span class="keyword">return</span> obj;</div><div class="line">						&#125;&#125;);</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<p>测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCycle</span> </span>&#123;</div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo1</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		<span class="comment">//spring 工厂</span></div><div class="line">		String xmlPath = <span class="string">"com/yao/e_lifecycle/applicationContext.xml"</span>;</div><div class="line">		ClassPathXmlApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</div><div class="line">		UserService userService = (UserService) applicationContext.getBean(<span class="string">"userService"</span>);</div><div class="line">		userService.addUser();</div><div class="line">		<span class="comment">//要求：1.容器必须close，销毁方法执行; 2.必须是单例的</span></div><div class="line">		<span class="comment">//applicationContext.getClass().getMethod("close").invoke(applicationContext);</span></div><div class="line">		<span class="comment">// * 此方法接口中没有定义，实现类提供</span></div><div class="line">		applicationContext.close();</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p><strong>打印结果：</strong><br>前方法 ： userService<br>初始化<br>后方法 ： userService<br>——开启事务<br>e_lifecycle add user<br>——提交事务<br>销毁</p>
<h3 id="属性依赖注入"><a href="#属性依赖注入" class="headerlink" title="属性依赖注入"></a>属性依赖注入</h3><p>依赖注入的方式：<strong>手动装配</strong>  <strong>自动装配</strong></p>
<p><strong>手动装配</strong>：一般进行配置信息都采用手动装配</p>
<blockquote>
<ul>
<li>基于xml装配：构造方法、setter方法</li>
<li>基于注解装配：</li>
</ul>
</blockquote>
<p><strong>自动装配</strong>：struts和spring整合可以自动装配</p>
<h4 id="1-构造方法"><a href="#1-构造方法" class="headerlink" title="1. 构造方法"></a>1. 构造方法</h4><p><strong>使用：</strong><code>&lt;constructor-arg&gt;</code><br>spring配置：applicationContext.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">       					   http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;</div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 构造方法注入 </span></div><div class="line">		* &lt;constructor-arg&gt; 用于配置构造方法一个参数argument</div><div class="line">			name ：参数的名称</div><div class="line">			value：设置普通数据</div><div class="line">			ref：引用数据，一般是另一个bean id值</div><div class="line">			</div><div class="line">			index ：参数的索引号，从0开始 。如果只有索引，匹配到了多个构造方法时，默认使用第一个。</div><div class="line">			type ：确定参数类型</div><div class="line">		例如：使用名称name</div><div class="line">			&lt;constructor-arg name="username" value="jack"&gt;&lt;/constructor-arg&gt;</div><div class="line">			&lt;constructor-arg name="age" value="18"&gt;&lt;/constructor-arg&gt;</div><div class="line">		例如2：类型type 和  索引 index</div><div class="line">			&lt;constructor-arg index="0" type="java.lang.String" value="1"&gt;&lt;/constructor-arg&gt;</div><div class="line">			&lt;constructor-arg index="1" type="java.lang.Integer" value="2"&gt;&lt;/constructor-arg&gt;</div><div class="line">	--&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userId"</span> <span class="attr">class</span>=<span class="string">"com.yao.f_xml.a_constructor.User"</span> &gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"some"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span> <span class="attr">value</span>=<span class="string">"45"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>目标类：User.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> Integer uid;</div><div class="line">	<span class="keyword">private</span> String username;</div><div class="line">	<span class="keyword">private</span> Integer age;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(Integer uid, String username)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>();</div><div class="line">		<span class="keyword">this</span>.uid = uid;</div><div class="line">		<span class="keyword">this</span>.username = username;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String username, Integer age)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>();</div><div class="line">		<span class="keyword">this</span>.username = username;</div><div class="line">		<span class="keyword">this</span>.age = age;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">//下面省略</span></div></pre></td></tr></table></figure>
<h4 id="2-setter方法"><a href="#2-setter方法" class="headerlink" title="2. setter方法"></a>2. setter方法</h4><p>spring配置：applicationContext.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">       					   http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;</div><div class="line">	</div><div class="line">	<span class="comment">&lt;!-- setter方法注入 </span></div><div class="line">		* 普通数据 </div><div class="line">			&lt;property name="" value="值"&gt;</div><div class="line">			等效</div><div class="line">			&lt;property name=""&gt;</div><div class="line">				&lt;value&gt;值</div><div class="line">		* 引用数据</div><div class="line">			&lt;property name="" ref="另一个bean"&gt;</div><div class="line">			等效</div><div class="line">			&lt;property name=""&gt;</div><div class="line">				&lt;ref bean="另一个bean"/&gt;</div><div class="line">	</div><div class="line">	--&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"personId"</span> <span class="attr">class</span>=<span class="string">"com.yao.f_xml.b_setter.Person"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"pname"</span> <span class="attr">value</span>=<span class="string">"kobe"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>1234<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		 </div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"homeAddr"</span> <span class="attr">ref</span>=<span class="string">"homeAddrId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"companyAddr"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"companyAddrId"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"homeAddrId"</span> <span class="attr">class</span>=<span class="string">"com.yao.f_xml.b_setter.Address"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"addr"</span> <span class="attr">value</span>=<span class="string">"LA"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"tel"</span> <span class="attr">value</span>=<span class="string">"111"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"companyAddrId"</span> <span class="attr">class</span>=<span class="string">"com.yao.f_xml.b_setter.Address"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"addr"</span> <span class="attr">value</span>=<span class="string">"STAMPUS"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"tel"</span> <span class="attr">value</span>=<span class="string">"120"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="3-P命令空间-了解"><a href="#3-P命令空间-了解" class="headerlink" title="3. P命令空间(了解)"></a>3. P命令空间(了解)</h4><h4 id="4-spEL-了解"><a href="#4-spEL-了解" class="headerlink" title="4. spEL(了解)"></a>4. spEL(了解)</h4><pre><code>对&lt;property&gt;进行统一编程，所有的内容都使用value
</code></pre><ul>
<li><code>&lt;property name=&quot;&quot; value=&quot;#{表达式}&quot;&gt;</code></li>
<li>#{123}、#{‘jack’} ： 数字、字符串</li>
<li>#{beanId}    ：另一个bean引用</li>
<li>#{beanId.propName}    ：操作数据</li>
<li>#{beanId.toString()}    ：执行方法</li>
<li>#{T(类).字段|方法}    ：静态方法或字段</li>
</ul>
<h4 id="5-集合注入"><a href="#5-集合注入" class="headerlink" title="5.集合注入"></a>5.集合注入</h4><p>实体类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.yao.f_xml.e_coll;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Arrays;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"><span class="keyword">import</span> java.util.Set;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollData</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> String[] arrayData;</div><div class="line">	<span class="keyword">private</span> List&lt;String&gt; listData;</div><div class="line">	<span class="keyword">private</span> Set&lt;String&gt; setData;</div><div class="line">	<span class="keyword">private</span> Map&lt;String, String&gt; mapData;</div><div class="line">	<span class="keyword">private</span> Properties propsData;</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> String[] getArrayData() &#123;</div><div class="line">		<span class="keyword">return</span> arrayData;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setArrayData</span><span class="params">(String[] arrayData)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.arrayData = arrayData;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getListData</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> listData;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setListData</span><span class="params">(List&lt;String&gt; listData)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.listData = listData;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> Set&lt;String&gt; <span class="title">getSetData</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> setData;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSetData</span><span class="params">(Set&lt;String&gt; setData)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.setData = setData;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> Map&lt;String, String&gt; <span class="title">getMapData</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> mapData;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMapData</span><span class="params">(Map&lt;String, String&gt; mapData)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.mapData = mapData;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> Properties <span class="title">getPropsData</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> propsData;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPropsData</span><span class="params">(Properties propsData)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.propsData = propsData;</div><div class="line">	&#125;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"CollData [\narrayData="</span> + Arrays.toString(arrayData) + <span class="string">", \nlistData="</span> + listData + <span class="string">", \nsetData="</span> + setData + <span class="string">", \nmapData="</span> + mapData + <span class="string">", \npropsData="</span> + propsData + <span class="string">"\n]"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>spring配置文件applicationContext.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></div><div class="line">       					   http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;</div><div class="line">	<span class="comment">&lt;!-- </span></div><div class="line">		集合的注入都是给&lt;property&gt;添加子标签</div><div class="line">			数组：&lt;array&gt;</div><div class="line">			List：&lt;list&gt;</div><div class="line">			Set：&lt;set&gt;</div><div class="line">			Map：&lt;map&gt; ，map存放k/v 键值对，使用&lt;entry&gt;描述</div><div class="line">			Properties：&lt;props&gt;  &lt;prop key=""&gt;&lt;/prop&gt;  【】</div><div class="line">			</div><div class="line">		普通数据：&lt;value&gt;</div><div class="line">		引用数据：&lt;ref&gt;</div><div class="line">	--&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"collDataId"</span> <span class="attr">class</span>=<span class="string">"com.yao.f_xml.e_coll.CollData"</span> &gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"arrayData"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>12<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>123<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>1234<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"listData"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">list</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>a<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>ab<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>abc<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>abcd<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"setData"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">set</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>33<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>44<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>55<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">set</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapData"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">map</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"jack"</span> <span class="attr">value</span>=<span class="string">"13"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">entry</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">key</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>rose<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">value</span>&gt;</span>250<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">				<span class="tag">&lt;/<span class="name">entry</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">map</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		</div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"propsData"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">props</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"a"</span>&gt;</span>-a<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"b"</span>&gt;</span>-b<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"c"</span>&gt;</span>-c<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="五-装配Bean基于注解"><a href="#五-装配Bean基于注解" class="headerlink" title="五 . 装配Bean基于注解"></a>五 . 装配Bean基于注解</h2><p>注解：就是一个类，使用 @注解名称<br>开发中使用注解的目的：取代xml配置文件<br>注解使用前提：添加命名空间，让spring去扫描含有注解的类</p>
<ol>
<li><p>@Component 取代<code>&lt;bean class=&quot;&quot;&gt;</code><br>@Component(“id”)取代<code>&lt;bean id=&quot;&quot; class=&quot;&quot;&gt;</code></p>
</li>
<li><p>web开发，提供3个@Component注解衍生注解（功能一样），取代<code>&lt;bean class=&quot;&quot;&gt;</code><br> @Repository ：dao层<br> @Service：service层<br> @Controller：web层</p>
</li>
<li><p>依赖注入：给私有字段设置，也可以给setter方法设置<br> 普通值：@value(“”)</p>
<p> 引用值：<br> 按照【类型】注入—–》@Autowired<br> 按照【名称】注入—–》@Autowired  @Qualifier(“名称”)<br> 按照【名称】注入—–》@Resource(“名称”)</p>
</li>
</ol>
<h3 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h3><p>StudentAction.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span>(<span class="string">"studentActionId"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentAction</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Autowired</span> <span class="comment">//默认按照类型</span></div><div class="line">	<span class="keyword">private</span> StudentService studentService;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">		studentService.addStudent();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>StudentService.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentService</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addStudent</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>StudentServiceImpl.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@service</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentServiceImpl</span> <span class="keyword">implements</span> <span class="title">StudentService</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> StudentDao studentDao;</div><div class="line">    </div><div class="line">    <span class="meta">@AutoWired</span></div><div class="line">    <span class="meta">@Qualifier</span>(<span class="string">"studentDaoId"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudentDao</span><span class="params">(StudentDao studentDao)</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>.studentDao = studentDao;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addStudent</span><span class="params">()</span></span>&#123;</div><div class="line">        studentDao.save();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>StudentDao.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentDao</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>StudentDaoImpl.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Repostory</span>(<span class="string">"studentDaoId"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDaoImpl</span> <span class="keyword">implements</span> <span class="title">StudentDao</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>&#123;</div><div class="line">        System.out.println(<span class="string">"dao"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>spring配置文件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></div><div class="line">       					   http://www.springframework.org/schema/beans/spring-beans.xsd</div><div class="line">       					   http://www.springframework.org/schema/context</div><div class="line">       					   http://www.springframework.org/schema/context/spring-context.xsd"&gt;</div><div class="line">	<span class="comment">&lt;!-- 组件扫描，扫描含有注解的类 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.yao.g_annotation.b_web"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>测试类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAnnoWeb</span> </span>&#123;</div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo02</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="comment">//从spring容器获得</span></div><div class="line">		String xmlPath = <span class="string">"com/yao/g_annotation/b_web/beans.xml"</span>;</div><div class="line">		ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</div><div class="line">		StudentAction studentAction = (StudentAction) applicationContext.getBean(<span class="string">"studentActionId"</span>);</div><div class="line">		studentAction.execute();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/06/Spring框架学习一/" data-id="cj6dowbnh000m9otxud3ombpe" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Hibernate 二级缓存" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/02/Hibernate 二级缓存/" class="article-date">
  <time datetime="2017-04-02T01:58:26.972Z" itemprop="datePublished">2017-04-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/02/Hibernate 二级缓存/">Hibernate 二级缓存</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： Hibernate 二级缓存</p>
<hr>
<h2 id="二级缓存"><a href="#二级缓存" class="headerlink" title="二级缓存"></a>二级缓存</h2><p>二级缓存是进程级别的缓存，将数据库中的一部分数据存在缓存中，可以减少对数据库的访问。<br>由于数据库的数据存在硬盘中，而二级缓存是在内存中保存，并且存储速度更快。</p>
<p><strong>二级缓存共有四个缓存区</strong></p>
<ul>
<li>类缓存区</li>
<li>集合缓存区</li>
<li>查询缓存区 : HQL</li>
<li>时间戳缓存区</li>
</ul>
<p><strong>使用进程缓存的好处</strong></p>
<ul>
<li>缓存是高速的，缓存性能效率远远比访问数据库高</li>
<li>访问缓存不需要建立连接，节约带宽和网络资源</li>
</ul>
<p><strong>缓存中的数据</strong></p>
<ul>
<li>经常使用</li>
<li>不经常被修改</li>
</ul>
<h2 id="使用二级缓存"><a href="#使用二级缓存" class="headerlink" title="使用二级缓存"></a>使用二级缓存</h2><ol>
<li>导包</li>
</ol>
<p>backport-util-concurrent.jar<br>commons-logging.jar<br>ehcache-1.5.0.jar</p>
<ol>
<li>开启二级缓存</li>
</ol>
<p>/etc/hibernate.properties   ———&gt; second-level</p>
<p>在hibernate.cfg.xml中配置使用二级缓存<br><code>&lt;property name=&quot;hibernate.cache.use_second_level_cache&quot;&gt;true&lt;/property&gt;</code></p>
<p>配置二级缓存的实现类<br><code>&lt;property name=&quot;hibernate.cache.provider_class&quot;&gt;org.hibernate.cache.EhCacheProvider&lt;/property&gt;</code></p>
<h3 id="配置类缓存"><a href="#配置类缓存" class="headerlink" title="配置类缓存"></a>配置类缓存</h3><p>在<code>&lt;session-factory&gt;</code>中配置，在property mapping属性后面</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">class-cache</span> <span class="attr">usage</span>=<span class="string">"read-only"</span> <span class="attr">class</span>=<span class="string">"com.yao.domain.Customer"</span>/&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</div><div class="line">		Session session = HibernateUtils.openSession();</div><div class="line">		session.beginTransaction();</div><div class="line">		</div><div class="line">		Customer customer1 = (Customer) session.get(Customer.class, <span class="number">1</span>);</div><div class="line">		</div><div class="line">		session.clear();<span class="comment">//清空一级缓存中的内容</span></div><div class="line">		</div><div class="line">		Customer customer2 = (Customer) session.get(Customer.class, <span class="number">1</span>);</div><div class="line">		</div><div class="line">		System.out.println(customer1 == customer2); <span class="comment">//false</span></div><div class="line">			</div><div class="line">		session.getTransaction().commit();</div><div class="line">		session.close(); <span class="comment">// 游离状态</span></div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>由以上的结果表明，二级缓存在缓存数据时,并不是以对象的形式缓存，缓存的是对象数据的散列。 每次从二级缓存拿，而会在一级缓存中组装成对象.</p>
<h3 id="集合缓存区"><a href="#集合缓存区" class="headerlink" title="集合缓存区"></a>集合缓存区</h3><p>配置：<br>collection : 完整类名.集合属性名<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">collection-cache</span> <span class="attr">usage</span>=<span class="string">"read-only"</span> <span class="attr">collection</span>=<span class="string">"com.yao.domain.Customer.orders"</span></span></div></pre></td></tr></table></figure></p>
<p><strong>集合缓存区必须配合类缓存来使用</strong> :<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">class-cache</span> <span class="attr">usage</span>=<span class="string">"read-only"</span> <span class="attr">class</span>=<span class="string">"com.yao.domain.Order"</span>/&gt;</span></div></pre></td></tr></table></figure></p>
<p>演示集合缓存区的存在 :<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//演示:集合缓存</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun1</span><span class="params">()</span></span>&#123;</div><div class="line">		Session session = HibernateUtils.openSession();</div><div class="line">		session.beginTransaction();</div><div class="line">		</div><div class="line">		Customer customer1 = (Customer) session.get(Customer.class, <span class="number">1</span>);</div><div class="line">		</div><div class="line">		<span class="keyword">for</span>(Order o :customer1.getOrders())&#123;</div><div class="line">			System.out.println(o.getName());</div><div class="line">		&#125;</div><div class="line">	</div><div class="line">		session.clear();</div><div class="line">		</div><div class="line">		Customer customer2 = (Customer) session.get(Customer.class, <span class="number">1</span>);</div><div class="line">		</div><div class="line">		Iterator&lt;Order&gt; it = customer2.getOrders().iterator();</div><div class="line">		</div><div class="line">		<span class="keyword">while</span>(it.hasNext())&#123;</div><div class="line">			Order o = it.next();</div><div class="line">			System.out.println(o.getName());</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		session.getTransaction().commit();</div><div class="line">		session.close(); <span class="comment">// 游离状态</span></div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<p>发现在使用集合缓存区中没有添加对应的类缓存配置，在遍历集合中的元素的时候，sql语句会发送很多条。</p>
<p>集合缓存区中缓存的是Customer.id和集合中order.id， 接着去类缓存区中去找类缓存中去找集合中的id对象的数据；若没有找到则去数据库中查找。因此，若没有配置对象的类缓存中，则会想数据库发送多条sql语句去获得集合中的数据。          </p>
<h3 id="查询缓存"><a href="#查询缓存" class="headerlink" title="查询缓存"></a>查询缓存</h3><ol>
<li>开始查询缓存</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.cache.use_query_cache"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div></pre></td></tr></table></figure>
<p>查询缓存演示 ：</p>
<p><strong>注意：二级查询缓存需要再次打开</strong><br>查询时，会先从二级缓存中取结果，取不到就执行语句，将结果放入二级查询缓存中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun1</span><span class="params">()</span></span>&#123;</div><div class="line">		Session session = HibernateUtils.openSession();</div><div class="line">		session.beginTransaction();</div><div class="line">		<span class="comment">//------------------------------------------------</span></div><div class="line">		 Query query = session.createQuery(<span class="string">"from Customer"</span>);</div><div class="line">		 </div><div class="line">		 <span class="comment">//使用二级(查询)缓存</span></div><div class="line">		 query.setCacheable(<span class="keyword">true</span>);</div><div class="line">		 </div><div class="line">		 List&lt;Customer&gt; list = query.list();</div><div class="line">		 </div><div class="line">		 session.clear();</div><div class="line">		 </div><div class="line">		 Query query2 = session.createQuery(<span class="string">"select c from Customer c"</span>);</div><div class="line">		 </div><div class="line">		 query2.setCacheable(<span class="keyword">true</span>);</div><div class="line">		 </div><div class="line">		 List&lt;Customer&gt; list2 = query2.list();</div><div class="line">		 </div><div class="line">		session.getTransaction().commit();</div><div class="line">		session.close(); <span class="comment">// 游离状态</span></div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>查询缓存先根据结果id从类缓存区中查找，如果类缓存区中找不到的话，就会发送sql语句根据id查询。<br>在查询缓存中，缓存的查询语句是将HQL语句转换成为SQL语句进行缓存。</p>
<h3 id="时间戳"><a href="#时间戳" class="headerlink" title="时间戳"></a>时间戳</h3><p>记录对表操作的时间，以保证二级缓存中的数据是有效的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</div><div class="line">		Session session = HibernateUtils.openSession();</div><div class="line">		session.beginTransaction();</div><div class="line">			</div><div class="line">			Customer customer1 = (Customer) session.get(Customer.class, <span class="number">1</span>);</div><div class="line">			</div><div class="line">			session.createQuery(<span class="string">"update Customer set name=:name where id = :id "</span>)</div><div class="line">				.setString(<span class="string">"name"</span>, <span class="string">"rose"</span>).setInteger(<span class="string">"id"</span>, <span class="number">1</span>).executeUpdate();</div><div class="line">		 </div><div class="line">			session.clear();</div><div class="line">		</div><div class="line">			Customer customer2 = (Customer) session.get(Customer.class, <span class="number">1</span>);</div><div class="line">		session.getTransaction().commit();</div><div class="line">		session.close(); <span class="comment">// 游离状态</span></div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>若没有加修改数据的语句，只打印一次sql语句</p>
<p>若加上修改语句，由于数据库的中的记录和二级缓存中的记录存在一定的差别，会在第二次get时再次select查询以保证有效性。 </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/02/Hibernate 二级缓存/" data-id="cj6dowbml00049otx47bir03u" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Hibernate一对一关系 ---- 主键同步" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/01/Hibernate一对一关系 ---- 主键同步/" class="article-date">
  <time datetime="2017-04-01T08:01:42.851Z" itemprop="datePublished">2017-04-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/01/Hibernate一对一关系 ---- 主键同步/">Hibernate一对一关系 ---- 主键同步</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： Hibernate 主键同步</p>
<hr>
<p>Address.hbm.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE hibernate-mapping PUBLIC </span></div><div class="line">    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"</div><div class="line">    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;</div><div class="line"> <span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.itheima.domain"</span> &gt;</span></div><div class="line"> 	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Address"</span> <span class="attr">table</span>=<span class="string">"t_Address"</span>   &gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>    &gt;</span></div><div class="line">		<span class="comment">&lt;!-- foreign: 该主键既是主键又是外键 --&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"foreign"</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 作为外键时引用哪个属性 --&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"property"</span>&gt;</span>company<span class="tag">&lt;/<span class="name">param</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">generator</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span> </div><div class="line">			</div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"string"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 配置一对一关系 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">one-to-one</span> <span class="attr">name</span>=<span class="string">"company"</span> <span class="attr">class</span>=<span class="string">"Company"</span> <span class="attr">constrained</span>=<span class="string">"true"</span>  &gt;</span><span class="tag">&lt;/<span class="name">one-to-one</span>&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></div><div class="line"> <span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>Company.hbm.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE hibernate-mapping PUBLIC </span></div><div class="line">    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"</div><div class="line">    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;</div><div class="line"> <span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.itheima.domain"</span> &gt;</span></div><div class="line"> 	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Company"</span> <span class="attr">table</span>=<span class="string">"t_Company"</span>   &gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>    &gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span><span class="tag">&lt;/<span class="name">generator</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span> </div><div class="line">			</div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"string"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 配置一对一</span></div><div class="line">		one-to-one : 默认使用主键同步策略完成一对一的表关系体现.</div><div class="line">		cascade:</div><div class="line">		fetch:</div><div class="line">		lazy:</div><div class="line">		 --&gt;</div><div class="line">		<span class="tag">&lt;<span class="name">one-to-one</span> <span class="attr">name</span>=<span class="string">"address"</span> <span class="attr">class</span>=<span class="string">"Address"</span>&gt;</span> <span class="tag">&lt;/<span class="name">one-to-one</span>&gt;</span></div><div class="line"> 	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></div><div class="line"> <span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/01/Hibernate一对一关系 ---- 主键同步/" data-id="cj6dowbmp00059otx6t0bol66" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-log4j" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/01/log4j/" class="article-date">
  <time datetime="2017-04-01T07:13:53.110Z" itemprop="datePublished">2017-04-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/01/log4j/">log4j</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： Hibernate log4j</p>
<hr>
<p>Hibernate中已经在slf4j日志框架，要想要转换成log4j，就需要中间jar包进行转换。</p>
<ol>
<li><p>必要包</p>
</li>
<li><p>log4j.property(from project/etc)</p>
<ul>
<li>配置的内容<br>info级别和stdout、file输出器输出<br><code>log4j.rootLogger=info, stdout, file</code></li>
</ul>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/01/log4j/" data-id="cj6dowbnk000q9otxab6p7a6w" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Struts2未登录拦截和权限控制" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/31/Struts2未登录拦截和权限控制/" class="article-date">
  <time datetime="2017-03-31T14:47:32.921Z" itemprop="datePublished">2017-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/31/Struts2未登录拦截和权限控制/">Struts2未登录拦截和权限控制</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>标签 ： Struts2 拦截器</p>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/03/31/Struts2未登录拦截和权限控制/" data-id="cj6dowbnb000j9otxcqio2zdi" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/08/15/《大型网站系统与Java中间件实践》读书笔记/">《大型网站系统与Java中间件实践》读书笔记</a>
          </li>
        
          <li>
            <a href="/2017/08/12/Hadoop/">Hadoop</a>
          </li>
        
          <li>
            <a href="/2017/08/02/单点登录系统/">单点登录系统</a>
          </li>
        
          <li>
            <a href="/2017/08/02/Redis/">Redis</a>
          </li>
        
          <li>
            <a href="/2017/07/20/Freemarker/">Freemarker</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Yao<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>